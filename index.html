<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Fun English - Há»c vui má»—i ngÃ y!</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ¦‰</text></svg>">
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Nunito', sans-serif;
      min-height: 100vh;
      overflow-x: hidden;
    }
    
    .app-container { max-width: 500px; margin: 0 auto; min-height: 100vh; }
    
    /* Backgrounds for different themes */
    .bg-sunny { background: linear-gradient(180deg, #87CEEB 0%, #98D8C8 100%); }
    .bg-night { background: linear-gradient(180deg, #2C3E50 0%, #4A569D 100%); }
    .bg-park { background: linear-gradient(180deg, #87CEEB 0%, #90EE90 100%); }
    .bg-home { background: linear-gradient(180deg, #FFB6C1 0%, #FFECD2 100%); }
    .bg-school { background: linear-gradient(180deg, #87CEEB 0%, #DDA0DD 100%); }
    .bg-fun { background: linear-gradient(180deg, #667eea 0%, #764ba2 100%); }
    
    .screen { display: none; min-height: 100vh; padding: 20px; }
    .screen.active { display: block; }
    
    /* Sound toggle */
    .sound-toggle {
      position: fixed; top: 15px; right: 15px; width: 45px; height: 45px;
      border-radius: 50%; border: none; background: rgba(255,255,255,0.9);
      font-size: 1.3rem; cursor: pointer; z-index: 100;
      box-shadow: 0 3px 10px rgba(0,0,0,0.2);
    }
    
    /* HOME SCREEN */
    .home-content { text-align: center; padding-top: 30px; }
    .mascot-large { font-size: 100px; animation: bounce 2s ease infinite; }
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-15px); }
    }
    .app-title {
      font-size: 2.2rem; font-weight: 800; color: white;
      text-shadow: 2px 2px 0 rgba(0,0,0,0.2); margin: 15px 0 5px;
    }
    .app-tagline { color: rgba(255,255,255,0.9); font-size: 1.1rem; margin-bottom: 30px; }
    
    .topic-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
    .topic-card {
      background: white; border-radius: 20px; padding: 20px 15px;
      text-align: center; cursor: pointer; transition: all 0.3s;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      border: 3px solid transparent;
    }
    .topic-card:hover { transform: translateY(-5px); }
    .topic-card:active { transform: scale(0.95); }
    .topic-card .topic-icon { font-size: 45px; margin-bottom: 8px; }
    .topic-card .topic-name { font-size: 1rem; font-weight: 700; color: #333; }
    .topic-card.daily { border-color: #4CAF50; }
    .topic-card.yesterday { border-color: #FF9800; }
    .topic-card.stories { border-color: #E91E63; }
    .topic-card.games { border-color: #9C27B0; }
    
    .streak-banner {
      background: linear-gradient(135deg, #FFD700, #FFA500);
      color: #5D4037; padding: 12px 20px; border-radius: 15px;
      margin-top: 25px; font-weight: 700;
      display: flex; align-items: center; justify-content: center; gap: 10px;
    }
    
    /* STORY SCREEN */
    .story-scene {
      background: white; border-radius: 25px; padding: 25px;
      margin-top: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.15);
      min-height: 400px; position: relative;
    }
    .scene-image {
      font-size: 80px; text-align: center; margin-bottom: 20px;
      animation: fadeIn 0.5s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.8); }
      to { opacity: 1; transform: scale(1); }
    }
    .scene-text {
      font-size: 1.4rem; text-align: center; color: #333;
      line-height: 1.6; margin-bottom: 25px;
    }
    .scene-text .highlight {
      background: linear-gradient(180deg, transparent 60%, #FFEB3B 60%);
      padding: 0 5px; font-weight: 700;
    }
    .scene-text .highlight-green {
      background: linear-gradient(180deg, transparent 60%, #A5D6A7 60%);
      padding: 0 5px; font-weight: 700;
    }
    .scene-text .highlight-orange {
      background: linear-gradient(180deg, transparent 60%, #FFCC80 60%);
      padding: 0 5px; font-weight: 700;
    }
    
    .scene-question {
      background: #FFF9C4; padding: 15px 20px; border-radius: 15px;
      text-align: center; font-size: 1.2rem; color: #5D4037;
      margin-bottom: 20px;
    }
    
    .choice-buttons { display: flex; flex-direction: column; gap: 12px; }
    .choice-btn {
      padding: 18px 25px; font-size: 1.2rem; font-weight: 600;
      border: 3px solid #E0E0E0; border-radius: 15px; background: white;
      cursor: pointer; font-family: 'Nunito', sans-serif; transition: all 0.2s;
      text-align: left;
    }
    .choice-btn:hover { border-color: #2196F3; background: #E3F2FD; }
    .choice-btn.correct {
      border-color: #4CAF50; background: #E8F5E9;
      animation: pulse 0.5s ease;
    }
    .choice-btn.wrong {
      border-color: #F44336; background: #FFEBEE;
      animation: shake 0.5s ease;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }
    
    .feedback-box {
      margin-top: 20px; padding: 20px; border-radius: 15px;
      text-align: center; animation: fadeIn 0.3s ease;
    }
    .feedback-box.correct { background: #E8F5E9; }
    .feedback-box.wrong { background: #FFF3E0; }
    .feedback-emoji { font-size: 50px; margin-bottom: 10px; }
    .feedback-text { font-size: 1.1rem; color: #333; margin-bottom: 15px; }
    .feedback-tip {
      background: white; padding: 12px 15px; border-radius: 10px;
      font-size: 1rem; color: #666; margin-bottom: 15px;
    }
    
    .next-btn {
      width: 100%; padding: 15px; font-size: 1.2rem; font-weight: 700;
      border: none; border-radius: 50px; cursor: pointer;
      font-family: 'Nunito', sans-serif; transition: all 0.2s;
      background: linear-gradient(135deg, #667eea, #764ba2); color: white;
    }
    .next-btn:hover { transform: translateY(-2px); }
    
    /* Progress */
    .progress-header {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 15px;
    }
    .back-btn {
      background: rgba(255,255,255,0.9); border: none; padding: 10px 18px;
      border-radius: 25px; font-weight: 700; cursor: pointer;
      font-family: 'Nunito', sans-serif; color: #333;
    }
    .progress-dots { display: flex; gap: 8px; }
    .dot {
      width: 12px; height: 12px; border-radius: 50%;
      background: rgba(255,255,255,0.4);
    }
    .dot.active { background: white; }
    .dot.done { background: #4CAF50; }
    .star-count {
      background: rgba(255,255,255,0.9); padding: 8px 15px;
      border-radius: 20px; font-weight: 700; color: #FF9800;
    }
    
    /* RESULT SCREEN */
    .result-content { text-align: center; padding-top: 40px; }
    .result-card {
      background: white; border-radius: 25px; padding: 35px 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    }
    .result-emoji { font-size: 80px; margin-bottom: 15px; }
    .result-title { font-size: 1.8rem; font-weight: 800; color: #333; margin-bottom: 10px; }
    .result-stars { font-size: 45px; margin: 15px 0; }
    .result-message { font-size: 1.1rem; color: #666; margin-bottom: 25px; }
    .result-buttons { display: flex; flex-direction: column; gap: 12px; }
    .result-btn {
      padding: 15px 25px; font-size: 1.1rem; font-weight: 700;
      border: none; border-radius: 50px; cursor: pointer;
      font-family: 'Nunito', sans-serif;
    }
    .result-btn.primary {
      background: linear-gradient(135deg, #4CAF50, #8BC34A); color: white;
    }
    .result-btn.secondary {
      background: #F5F5F5; color: #333;
    }
    
    /* LEARN SCREEN - Visual Patterns */
    .pattern-card {
      background: white; border-radius: 20px; padding: 25px;
      margin-bottom: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    .pattern-title {
      display: flex; align-items: center; gap: 10px;
      font-size: 1.3rem; font-weight: 700; color: #333; margin-bottom: 20px;
    }
    .pattern-title .icon { font-size: 30px; }
    
    .example-row {
      display: flex; align-items: center; gap: 15px;
      padding: 15px; margin-bottom: 10px; border-radius: 12px;
      background: #F5F5F5;
    }
    .example-row .emoji { font-size: 35px; }
    .example-row .sentence { font-size: 1.1rem; color: #333; }
    .example-row .sentence strong { color: #4CAF50; }
    .example-row .sentence .past { color: #FF9800; }
    
    .tip-bubble {
      background: linear-gradient(135deg, #E3F2FD, #BBDEFB);
      padding: 15px 20px; border-radius: 15px;
      display: flex; align-items: flex-start; gap: 12px;
      margin-top: 15px;
    }
    .tip-bubble .bulb { font-size: 25px; }
    .tip-bubble .tip-text { font-size: 1rem; color: #1565C0; }
    
    /* Visual comparison */
    .compare-box {
      display: grid; grid-template-columns: 1fr 1fr; gap: 15px;
      margin: 20px 0;
    }
    .compare-side {
      padding: 20px 15px; border-radius: 15px; text-align: center;
    }
    .compare-side.now { background: #E8F5E9; }
    .compare-side.past { background: #FFF3E0; }
    .compare-side .label {
      font-weight: 700; margin-bottom: 10px; font-size: 1rem;
    }
    .compare-side.now .label { color: #2E7D32; }
    .compare-side.past .label { color: #E65100; }
    .compare-side .time-words {
      display: flex; flex-wrap: wrap; gap: 6px; justify-content: center;
      margin-bottom: 12px;
    }
    .time-word {
      background: white; padding: 5px 12px; border-radius: 20px;
      font-size: 0.85rem; font-weight: 600;
    }
    .compare-side.now .time-word { color: #4CAF50; }
    .compare-side.past .time-word { color: #FF9800; }
    .compare-side .example {
      background: white; padding: 10px; border-radius: 10px;
      font-size: 0.95rem; color: #333;
    }
    
    /* Word cards for irregular verbs */
    .word-pairs { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .word-pair {
      display: flex; align-items: center; justify-content: center; gap: 8px;
      background: #F5F5F5; padding: 12px; border-radius: 12px;
    }
    .word-pair .now { color: #4CAF50; font-weight: 700; }
    .word-pair .arrow { color: #999; }
    .word-pair .past { color: #FF9800; font-weight: 700; }
    .word-pair .meaning { color: #999; font-size: 0.85rem; }
    
    /* Matching game */
    .match-instruction {
      text-align: center; color: white; font-size: 1.1rem;
      margin-bottom: 20px; padding: 15px;
      background: rgba(255,255,255,0.2); border-radius: 15px;
    }
    .match-grid {
      display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;
    }
    .match-card {
      padding: 18px 10px; border-radius: 15px; font-size: 1.1rem;
      font-weight: 700; cursor: pointer; text-align: center;
      font-family: 'Nunito', sans-serif; border: none;
      transition: all 0.2s;
    }
    .match-card.type-now { background: #E8F5E9; color: #2E7D32; }
    .match-card.type-past { background: #FFF3E0; color: #E65100; }
    .match-card.selected { transform: scale(1.05); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
    .match-card.matched { opacity: 0.5; cursor: default; }
    
    .match-score {
      text-align: center; margin-top: 20px;
      background: white; padding: 15px; border-radius: 15px;
      font-size: 1.2rem; font-weight: 700;
    }
    
    /* Flashcards */
    .flashcard-container { perspective: 1000px; margin: 20px 0; }
    .flashcard {
      width: 100%; height: 200px; cursor: pointer;
      position: relative; transform-style: preserve-3d;
      transition: transform 0.6s;
    }
    .flashcard.flipped { transform: rotateY(180deg); }
    .flashcard-face {
      position: absolute; width: 100%; height: 100%;
      backface-visibility: hidden; border-radius: 20px;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      padding: 20px;
    }
    .flashcard-front { background: linear-gradient(135deg, #E8F5E9, #C8E6C9); }
    .flashcard-back {
      background: linear-gradient(135deg, #FFF3E0, #FFE0B2);
      transform: rotateY(180deg);
    }
    .flashcard-word { font-size: 2.5rem; font-weight: 800; margin-bottom: 10px; }
    .flashcard-front .flashcard-word { color: #2E7D32; }
    .flashcard-back .flashcard-word { color: #E65100; }
    .flashcard-label { font-size: 1rem; color: #666; }
    .flashcard-meaning { font-size: 1.1rem; color: #666; margin-top: 10px; }
    .flashcard-hint { font-size: 0.9rem; color: #999; margin-top: 15px; }
    
    .flashcard-nav {
      display: flex; justify-content: center; gap: 15px; margin-top: 20px;
    }
    .flashcard-btn {
      padding: 12px 25px; border-radius: 25px; font-weight: 700;
      cursor: pointer; font-family: 'Nunito', sans-serif; border: none;
      background: white; color: #333;
    }
    .flashcard-btn:hover { background: #F5F5F5; }
    
    /* Confetti */
    .confetti-container {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none; z-index: 1000;
    }
    .confetti {
      position: absolute; width: 10px; height: 10px;
      animation: confettiFall 3s linear forwards;
    }
    @keyframes confettiFall {
      0% { transform: translateY(-100%) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }
    
    /* Responsive */
    @media (max-width: 400px) {
      .app-title { font-size: 1.8rem; }
      .scene-text { font-size: 1.2rem; }
      .choice-btn { font-size: 1rem; padding: 15px 20px; }
    }
    
    /* Level Select */
    .level-content { text-align: center; padding-top: 30px; }
    .level-title { font-size: 1.5rem; font-weight: 700; color: white; margin-bottom: 10px; }
    .level-subtitle { color: rgba(255,255,255,0.8); margin-bottom: 25px; }
    .level-cards { display: flex; flex-direction: column; gap: 15px; padding: 0 10px; }
    .level-card {
      background: white; border-radius: 20px; padding: 20px;
      display: flex; align-items: center; gap: 15px;
      cursor: pointer; transition: all 0.3s;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      border: 3px solid transparent;
    }
    .level-card:hover { transform: translateY(-3px); }
    .level-card:active { transform: scale(0.98); }
    .level-card.easy { border-color: #4CAF50; }
    .level-card.medium { border-color: #FF9800; }
    .level-card.hard { border-color: #E91E63; }
    .level-card .level-icon { font-size: 40px; }
    .level-card .level-info { text-align: left; flex: 1; }
    .level-card .level-name { font-size: 1.2rem; font-weight: 700; color: #333; }
    .level-card .level-desc { font-size: 0.9rem; color: #666; }
    .level-card .level-time { 
      background: #f5f5f5; padding: 5px 12px; border-radius: 15px;
      font-size: 0.85rem; color: #888; font-weight: 600;
    }
    .level-card.easy .level-name { color: #2E7D32; }
    .level-card.medium .level-name { color: #E65100; }
    .level-card.hard .level-name { color: #C2185B; }
  </style>
</head>
<body>
  <div class="app-container bg-fun" id="appContainer">
    <button class="sound-toggle" id="soundToggle" onclick="toggleSound()">ğŸ”Š</button>
    <div id="confettiContainer" class="confetti-container"></div>
    
    <!-- HOME SCREEN -->
    <div id="homeScreen" class="screen active">
      <div class="home-content">
        <div class="mascot-large">ğŸ¦‰</div>
        <h1 class="app-title">Fun English!</h1>
        <p class="app-tagline">Há»c tiáº¿ng Anh vui váº» má»—i ngÃ y</p>
        
        <div class="topic-grid">
          <div class="topic-card daily" onclick="showLevelSelect('daily')">
            <div class="topic-icon">â˜€ï¸</div>
            <div class="topic-name">Every Day</div>
          </div>
          <div class="topic-card yesterday" onclick="showLevelSelect('yesterday')">
            <div class="topic-icon">ğŸŒ™</div>
            <div class="topic-name">Yesterday</div>
          </div>
          <div class="topic-card stories" onclick="showLevelSelect('stories')">
            <div class="topic-icon">ğŸ“–</div>
            <div class="topic-name">Mix Stories</div>
          </div>
          <div class="topic-card" onclick="showLearnScreen()" style="border-color:#4CAF50">
            <div class="topic-icon">ğŸ“š</div>
            <div class="topic-name">Há»c kiáº¿n thá»©c</div>
          </div>
          <div class="topic-card games" onclick="startTopic('games')">
            <div class="topic-icon">ğŸ®</div>
            <div class="topic-name">Word Games</div>
          </div>
        </div>
        
        <div class="streak-banner" id="streakBanner">
          <span>ğŸ”¥</span>
          <span id="streakText">Báº¯t Ä‘áº§u há»c nÃ o!</span>
        </div>
      </div>
    </div>
    
    <!-- LEVEL SELECT SCREEN -->
    <div id="levelScreen" class="screen"></div>
    
    <!-- STORY SCREEN -->
    <div id="storyScreen" class="screen"></div>
    
    <!-- RESULT SCREEN -->
    <div id="resultScreen" class="screen"></div>
    
    <!-- LEARN SCREEN -->
    <div id="learnScreen" class="screen"></div>
    
    <!-- GAME SCREEN -->
    <div id="gameScreen" class="screen"></div>
  </div>

<script>
// ============ DATA - Cambridge Style ============
// ============ DATA - Cambridge Style (Expanded with All Signal Words) ============
var STORIES = {
  daily: [
    // ===== EVERY DAY =====
    {
      bg: 'bg-sunny',
      scenes: [
        { image: 'ğŸŒ…ğŸ‘§', text: 'Lily <span class="highlight-green">wakes up</span> at 7 <span class="highlight">every day</span>.', question: 'Every day, Lily ___ up at 7.', choices: ['wakes â˜€ï¸', 'woke ğŸŒ™'], correct: 0, feedback: 'Yes! every day â†’ wakes', tip: 'â˜€ï¸ every day = má»—i ngÃ y' },
        { image: 'ğŸš«ğŸ¬', text: 'She <span class="highlight-green">doesn\'t eat</span> candy <span class="highlight">every day</span>.', question: 'She ___ eat candy every day.', choices: ['doesn\'t ğŸš«', 'didn\'t ğŸš«'], correct: 0, feedback: 'Great! every day â†’ doesn\'t', tip: 'ğŸš« every day â†’ doesn\'t' },
        { image: 'â“ğŸ«', text: '"<span class="highlight-green">Does she go</span> to school <span class="highlight">every day</span>?"', question: '___ she go to school every day?', choices: ['Does â“', 'Did â“'], correct: 0, feedback: 'Perfect! every day â†’ Does', tip: 'â“ every day â†’ Does...?' },
        { image: 'ğŸğŸ‘¦', text: 'Tom <span class="highlight-green">eats</span> an apple <span class="highlight">every day</span>.', question: 'Tom ___ an apple every day.', choices: ['eats â˜€ï¸', 'ate ğŸŒ™'], correct: 0, feedback: 'Wonderful! every day â†’ eats', tip: 'â˜€ï¸ every day â†’ hiá»‡n táº¡i' },
        { image: 'ğŸš«ğŸ”', text: 'He <span class="highlight-green">doesn\'t eat</span> fast food <span class="highlight">every day</span>.', question: 'He doesn\'t ___ fast food every day.', choices: ['eat ğŸš«', 'eats ğŸš«'], correct: 0, feedback: 'Excellent! doesn\'t + eat (gá»‘c)', tip: 'âš ï¸ doesn\'t + Ä‘á»™ng tá»« Gá»C' },
        { image: 'â“ğŸ¥›', text: '"<span class="highlight-green">Do you drink</span> milk <span class="highlight">every day</span>?"', question: '___ you drink milk every day?', choices: ['Do â“', 'Does â“'], correct: 0, feedback: 'Great! you â†’ Do', tip: 'â“ Do + you...?' }
      ]
    },
    // ===== EVERY MORNING =====
    {
      bg: 'bg-sunny',
      scenes: [
        { image: 'ğŸ¦·ğŸ‘§', text: 'Lily <span class="highlight-green">brushes</span> her teeth <span class="highlight">every morning</span>.', question: 'Lily ___ her teeth every morning.', choices: ['brushes â˜€ï¸', 'brushed ğŸŒ™'], correct: 0, feedback: 'Yes! every morning â†’ brushes', tip: 'â˜€ï¸ every morning = má»—i sÃ¡ng' },
        { image: 'ğŸš«â˜•', text: 'She <span class="highlight-green">doesn\'t drink</span> coffee <span class="highlight">every morning</span>.', question: 'She ___ drink coffee every morning.', choices: ['doesn\'t ğŸš«', 'didn\'t ğŸš«'], correct: 0, feedback: 'Great! every morning â†’ doesn\'t', tip: 'ğŸš« every morning â†’ doesn\'t' },
        { image: 'â“ğŸ³', text: '"<span class="highlight-green">Does Mom cook</span> breakfast <span class="highlight">every morning</span>?"', question: '___ Mom cook every morning?', choices: ['Does â“', 'Did â“'], correct: 0, feedback: 'Perfect! Mom (she) â†’ Does', tip: 'â“ every morning â†’ Does...?' },
        { image: 'ğŸƒğŸ‘¦', text: 'Tom <span class="highlight-green">runs</span> in the park <span class="highlight">every morning</span>.', question: 'Tom ___ in the park every morning.', choices: ['runs â˜€ï¸', 'ran ğŸŒ™'], correct: 0, feedback: 'Wonderful! every morning â†’ runs', tip: 'â˜€ï¸ every morning â†’ hiá»‡n táº¡i' },
        { image: 'ğŸš«ğŸ“º', text: 'He <span class="highlight-green">doesn\'t watch</span> TV <span class="highlight">every morning</span>.', question: 'He doesn\'t ___ TV every morning.', choices: ['watch ğŸš«', 'watches ğŸš«'], correct: 0, feedback: 'Excellent! doesn\'t + watch (gá»‘c)', tip: 'âš ï¸ doesn\'t + Ä‘á»™ng tá»« Gá»C' },
        { image: 'â“ğŸšŒ', text: '"<span class="highlight-green">Do they take</span> the bus <span class="highlight">every morning</span>?"', question: '___ they take the bus every morning?', choices: ['Do â“', 'Does â“'], correct: 0, feedback: 'Great! they â†’ Do', tip: 'â“ Do + they...?' }
      ]
    },
    // ===== EVERY NIGHT =====
    {
      bg: 'bg-night',
      scenes: [
        { image: 'ğŸ“–ğŸ‘§', text: 'Lily <span class="highlight-green">reads</span> books <span class="highlight">every night</span>.', question: 'Lily ___ books every night.', choices: ['reads â˜€ï¸', 'read ğŸŒ™'], correct: 0, feedback: 'Yes! every night â†’ reads', tip: 'â˜€ï¸ every night = má»—i tá»‘i' },
        { image: 'ğŸš«ğŸ®', text: 'She <span class="highlight-green">doesn\'t play</span> games <span class="highlight">every night</span>.', question: 'She ___ play games every night.', choices: ['doesn\'t ğŸš«', 'didn\'t ğŸš«'], correct: 0, feedback: 'Great! every night â†’ doesn\'t', tip: 'ğŸš« every night â†’ doesn\'t' },
        { image: 'â“ğŸ˜´', text: '"<span class="highlight-green">Does she sleep</span> early <span class="highlight">every night</span>?"', question: '___ she sleep early every night?', choices: ['Does â“', 'Did â“'], correct: 0, feedback: 'Perfect! she â†’ Does', tip: 'â“ every night â†’ Does...?' },
        { image: 'ğŸ“ºğŸ‘¨â€ğŸ‘©â€ğŸ‘§', text: 'The family <span class="highlight-green">watches</span> TV <span class="highlight">every night</span>.', question: 'The family ___ TV every night.', choices: ['watches â˜€ï¸', 'watched ğŸŒ™'], correct: 0, feedback: 'Wonderful! every night â†’ watches', tip: 'â˜€ï¸ every night â†’ hiá»‡n táº¡i' },
        { image: 'ğŸš«ğŸ•', text: 'They <span class="highlight-green">don\'t eat</span> pizza <span class="highlight">every night</span>.', question: 'They ___ eat pizza every night.', choices: ['don\'t ğŸš«', 'didn\'t ğŸš«'], correct: 0, feedback: 'Excellent! they â†’ don\'t', tip: 'ğŸš« They + don\'t' },
        { image: 'â“ğŸµ', text: '"<span class="highlight-green">Do you listen</span> to music <span class="highlight">every night</span>?"', question: '___ you listen to music every night?', choices: ['Do â“', 'Did â“'], correct: 0, feedback: 'Great! you â†’ Do', tip: 'â“ every night â†’ Do...?' }
      ]
    },
    // ===== EVERY WEEK =====
    {
      bg: 'bg-park',
      scenes: [
        { image: 'âš½ğŸ‘¦', text: 'Tom <span class="highlight-green">plays</span> football <span class="highlight">every week</span>.', question: 'Tom ___ football every week.', choices: ['plays â˜€ï¸', 'played ğŸŒ™'], correct: 0, feedback: 'Yes! every week â†’ plays', tip: 'â˜€ï¸ every week = má»—i tuáº§n' },
        { image: 'ğŸš«ğŸŠ', text: 'He <span class="highlight-green">doesn\'t swim</span> <span class="highlight">every week</span>.', question: 'He ___ swim every week.', choices: ['doesn\'t ğŸš«', 'didn\'t ğŸš«'], correct: 0, feedback: 'Great! every week â†’ doesn\'t', tip: 'ğŸš« every week â†’ doesn\'t' },
        { image: 'â“ğŸ¾', text: '"<span class="highlight-green">Does he play</span> tennis <span class="highlight">every week</span>?"', question: '___ he play tennis every week?', choices: ['Does â“', 'Did â“'], correct: 0, feedback: 'Perfect! he â†’ Does', tip: 'â“ every week â†’ Does...?' },
        { image: 'ğŸ›’ğŸ‘©', text: 'Mom <span class="highlight-green">goes</span> shopping <span class="highlight">every week</span>.', question: 'Mom ___ shopping every week.', choices: ['goes â˜€ï¸', 'went ğŸŒ™'], correct: 0, feedback: 'Wonderful! every week â†’ goes', tip: 'â˜€ï¸ every week â†’ hiá»‡n táº¡i' },
        { image: 'ğŸš«ğŸ°', text: 'She <span class="highlight-green">doesn\'t buy</span> cake <span class="highlight">every week</span>.', question: 'She doesn\'t ___ cake every week.', choices: ['buy ğŸš«', 'buys ğŸš«'], correct: 0, feedback: 'Excellent! doesn\'t + buy (gá»‘c)', tip: 'âš ï¸ doesn\'t + Ä‘á»™ng tá»« Gá»C' },
        { image: 'â“ğŸ ', text: '"<span class="highlight-green">Do they clean</span> the house <span class="highlight">every week</span>?"', question: '___ they clean the house every week?', choices: ['Do â“', 'Does â“'], correct: 0, feedback: 'Great! they â†’ Do', tip: 'â“ Do + they...?' }
      ]
    },
    // ===== ALWAYS =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'ğŸğŸ‘§', text: 'Lily <span class="highlight">always</span> <span class="highlight-green">eats</span> fruit.', question: 'Lily always ___ fruit.', choices: ['eats â˜€ï¸', 'ate ğŸŒ™'], correct: 0, feedback: 'Yes! always â†’ eats', tip: 'â˜€ï¸ always = luÃ´n luÃ´n' },
        { image: 'ğŸš«ğŸ­', text: 'She <span class="highlight">always</span> <span class="highlight-green">doesn\'t forget</span> homework.', question: 'She always ___ forget homework.', choices: ['doesn\'t ğŸš«', 'didn\'t ğŸš«'], correct: 0, feedback: 'Great! always â†’ doesn\'t', tip: 'ğŸš« always â†’ doesn\'t' },
        { image: 'â“ğŸ“š', text: '"<span class="highlight-green">Does she always study</span> hard?"', question: '___ she always study hard?', choices: ['Does â“', 'Did â“'], correct: 0, feedback: 'Perfect! always â†’ Does', tip: 'â“ always â†’ Does...?' },
        { image: 'ğŸ˜ŠğŸ‘¦', text: 'Tom is <span class="highlight">always</span> <span class="highlight-green">happy</span>.', question: 'Tom is always ___.', choices: ['happy â˜€ï¸', 'was happy ğŸŒ™'], correct: 0, feedback: 'Wonderful! always â†’ is', tip: 'â˜€ï¸ always â†’ hiá»‡n táº¡i' },
        { image: 'ğŸš«ğŸ˜ ', text: 'He <span class="highlight">always</span> <span class="highlight-green">doesn\'t get</span> angry.', question: 'He always ___ get angry.', choices: ['doesn\'t ğŸš«', 'didn\'t ğŸš«'], correct: 0, feedback: 'Excellent! always â†’ doesn\'t', tip: 'ğŸš« always â†’ doesn\'t' },
        { image: 'â“ğŸ™‹', text: '"<span class="highlight-green">Do you always help</span> your friends?"', question: '___ you always help your friends?', choices: ['Do â“', 'Did â“'], correct: 0, feedback: 'Great! you â†’ Do', tip: 'â“ always â†’ Do...?' }
      ]
    },
    // ===== USUALLY =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'ğŸš¶ğŸ‘§', text: 'Lily <span class="highlight">usually</span> <span class="highlight-green">walks</span> to school.', question: 'Lily usually ___ to school.', choices: ['walks â˜€ï¸', 'walked ğŸŒ™'], correct: 0, feedback: 'Yes! usually â†’ walks', tip: 'â˜€ï¸ usually = thÆ°á»ng thÆ°á»ng' },
        { image: 'ğŸš«ğŸšŒ', text: 'She <span class="highlight">usually</span> <span class="highlight-green">doesn\'t take</span> the bus.', question: 'She usually ___ take the bus.', choices: ['doesn\'t ğŸš«', 'didn\'t ğŸš«'], correct: 0, feedback: 'Great! usually â†’ doesn\'t', tip: 'ğŸš« usually â†’ doesn\'t' },
        { image: 'â“ğŸƒ', text: '"<span class="highlight-green">Does she usually run</span> in the morning?"', question: '___ she usually run in the morning?', choices: ['Does â“', 'Did â“'], correct: 0, feedback: 'Perfect! usually â†’ Does', tip: 'â“ usually â†’ Does...?' },
        { image: 'ğŸšğŸ‘¨', text: 'Dad <span class="highlight">usually</span> <span class="highlight-green">cooks</span> dinner.', question: 'Dad usually ___ dinner.', choices: ['cooks â˜€ï¸', 'cooked ğŸŒ™'], correct: 0, feedback: 'Wonderful! usually â†’ cooks', tip: 'â˜€ï¸ usually â†’ hiá»‡n táº¡i' },
        { image: 'ğŸš«ğŸœ', text: 'He <span class="highlight">usually</span> <span class="highlight-green">doesn\'t make</span> noodles.', question: 'He usually doesn\'t ___ noodles.', choices: ['make ğŸš«', 'makes ğŸš«'], correct: 0, feedback: 'Excellent! doesn\'t + make (gá»‘c)', tip: 'âš ï¸ doesn\'t + Ä‘á»™ng tá»« Gá»C' },
        { image: 'â“ğŸ³', text: '"<span class="highlight-green">Do they usually eat</span> together?"', question: '___ they usually eat together?', choices: ['Do â“', 'Does â“'], correct: 0, feedback: 'Great! they â†’ Do', tip: 'â“ usually â†’ Do...?' }
      ]
    },
    // ===== OFTEN =====
    {
      bg: 'bg-park',
      scenes: [
        { image: 'ğŸ®ğŸ‘§', text: 'Lily <span class="highlight">often</span> <span class="highlight-green">plays</span> games.', question: 'Lily often ___ games.', choices: ['plays â˜€ï¸', 'played ğŸŒ™'], correct: 0, feedback: 'Yes! often â†’ plays', tip: 'â˜€ï¸ often = thÆ°á»ng xuyÃªn' },
        { image: 'ğŸš«ğŸ˜¢', text: 'She <span class="highlight">often</span> <span class="highlight-green">doesn\'t cry</span>.', question: 'She often ___ cry.', choices: ['doesn\'t ğŸš«', 'didn\'t ğŸš«'], correct: 0, feedback: 'Great! often â†’ doesn\'t', tip: 'ğŸš« often â†’ doesn\'t' },
        { image: 'â“ğŸ¨', text: '"<span class="highlight-green">Does she often draw</span> pictures?"', question: '___ she often draw pictures?', choices: ['Does â“', 'Did â“'], correct: 0, feedback: 'Perfect! often â†’ Does', tip: 'â“ often â†’ Does...?' },
        { image: 'ğŸ“–ğŸ‘¦', text: 'Tom <span class="highlight">often</span> <span class="highlight-green">reads</span> comics.', question: 'Tom often ___ comics.', choices: ['reads â˜€ï¸', 'read ğŸŒ™'], correct: 0, feedback: 'Wonderful! often â†’ reads', tip: 'â˜€ï¸ often â†’ hiá»‡n táº¡i' },
        { image: 'ğŸš«ğŸ“š', text: 'He <span class="highlight">often</span> <span class="highlight-green">doesn\'t read</span> textbooks.', question: 'He often doesn\'t ___ textbooks.', choices: ['read ğŸš«', 'reads ğŸš«'], correct: 0, feedback: 'Excellent! doesn\'t + read (gá»‘c)', tip: 'âš ï¸ doesn\'t + Ä‘á»™ng tá»« Gá»C' },
        { image: 'â“ğŸ¬', text: '"<span class="highlight-green">Do you often watch</span> movies?"', question: '___ you often watch movies?', choices: ['Do â“', 'Did â“'], correct: 0, feedback: 'Great! you â†’ Do', tip: 'â“ often â†’ Do...?' }
      ]
    },
    // ===== SOMETIMES =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'ğŸ¦ğŸ‘§', text: 'Lily <span class="highlight">sometimes</span> <span class="highlight-green">eats</span> ice cream.', question: 'Lily sometimes ___ ice cream.', choices: ['eats â˜€ï¸', 'ate ğŸŒ™'], correct: 0, feedback: 'Yes! sometimes â†’ eats', tip: 'â˜€ï¸ sometimes = Ä‘Ã´i khi' },
        { image: 'ğŸš«ğŸ«', text: 'She <span class="highlight">sometimes</span> <span class="highlight-green">doesn\'t eat</span> chocolate.', question: 'She sometimes ___ eat chocolate.', choices: ['doesn\'t ğŸš«', 'didn\'t ğŸš«'], correct: 0, feedback: 'Great! sometimes â†’ doesn\'t', tip: 'ğŸš« sometimes â†’ doesn\'t' },
        { image: 'â“ğŸ‚', text: '"<span class="highlight-green">Does she sometimes bake</span> cakes?"', question: '___ she sometimes bake cakes?', choices: ['Does â“', 'Did â“'], correct: 0, feedback: 'Perfect! sometimes â†’ Does', tip: 'â“ sometimes â†’ Does...?' },
        { image: 'ğŸ¸ğŸ‘¦', text: 'Tom <span class="highlight">sometimes</span> <span class="highlight-green">plays</span> guitar.', question: 'Tom sometimes ___ guitar.', choices: ['plays â˜€ï¸', 'played ğŸŒ™'], correct: 0, feedback: 'Wonderful! sometimes â†’ plays', tip: 'â˜€ï¸ sometimes â†’ hiá»‡n táº¡i' },
        { image: 'ğŸš«ğŸ¹', text: 'He <span class="highlight">sometimes</span> <span class="highlight-green">doesn\'t practice</span> piano.', question: 'He sometimes doesn\'t ___ piano.', choices: ['practice ğŸš«', 'practices ğŸš«'], correct: 0, feedback: 'Excellent! doesn\'t + practice (gá»‘c)', tip: 'âš ï¸ doesn\'t + Ä‘á»™ng tá»« Gá»C' },
        { image: 'â“ğŸ¤', text: '"<span class="highlight-green">Do they sometimes sing</span> songs?"', question: '___ they sometimes sing songs?', choices: ['Do â“', 'Does â“'], correct: 0, feedback: 'Great! they â†’ Do', tip: 'â“ sometimes â†’ Do...?' }
      ]
    }
  ],
  yesterday: [
    // ===== YESTERDAY =====
    {
      bg: 'bg-night',
      scenes: [
        { image: 'ğŸŒ™ğŸ‘§', text: 'Lily <span class="highlight-orange">woke up</span> late <span class="highlight-orange">yesterday</span>.', question: 'Yesterday, Lily ___ up late.', choices: ['woke ğŸŒ™', 'wakes â˜€ï¸'], correct: 0, feedback: 'Yes! yesterday â†’ woke', tip: 'ğŸŒ™ yesterday = hÃ´m qua' },
        { image: 'ğŸš«ğŸ«', text: 'She <span class="highlight-orange">didn\'t go</span> to school <span class="highlight-orange">yesterday</span>.', question: 'Yesterday, she ___ go to school.', choices: ['didn\'t ğŸš«', 'doesn\'t ğŸš«'], correct: 0, feedback: 'Great! yesterday â†’ didn\'t', tip: 'ğŸš« yesterday â†’ didn\'t' },
        { image: 'â“ğŸ›ï¸', text: '"<span class="highlight-orange">Did she sleep</span> well <span class="highlight-orange">yesterday</span>?"', question: '___ she sleep well yesterday?', choices: ['Did â“', 'Does â“'], correct: 0, feedback: 'Perfect! yesterday â†’ Did', tip: 'â“ yesterday â†’ Did...?' },
        { image: 'ğŸ•ğŸ‘¦', text: 'Tom <span class="highlight-orange">ate</span> pizza <span class="highlight-orange">yesterday</span>.', question: 'Yesterday, Tom ___ pizza.', choices: ['ate ğŸŒ™', 'eats â˜€ï¸'], correct: 0, feedback: 'Wonderful! yesterday â†’ ate', tip: 'ğŸŒ™ yesterday â†’ quÃ¡ khá»©' },
        { image: 'ğŸš«ğŸ¥—', text: 'He <span class="highlight-orange">didn\'t eat</span> salad <span class="highlight-orange">yesterday</span>.', question: 'Yesterday, he didn\'t ___ salad.', choices: ['eat ğŸš«', 'ate ğŸš«'], correct: 0, feedback: 'Excellent! didn\'t + eat (gá»‘c)', tip: 'âš ï¸ didn\'t + Ä‘á»™ng tá»« Gá»C' },
        { image: 'â“ğŸ®', text: '"<span class="highlight-orange">Did you play</span> games <span class="highlight-orange">yesterday</span>?"', question: 'Did you ___ games yesterday?', choices: ['play â“', 'played â“'], correct: 0, feedback: 'Great! Did + play (gá»‘c)', tip: 'âš ï¸ Did + Ä‘á»™ng tá»« Gá»C' }
      ]
    },
    // ===== LAST NIGHT =====
    {
      bg: 'bg-night',
      scenes: [
        { image: 'ğŸ“ºğŸ‘¨â€ğŸ‘©â€ğŸ‘§', text: 'We <span class="highlight-orange">watched</span> a movie <span class="highlight-orange">last night</span>.', question: 'Last night, we ___ a movie.', choices: ['watched ğŸŒ™', 'watch â˜€ï¸'], correct: 0, feedback: 'Yes! last night â†’ watched', tip: 'ğŸŒ™ last night = tá»‘i qua' },
        { image: 'ğŸš«ğŸ“–', text: 'Lily <span class="highlight-orange">didn\'t read</span> books <span class="highlight-orange">last night</span>.', question: 'Last night, Lily ___ read books.', choices: ['didn\'t ğŸš«', 'doesn\'t ğŸš«'], correct: 0, feedback: 'Great! last night â†’ didn\'t', tip: 'ğŸš« last night â†’ didn\'t' },
        { image: 'â“ğŸ˜´', text: '"<span class="highlight-orange">Did you sleep</span> early <span class="highlight-orange">last night</span>?"', question: '___ you sleep early last night?', choices: ['Did â“', 'Do â“'], correct: 0, feedback: 'Perfect! last night â†’ Did', tip: 'â“ last night â†’ Did...?' },
        { image: 'ğŸğŸ‘¨', text: 'Dad <span class="highlight-orange">cooked</span> pasta <span class="highlight-orange">last night</span>.', question: 'Last night, Dad ___ pasta.', choices: ['cooked ğŸŒ™', 'cooks â˜€ï¸'], correct: 0, feedback: 'Wonderful! last night â†’ cooked', tip: 'ğŸŒ™ last night â†’ quÃ¡ khá»©' },
        { image: 'ğŸš«ğŸ°', text: 'We <span class="highlight-orange">didn\'t have</span> dessert <span class="highlight-orange">last night</span>.', question: 'Last night, we didn\'t ___ dessert.', choices: ['have ğŸš«', 'had ğŸš«'], correct: 0, feedback: 'Excellent! didn\'t + have (gá»‘c)', tip: 'âš ï¸ didn\'t + Ä‘á»™ng tá»« Gá»C' },
        { image: 'â“ğŸµ', text: '"<span class="highlight-orange">Did they listen</span> to music <span class="highlight-orange">last night</span>?"', question: 'Did they ___ to music last night?', choices: ['listen â“', 'listened â“'], correct: 0, feedback: 'Great! Did + listen (gá»‘c)', tip: 'âš ï¸ Did + Ä‘á»™ng tá»« Gá»C' }
      ]
    },
    // ===== LAST WEEK =====
    {
      bg: 'bg-school',
      scenes: [
        { image: 'ğŸ“ğŸ‘§', text: 'Lily <span class="highlight-orange">had</span> a test <span class="highlight-orange">last week</span>.', question: 'Last week, Lily ___ a test.', choices: ['had ğŸŒ™', 'has â˜€ï¸'], correct: 0, feedback: 'Yes! last week â†’ had', tip: 'ğŸŒ™ last week = tuáº§n trÆ°á»›c' },
        { image: 'ğŸš«ğŸ˜°', text: 'She <span class="highlight-orange">didn\'t fail</span> <span class="highlight-orange">last week</span>.', question: 'Last week, she ___ fail.', choices: ['didn\'t ğŸš«', 'doesn\'t ğŸš«'], correct: 0, feedback: 'Great! last week â†’ didn\'t', tip: 'ğŸš« last week â†’ didn\'t' },
        { image: 'â“ğŸ’¯', text: '"<span class="highlight-orange">Did she get</span> 100 points <span class="highlight-orange">last week</span>?"', question: '___ she get 100 points last week?', choices: ['Did â“', 'Does â“'], correct: 0, feedback: 'Perfect! last week â†’ Did', tip: 'â“ last week â†’ Did...?' },
        { image: 'ğŸ†ğŸ‘¦', text: 'Tom <span class="highlight-orange">won</span> a prize <span class="highlight-orange">last week</span>.', question: 'Last week, Tom ___ a prize.', choices: ['won ğŸŒ™', 'wins â˜€ï¸'], correct: 0, feedback: 'Wonderful! last week â†’ won', tip: 'ğŸŒ™ last week â†’ quÃ¡ khá»©' },
        { image: 'ğŸš«ğŸ®', text: 'He <span class="highlight-orange">didn\'t play</span> games <span class="highlight-orange">last week</span>.', question: 'Last week, he didn\'t ___ games.', choices: ['play ğŸš«', 'played ğŸš«'], correct: 0, feedback: 'Excellent! didn\'t + play (gá»‘c)', tip: 'âš ï¸ didn\'t + Ä‘á»™ng tá»« Gá»C' },
        { image: 'â“ğŸ“š', text: '"<span class="highlight-orange">Did they study</span> hard <span class="highlight-orange">last week</span>?"', question: 'Did they ___ hard last week?', choices: ['study â“', 'studied â“'], correct: 0, feedback: 'Great! Did + study (gá»‘c)', tip: 'âš ï¸ Did + Ä‘á»™ng tá»« Gá»C' }
      ]
    },
    // ===== LAST MONTH =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'ğŸ‚ğŸ‘§', text: 'Lily <span class="highlight-orange">celebrated</span> her birthday <span class="highlight-orange">last month</span>.', question: 'Last month, Lily ___ her birthday.', choices: ['celebrated ğŸŒ™', 'celebrates â˜€ï¸'], correct: 0, feedback: 'Yes! last month â†’ celebrated', tip: 'ğŸŒ™ last month = thÃ¡ng trÆ°á»›c' },
        { image: 'ğŸš«ğŸ', text: 'She <span class="highlight-orange">didn\'t get</span> a bike <span class="highlight-orange">last month</span>.', question: 'Last month, she ___ get a bike.', choices: ['didn\'t ğŸš«', 'doesn\'t ğŸš«'], correct: 0, feedback: 'Great! last month â†’ didn\'t', tip: 'ğŸš« last month â†’ didn\'t' },
        { image: 'â“ğŸ‰', text: '"<span class="highlight-orange">Did friends come</span> to the party <span class="highlight-orange">last month</span>?"', question: '___ friends come to the party last month?', choices: ['Did â“', 'Do â“'], correct: 0, feedback: 'Perfect! last month â†’ Did', tip: 'â“ last month â†’ Did...?' },
        { image: 'ğŸ ğŸ‘¨â€ğŸ‘©â€ğŸ‘§', text: 'We <span class="highlight-orange">moved</span> to a new house <span class="highlight-orange">last month</span>.', question: 'Last month, we ___ to a new house.', choices: ['moved ğŸŒ™', 'move â˜€ï¸'], correct: 0, feedback: 'Wonderful! last month â†’ moved', tip: 'ğŸŒ™ last month â†’ quÃ¡ khá»©' },
        { image: 'ğŸš«ğŸ•', text: 'We <span class="highlight-orange">didn\'t buy</span> a dog <span class="highlight-orange">last month</span>.', question: 'Last month, we didn\'t ___ a dog.', choices: ['buy ğŸš«', 'bought ğŸš«'], correct: 0, feedback: 'Excellent! didn\'t + buy (gá»‘c)', tip: 'âš ï¸ didn\'t + Ä‘á»™ng tá»« Gá»C' },
        { image: 'â“ğŸŒ³', text: '"<span class="highlight-orange">Did they plant</span> trees <span class="highlight-orange">last month</span>?"', question: 'Did they ___ trees last month?', choices: ['plant â“', 'planted â“'], correct: 0, feedback: 'Great! Did + plant (gá»‘c)', tip: 'âš ï¸ Did + Ä‘á»™ng tá»« Gá»C' }
      ]
    },
    // ===== LAST YEAR =====
    {
      bg: 'bg-park',
      scenes: [
        { image: 'âœˆï¸ğŸ‘¨â€ğŸ‘©â€ğŸ‘§', text: 'We <span class="highlight-orange">went</span> to Japan <span class="highlight-orange">last year</span>.', question: 'Last year, we ___ to Japan.', choices: ['went ğŸŒ™', 'go â˜€ï¸'], correct: 0, feedback: 'Yes! last year â†’ went', tip: 'ğŸŒ™ last year = nÄƒm ngoÃ¡i' },
        { image: 'ğŸš«ğŸ”ï¸', text: 'We <span class="highlight-orange">didn\'t climb</span> a mountain <span class="highlight-orange">last year</span>.', question: 'Last year, we ___ climb a mountain.', choices: ['didn\'t ğŸš«', 'don\'t ğŸš«'], correct: 0, feedback: 'Great! last year â†’ didn\'t', tip: 'ğŸš« last year â†’ didn\'t' },
        { image: 'â“ğŸŒŠ', text: '"<span class="highlight-orange">Did you swim</span> in the sea <span class="highlight-orange">last year</span>?"', question: '___ you swim in the sea last year?', choices: ['Did â“', 'Do â“'], correct: 0, feedback: 'Perfect! last year â†’ Did', tip: 'â“ last year â†’ Did...?' },
        { image: 'ğŸ“ğŸ‘§', text: 'Lily <span class="highlight-orange">finished</span> grade 2 <span class="highlight-orange">last year</span>.', question: 'Last year, Lily ___ grade 2.', choices: ['finished ğŸŒ™', 'finishes â˜€ï¸'], correct: 0, feedback: 'Wonderful! last year â†’ finished', tip: 'ğŸŒ™ last year â†’ quÃ¡ khá»©' },
        { image: 'ğŸš«ğŸ†', text: 'Tom <span class="highlight-orange">didn\'t win</span> any prize <span class="highlight-orange">last year</span>.', question: 'Last year, Tom didn\'t ___ any prize.', choices: ['win ğŸš«', 'won ğŸš«'], correct: 0, feedback: 'Excellent! didn\'t + win (gá»‘c)', tip: 'âš ï¸ didn\'t + Ä‘á»™ng tá»« Gá»C' },
        { image: 'â“ğŸ„', text: '"<span class="highlight-orange">Did they visit</span> grandma <span class="highlight-orange">last year</span>?"', question: 'Did they ___ grandma last year?', choices: ['visit â“', 'visited â“'], correct: 0, feedback: 'Great! Did + visit (gá»‘c)', tip: 'âš ï¸ Did + Ä‘á»™ng tá»« Gá»C' }
      ]
    },
    // ===== ...AGO =====
    {
      bg: 'bg-school',
      scenes: [
        { image: 'ğŸ’ğŸ‘§', text: 'Lily <span class="highlight-orange">started</span> school <span class="highlight-orange">2 years ago</span>.', question: '2 years ago, Lily ___ school.', choices: ['started ğŸŒ™', 'starts â˜€ï¸'], correct: 0, feedback: 'Yes! ...ago â†’ started', tip: 'ğŸŒ™ ...ago = cÃ¡ch Ä‘Ã¢y...' },
        { image: 'ğŸš«ğŸ˜¢', text: 'She <span class="highlight-orange">didn\'t cry</span> <span class="highlight-orange">2 years ago</span>.', question: '2 years ago, she ___ cry.', choices: ['didn\'t ğŸš«', 'doesn\'t ğŸš«'], correct: 0, feedback: 'Great! ...ago â†’ didn\'t', tip: 'ğŸš« ...ago â†’ didn\'t' },
        { image: 'â“ğŸ‘«', text: '"<span class="highlight-orange">Did she make</span> friends <span class="highlight-orange">2 years ago</span>?"', question: '___ she make friends 2 years ago?', choices: ['Did â“', 'Does â“'], correct: 0, feedback: 'Perfect! ...ago â†’ Did', tip: 'â“ ...ago â†’ Did...?' },
        { image: 'ğŸ•ğŸ‘¦', text: 'Tom <span class="highlight-orange">got</span> a dog <span class="highlight-orange">3 months ago</span>.', question: '3 months ago, Tom ___ a dog.', choices: ['got ğŸŒ™', 'gets â˜€ï¸'], correct: 0, feedback: 'Wonderful! ...ago â†’ got', tip: 'ğŸŒ™ ...ago â†’ quÃ¡ khá»©' },
        { image: 'ğŸš«ğŸ±', text: 'He <span class="highlight-orange">didn\'t get</span> a cat <span class="highlight-orange">3 months ago</span>.', question: '3 months ago, he didn\'t ___ a cat.', choices: ['get ğŸš«', 'got ğŸš«'], correct: 0, feedback: 'Excellent! didn\'t + get (gá»‘c)', tip: 'âš ï¸ didn\'t + Ä‘á»™ng tá»« Gá»C' },
        { image: 'â“ğŸ ', text: '"<span class="highlight-orange">Did they move</span> <span class="highlight-orange">5 years ago</span>?"', question: 'Did they ___ 5 years ago?', choices: ['move â“', 'moved â“'], correct: 0, feedback: 'Great! Did + move (gá»‘c)', tip: 'âš ï¸ Did + Ä‘á»™ng tá»« Gá»C' }
      ]
    },
    // ===== IN 2023 =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'ğŸ‘¶', text: 'My sister <span class="highlight-orange">was born</span> <span class="highlight-orange">in 2020</span>.', question: 'In 2020, my sister ___ born.', choices: ['was ğŸŒ™', 'is â˜€ï¸'], correct: 0, feedback: 'Yes! in 2020 â†’ was', tip: 'ğŸŒ™ in + nÄƒm = quÃ¡ khá»©' },
        { image: 'ğŸš«ğŸ«', text: 'I <span class="highlight-orange">didn\'t go</span> to school <span class="highlight-orange">in 2020</span>.', question: 'In 2020, I ___ go to school.', choices: ['didn\'t ğŸš«', 'don\'t ğŸš«'], correct: 0, feedback: 'Great! in 2020 â†’ didn\'t', tip: 'ğŸš« in + nÄƒm â†’ didn\'t' },
        { image: 'â“ğŸ ', text: '"<span class="highlight-orange">Did you stay</span> home <span class="highlight-orange">in 2020</span>?"', question: '___ you stay home in 2020?', choices: ['Did â“', 'Do â“'], correct: 0, feedback: 'Perfect! in 2020 â†’ Did', tip: 'â“ in + nÄƒm â†’ Did...?' },
        { image: 'ğŸ®ğŸ‘¦', text: 'Tom <span class="highlight-orange">got</span> a new game <span class="highlight-orange">in 2023</span>.', question: 'In 2023, Tom ___ a new game.', choices: ['got ğŸŒ™', 'gets â˜€ï¸'], correct: 0, feedback: 'Wonderful! in 2023 â†’ got', tip: 'ğŸŒ™ in + nÄƒm â†’ quÃ¡ khá»©' },
        { image: 'ğŸš«ğŸ“±', text: 'He <span class="highlight-orange">didn\'t have</span> a phone <span class="highlight-orange">in 2021</span>.', question: 'In 2021, he didn\'t ___ a phone.', choices: ['have ğŸš«', 'had ğŸš«'], correct: 0, feedback: 'Excellent! didn\'t + have (gá»‘c)', tip: 'âš ï¸ didn\'t + Ä‘á»™ng tá»« Gá»C' },
        { image: 'â“ğŸŒ', text: '"<span class="highlight-orange">Did they travel</span> <span class="highlight-orange">in 2022</span>?"', question: 'Did they ___ in 2022?', choices: ['travel â“', 'traveled â“'], correct: 0, feedback: 'Great! Did + travel (gá»‘c)', tip: 'âš ï¸ Did + Ä‘á»™ng tá»« Gá»C' }
      ]
    }
  ],
  stories: [
    // ===== MIX: Every day vs Yesterday =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'â˜€ï¸ğŸ³', text: '<span class="highlight">Every day</span>, Lily <span class="highlight-green">eats</span> breakfast.', question: 'every day â†’ Lily ___ breakfast.', choices: ['eats â˜€ï¸', 'ate ğŸŒ™'], correct: 0, feedback: 'Yes! every day â†’ eats', tip: 'â˜€ï¸ every day â†’ hiá»‡n táº¡i' },
        { image: 'ğŸŒ™ğŸ¥', text: '<span class="highlight-orange">Yesterday</span>, she <span class="highlight-orange">ate</span> pancakes.', question: 'yesterday â†’ she ___ pancakes.', choices: ['ate ğŸŒ™', 'eats â˜€ï¸'], correct: 0, feedback: 'Great! yesterday â†’ ate', tip: 'ğŸŒ™ yesterday â†’ quÃ¡ khá»©' },
        { image: 'ğŸš«â˜€ï¸', text: 'She <span class="highlight-green">doesn\'t drink</span> coffee <span class="highlight">every morning</span>.', question: 'every morning â†’ she ___ drink coffee.', choices: ['doesn\'t â˜€ï¸', 'didn\'t ğŸŒ™'], correct: 0, feedback: 'Perfect! every morning â†’ doesn\'t', tip: 'â˜€ï¸ every morning â†’ doesn\'t' },
        { image: 'ğŸš«ğŸŒ™', text: 'She <span class="highlight-orange">didn\'t drink</span> milk <span class="highlight-orange">last night</span>.', question: 'last night â†’ she ___ drink milk.', choices: ['didn\'t ğŸŒ™', 'doesn\'t â˜€ï¸'], correct: 0, feedback: 'Wonderful! last night â†’ didn\'t', tip: 'ğŸŒ™ last night â†’ didn\'t' },
        { image: 'â“â˜€ï¸', text: '"<span class="highlight-green">Does</span> she go to school <span class="highlight">every day</span>?"', question: 'every day â†’ ___ she go to school?', choices: ['Does â˜€ï¸', 'Did ğŸŒ™'], correct: 0, feedback: 'Excellent! every day â†’ Does', tip: 'â˜€ï¸ every day â†’ Does...?' },
        { image: 'â“ğŸŒ™', text: '"<span class="highlight-orange">Did</span> she go to school <span class="highlight-orange">yesterday</span>?"', question: 'yesterday â†’ ___ she go to school?', choices: ['Did ğŸŒ™', 'Does â˜€ï¸'], correct: 0, feedback: 'Great! yesterday â†’ Did', tip: 'ğŸŒ™ yesterday â†’ Did...?' }
      ]
    },
    // ===== MIX: Always/Usually vs Last week =====
    {
      bg: 'bg-park',
      scenes: [
        { image: 'â˜€ï¸âš½', text: 'Tom <span class="highlight">always</span> <span class="highlight-green">plays</span> football.', question: 'always â†’ Tom ___ football.', choices: ['plays â˜€ï¸', 'played ğŸŒ™'], correct: 0, feedback: 'Yes! always â†’ plays', tip: 'â˜€ï¸ always â†’ hiá»‡n táº¡i' },
        { image: 'ğŸŒ™âš½', text: 'He <span class="highlight-orange">played</span> in a match <span class="highlight-orange">last Saturday</span>.', question: 'last Saturday â†’ he ___ in a match.', choices: ['played ğŸŒ™', 'plays â˜€ï¸'], correct: 0, feedback: 'Great! last Saturday â†’ played', tip: 'ğŸŒ™ last Saturday â†’ quÃ¡ khá»©' },
        { image: 'ğŸš«â˜€ï¸', text: 'He <span class="highlight">usually</span> <span class="highlight-green">doesn\'t lose</span>.', question: 'usually â†’ he ___ lose.', choices: ['doesn\'t â˜€ï¸', 'didn\'t ğŸŒ™'], correct: 0, feedback: 'Perfect! usually â†’ doesn\'t', tip: 'â˜€ï¸ usually â†’ doesn\'t' },
        { image: 'ğŸš«ğŸŒ™', text: 'But he <span class="highlight-orange">didn\'t win</span> <span class="highlight-orange">last week</span>.', question: 'last week â†’ he ___ win.', choices: ['didn\'t ğŸŒ™', 'doesn\'t â˜€ï¸'], correct: 0, feedback: 'Wonderful! last week â†’ didn\'t', tip: 'ğŸŒ™ last week â†’ didn\'t' },
        { image: 'â“â˜€ï¸', text: '"<span class="highlight-green">Does</span> he <span class="highlight">often</span> score goals?"', question: 'often â†’ ___ he score goals?', choices: ['Does â˜€ï¸', 'Did ğŸŒ™'], correct: 0, feedback: 'Excellent! often â†’ Does', tip: 'â˜€ï¸ often â†’ Does...?' },
        { image: 'â“ğŸŒ™', text: '"<span class="highlight-orange">Did</span> he score <span class="highlight-orange">last month</span>?"', question: 'last month â†’ ___ he score?', choices: ['Did ğŸŒ™', 'Does â˜€ï¸'], correct: 0, feedback: 'Great! last month â†’ Did', tip: 'ğŸŒ™ last month â†’ Did...?' }
      ]
    },
    // ===== MIX: Sometimes vs ...ago =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'â˜€ï¸ğŸ®', text: 'Lily <span class="highlight">sometimes</span> <span class="highlight-green">plays</span> video games.', question: 'sometimes â†’ Lily ___ video games.', choices: ['plays â˜€ï¸', 'played ğŸŒ™'], correct: 0, feedback: 'Yes! sometimes â†’ plays', tip: 'â˜€ï¸ sometimes â†’ hiá»‡n táº¡i' },
        { image: 'ğŸŒ™ğŸ®', text: 'She <span class="highlight-orange">played</span> a new game <span class="highlight-orange">2 days ago</span>.', question: '2 days ago â†’ she ___ a new game.', choices: ['played ğŸŒ™', 'plays â˜€ï¸'], correct: 0, feedback: 'Great! ...ago â†’ played', tip: 'ğŸŒ™ ...ago â†’ quÃ¡ khá»©' },
        { image: 'ğŸš«â˜€ï¸', text: 'She <span class="highlight">sometimes</span> <span class="highlight-green">doesn\'t do</span> homework on time.', question: 'sometimes â†’ she ___ do homework on time.', choices: ['doesn\'t â˜€ï¸', 'didn\'t ğŸŒ™'], correct: 0, feedback: 'Perfect! sometimes â†’ doesn\'t', tip: 'â˜€ï¸ sometimes â†’ doesn\'t' },
        { image: 'ğŸš«ğŸŒ™', text: 'She <span class="highlight-orange">didn\'t finish</span> her project <span class="highlight-orange">a week ago</span>.', question: 'a week ago â†’ she ___ finish her project.', choices: ['didn\'t ğŸŒ™', 'doesn\'t â˜€ï¸'], correct: 0, feedback: 'Wonderful! ...ago â†’ didn\'t', tip: 'ğŸŒ™ ...ago â†’ didn\'t' },
        { image: 'â“â˜€ï¸', text: '"<span class="highlight-green">Does</span> she <span class="highlight">often</span> help Mom?"', question: 'often â†’ ___ she help Mom?', choices: ['Does â˜€ï¸', 'Did ğŸŒ™'], correct: 0, feedback: 'Excellent! often â†’ Does', tip: 'â˜€ï¸ often â†’ Does...?' },
        { image: 'â“ğŸŒ™', text: '"<span class="highlight-orange">Did</span> she help <span class="highlight-orange">in 2023</span>?"', question: 'in 2023 â†’ ___ she help?', choices: ['Did ğŸŒ™', 'Does â˜€ï¸'], correct: 0, feedback: 'Great! in 2023 â†’ Did', tip: 'ğŸŒ™ in 2023 â†’ Did...?' }
      ]
    },
    // ===== MIX: Every week vs Last year =====
    {
      bg: 'bg-park',
      scenes: [
        { image: 'â˜€ï¸ğŸŠ', text: 'We <span class="highlight-green">go</span> swimming <span class="highlight">every week</span>.', question: 'every week â†’ we ___ swimming.', choices: ['go â˜€ï¸', 'went ğŸŒ™'], correct: 0, feedback: 'Yes! every week â†’ go', tip: 'â˜€ï¸ every week â†’ hiá»‡n táº¡i' },
        { image: 'ğŸŒ™ğŸŠ', text: 'We <span class="highlight-orange">went</span> to the beach <span class="highlight-orange">last year</span>.', question: 'last year â†’ we ___ to the beach.', choices: ['went ğŸŒ™', 'go â˜€ï¸'], correct: 0, feedback: 'Great! last year â†’ went', tip: 'ğŸŒ™ last year â†’ quÃ¡ khá»©' },
        { image: 'ğŸš«â˜€ï¸', text: 'We <span class="highlight-green">don\'t swim</span> in winter <span class="highlight">every year</span>.', question: 'every year â†’ we ___ swim in winter.', choices: ['don\'t â˜€ï¸', 'didn\'t ğŸŒ™'], correct: 0, feedback: 'Perfect! every year â†’ don\'t', tip: 'â˜€ï¸ every year â†’ don\'t' },
        { image: 'ğŸš«ğŸŒ™', text: 'We <span class="highlight-orange">didn\'t travel</span> <span class="highlight-orange">last summer</span>.', question: 'last summer â†’ we ___ travel.', choices: ['didn\'t ğŸŒ™', 'don\'t â˜€ï¸'], correct: 0, feedback: 'Wonderful! last summer â†’ didn\'t', tip: 'ğŸŒ™ last summer â†’ didn\'t' },
        { image: 'â“â˜€ï¸', text: '"<span class="highlight-green">Do</span> you <span class="highlight">usually</span> go on vacation?"', question: 'usually â†’ ___ you go on vacation?', choices: ['Do â˜€ï¸', 'Did ğŸŒ™'], correct: 0, feedback: 'Excellent! usually â†’ Do', tip: 'â˜€ï¸ usually â†’ Do...?' },
        { image: 'â“ğŸŒ™', text: '"<span class="highlight-orange">Did</span> you visit grandma <span class="highlight-orange">last holiday</span>?"', question: 'last holiday â†’ ___ you visit grandma?', choices: ['Did ğŸŒ™', 'Do â˜€ï¸'], correct: 0, feedback: 'Great! last holiday â†’ Did', tip: 'ğŸŒ™ last holiday â†’ Did...?' }
      ]
    },
    // ===== MIX: All signals - Animals =====
    {
      bg: 'bg-park',
      scenes: [
        { image: 'ğŸ•â˜€ï¸', text: 'Dogs <span class="highlight">always</span> <span class="highlight-green">love</span> bones.', question: 'always â†’ dogs ___ bones.', choices: ['love â˜€ï¸', 'loved ğŸŒ™'], correct: 0, feedback: 'Yes! always â†’ love', tip: 'â˜€ï¸ always â†’ hiá»‡n táº¡i' },
        { image: 'ğŸ•ğŸŒ™', text: 'My dog <span class="highlight-orange">ate</span> a big bone <span class="highlight-orange">yesterday</span>.', question: 'yesterday â†’ my dog ___ a big bone.', choices: ['ate ğŸŒ™', 'eats â˜€ï¸'], correct: 0, feedback: 'Great! yesterday â†’ ate', tip: 'ğŸŒ™ yesterday â†’ quÃ¡ khá»©' },
        { image: 'ğŸš«ğŸ±â˜€ï¸', text: 'Cats <span class="highlight-green">don\'t like</span> water.', question: 'Cats ___ like water. (fact)', choices: ['don\'t â˜€ï¸', 'didn\'t ğŸŒ™'], correct: 0, feedback: 'Perfect! Fact â†’ don\'t', tip: 'â˜€ï¸ Sá»± tháº­t â†’ don\'t' },
        { image: 'ğŸš«ğŸ±ğŸŒ™', text: 'My cat <span class="highlight-orange">didn\'t eat</span> fish <span class="highlight-orange">last night</span>.', question: 'last night â†’ my cat ___ eat fish.', choices: ['didn\'t ğŸŒ™', 'doesn\'t â˜€ï¸'], correct: 0, feedback: 'Wonderful! last night â†’ didn\'t', tip: 'ğŸŒ™ last night â†’ didn\'t' },
        { image: 'â“ğŸ¦â˜€ï¸', text: '"<span class="highlight-green">Do</span> birds <span class="highlight">usually</span> fly south in winter?"', question: 'usually â†’ ___ birds fly south?', choices: ['Do â˜€ï¸', 'Did ğŸŒ™'], correct: 0, feedback: 'Excellent! usually â†’ Do', tip: 'â˜€ï¸ usually â†’ Do...?' },
        { image: 'â“ğŸ¦ğŸŒ™', text: '"<span class="highlight-orange">Did</span> you see birds <span class="highlight-orange">3 days ago</span>?"', question: '3 days ago â†’ ___ you see birds?', choices: ['Did ğŸŒ™', 'Do â˜€ï¸'], correct: 0, feedback: 'Great! ...ago â†’ Did', tip: 'ğŸŒ™ ...ago â†’ Did...?' }
      ]
    },
    // ===== MIX: All signals - School =====
    {
      bg: 'bg-school',
      scenes: [
        { image: 'ğŸ«â˜€ï¸', text: 'We <span class="highlight-green">go</span> to school <span class="highlight">every day</span>.', question: 'every day â†’ we ___ to school.', choices: ['go â˜€ï¸', 'went ğŸŒ™'], correct: 0, feedback: 'Yes! every day â†’ go', tip: 'â˜€ï¸ every day â†’ hiá»‡n táº¡i' },
        { image: 'ğŸ«ğŸŒ™', text: 'We <span class="highlight-orange">had</span> a field trip <span class="highlight-orange">last Friday</span>.', question: 'last Friday â†’ we ___ a field trip.', choices: ['had ğŸŒ™', 'have â˜€ï¸'], correct: 0, feedback: 'Great! last Friday â†’ had', tip: 'ğŸŒ™ last Friday â†’ quÃ¡ khá»©' },
        { image: 'ğŸš«â˜€ï¸', text: 'We <span class="highlight-green">don\'t have</span> school on Sunday.', question: 'We ___ have school on Sunday.', choices: ['don\'t â˜€ï¸', 'didn\'t ğŸŒ™'], correct: 0, feedback: 'Perfect! Fact â†’ don\'t', tip: 'â˜€ï¸ Quy táº¯c â†’ don\'t' },
        { image: 'ğŸš«ğŸŒ™', text: 'We <span class="highlight-orange">didn\'t have</span> homework <span class="highlight-orange">yesterday</span>.', question: 'yesterday â†’ we ___ have homework.', choices: ['didn\'t ğŸŒ™', 'don\'t â˜€ï¸'], correct: 0, feedback: 'Wonderful! yesterday â†’ didn\'t', tip: 'ğŸŒ™ yesterday â†’ didn\'t' },
        { image: 'â“â˜€ï¸', text: '"<span class="highlight-green">Does</span> the teacher <span class="highlight">always</span> give tests?"', question: 'always â†’ ___ the teacher give tests?', choices: ['Does â˜€ï¸', 'Did ğŸŒ™'], correct: 0, feedback: 'Excellent! always â†’ Does', tip: 'â˜€ï¸ always â†’ Does...?' },
        { image: 'â“ğŸŒ™', text: '"<span class="highlight-orange">Did</span> you pass the test <span class="highlight-orange">last month</span>?"', question: 'last month â†’ ___ you pass the test?', choices: ['Did ğŸŒ™', 'Does â˜€ï¸'], correct: 0, feedback: 'Great! last month â†’ Did', tip: 'ğŸŒ™ last month â†’ Did...?' }
      ]
    },
    // ===== MIX: All signals - Food =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'ğŸâ˜€ï¸', text: 'I <span class="highlight">usually</span> <span class="highlight-green">eat</span> fruit for breakfast.', question: 'usually â†’ I ___ fruit for breakfast.', choices: ['eat â˜€ï¸', 'ate ğŸŒ™'], correct: 0, feedback: 'Yes! usually â†’ eat', tip: 'â˜€ï¸ usually â†’ hiá»‡n táº¡i' },
        { image: 'ğŸ•ğŸŒ™', text: 'I <span class="highlight-orange">ate</span> pizza <span class="highlight-orange">last weekend</span>.', question: 'last weekend â†’ I ___ pizza.', choices: ['ate ğŸŒ™', 'eat â˜€ï¸'], correct: 0, feedback: 'Great! last weekend â†’ ate', tip: 'ğŸŒ™ last weekend â†’ quÃ¡ khá»©' },
        { image: 'ğŸš«â˜€ï¸', text: 'I <span class="highlight-green">don\'t eat</span> spicy food <span class="highlight">every day</span>.', question: 'every day â†’ I ___ eat spicy food.', choices: ['don\'t â˜€ï¸', 'didn\'t ğŸŒ™'], correct: 0, feedback: 'Perfect! every day â†’ don\'t', tip: 'â˜€ï¸ every day â†’ don\'t' },
        { image: 'ğŸš«ğŸŒ™', text: 'I <span class="highlight-orange">didn\'t eat</span> breakfast <span class="highlight-orange">yesterday</span>.', question: 'yesterday â†’ I ___ eat breakfast.', choices: ['didn\'t ğŸŒ™', 'don\'t â˜€ï¸'], correct: 0, feedback: 'Wonderful! yesterday â†’ didn\'t', tip: 'ğŸŒ™ yesterday â†’ didn\'t' },
        { image: 'â“â˜€ï¸', text: '"<span class="highlight-green">Do</span> you <span class="highlight">sometimes</span> eat ice cream?"', question: 'sometimes â†’ ___ you eat ice cream?', choices: ['Do â˜€ï¸', 'Did ğŸŒ™'], correct: 0, feedback: 'Excellent! sometimes â†’ Do', tip: 'â˜€ï¸ sometimes â†’ Do...?' },
        { image: 'â“ğŸŒ™', text: '"<span class="highlight-orange">Did</span> you try the new restaurant <span class="highlight-orange">2 weeks ago</span>?"', question: '2 weeks ago â†’ ___ you try the new restaurant?', choices: ['Did ğŸŒ™', 'Do â˜€ï¸'], correct: 0, feedback: 'Great! ...ago â†’ Did', tip: 'ğŸŒ™ ...ago â†’ Did...?' }
      ]
    },
    // ===== MIX: All signals - Family =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â˜€ï¸', text: 'My family <span class="highlight">often</span> <span class="highlight-green">eats</span> dinner together.', question: 'often â†’ my family ___ dinner together.', choices: ['eats â˜€ï¸', 'ate ğŸŒ™'], correct: 0, feedback: 'Yes! often â†’ eats', tip: 'â˜€ï¸ often â†’ hiá»‡n táº¡i' },
        { image: 'ğŸ‘¨â€ğŸ‘©â€ğŸ‘§ğŸŒ™', text: 'We <span class="highlight-orange">went</span> to a restaurant <span class="highlight-orange">last Sunday</span>.', question: 'last Sunday â†’ we ___ to a restaurant.', choices: ['went ğŸŒ™', 'go â˜€ï¸'], correct: 0, feedback: 'Great! last Sunday â†’ went', tip: 'ğŸŒ™ last Sunday â†’ quÃ¡ khá»©' },
        { image: 'ğŸš«â˜€ï¸', text: 'Dad <span class="highlight-green">doesn\'t work</span> on weekends.', question: 'Dad ___ work on weekends.', choices: ['doesn\'t â˜€ï¸', 'didn\'t ğŸŒ™'], correct: 0, feedback: 'Perfect! Fact â†’ doesn\'t', tip: 'â˜€ï¸ Quy táº¯c â†’ doesn\'t' },
        { image: 'ğŸš«ğŸŒ™', text: 'Mom <span class="highlight-orange">didn\'t cook</span> <span class="highlight-orange">last night</span>.', question: 'last night â†’ Mom ___ cook.', choices: ['didn\'t ğŸŒ™', 'doesn\'t â˜€ï¸'], correct: 0, feedback: 'Wonderful! last night â†’ didn\'t', tip: 'ğŸŒ™ last night â†’ didn\'t' },
        { image: 'â“â˜€ï¸', text: '"<span class="highlight-green">Does</span> your sister <span class="highlight">always</span> help with chores?"', question: 'always â†’ ___ your sister help with chores?', choices: ['Does â˜€ï¸', 'Did ğŸŒ™'], correct: 0, feedback: 'Excellent! always â†’ Does', tip: 'â˜€ï¸ always â†’ Does...?' },
        { image: 'â“ğŸŒ™', text: '"<span class="highlight-orange">Did</span> grandma visit <span class="highlight-orange">last month</span>?"', question: 'last month â†’ ___ grandma visit?', choices: ['Did ğŸŒ™', 'Does â˜€ï¸'], correct: 0, feedback: 'Great! last month â†’ Did', tip: 'ğŸŒ™ last month â†’ Did...?' }
      ]
    }
  ]
};
var WORD_GAMES = {
  matching: [
    { now: 'go', past: 'went', meaning: 'Ä‘i' },
    { now: 'eat', past: 'ate', meaning: 'Äƒn' },
    { now: 'see', past: 'saw', meaning: 'tháº¥y' },
    { now: 'have', past: 'had', meaning: 'cÃ³' },
    { now: 'make', past: 'made', meaning: 'lÃ m' },
    { now: 'come', past: 'came', meaning: 'Ä‘áº¿n' },
    { now: 'take', past: 'took', meaning: 'láº¥y' },
    { now: 'give', past: 'gave', meaning: 'cho' },
    { now: 'run', past: 'ran', meaning: 'cháº¡y' },
    { now: 'swim', past: 'swam', meaning: 'bÆ¡i' },
    { now: 'drink', past: 'drank', meaning: 'uá»‘ng' },
    { now: 'sing', past: 'sang', meaning: 'hÃ¡t' },
    { now: 'sleep', past: 'slept', meaning: 'ngá»§' },
    { now: 'write', past: 'wrote', meaning: 'viáº¿t' },
    { now: 'read', past: 'read', meaning: 'Ä‘á»c' },
    { now: 'buy', past: 'bought', meaning: 'mua' },
    { now: 'get', past: 'got', meaning: 'Ä‘Æ°á»£c' },
    { now: 'sit', past: 'sat', meaning: 'ngá»“i' },
    { now: 'stand', past: 'stood', meaning: 'Ä‘á»©ng' },
    { now: 'fly', past: 'flew', meaning: 'bay' },
    { now: 'do', past: 'did', meaning: 'lÃ m' },
    { now: 'say', past: 'said', meaning: 'nÃ³i' },
    { now: 'tell', past: 'told', meaning: 'ká»ƒ' },
    { now: 'think', past: 'thought', meaning: 'nghÄ©' },
    { now: 'know', past: 'knew', meaning: 'biáº¿t' },
    { now: 'put', past: 'put', meaning: 'Ä‘áº·t' },
    { now: 'cut', past: 'cut', meaning: 'cáº¯t' },
    { now: 'draw', past: 'drew', meaning: 'váº½' },
    { now: 'grow', past: 'grew', meaning: 'lá»›n lÃªn' },
    { now: 'throw', past: 'threw', meaning: 'nÃ©m' },
    { now: 'catch', past: 'caught', meaning: 'báº¯t' },
    { now: 'teach', past: 'taught', meaning: 'dáº¡y' },
    { now: 'bring', past: 'brought', meaning: 'mang' },
    { now: 'find', past: 'found', meaning: 'tÃ¬m tháº¥y' },
    { now: 'feel', past: 'felt', meaning: 'cáº£m tháº¥y' },
    { now: 'leave', past: 'left', meaning: 'rá»i Ä‘i' },
    { now: 'meet', past: 'met', meaning: 'gáº·p' },
    { now: 'send', past: 'sent', meaning: 'gá»­i' },
    { now: 'build', past: 'built', meaning: 'xÃ¢y' },
    { now: 'wear', past: 'wore', meaning: 'máº·c' }
  ]
};

// ============ STATE ============
var soundEnabled = true;
var currentTopic = '';
var currentStory = 0;
var currentScene = 0;
var stars = 0;
var totalQuestions = 0;
var correctAnswers = 0;
var questionsPerRound = 6; // Sá»‘ cÃ¢u má»—i lÆ°á»£t
var allQuestions = []; // Máº£ng chá»©a cÃ¢u há»i Ä‘Ã£ trá»™n
var currentQuestionIndex = 0;

// Matching game state
var matchCards = [];
var selectedCard = null;
var matchedPairs = [];

// Flashcard state
var flashcardIndex = 0;
var isFlipped = false;

// ============ LEVEL SELECT ============
function showLevelSelect(topic) {
  playSound('click');
  currentTopic = topic;
  
  var topicName = topic === 'daily' ? 'â˜€ï¸ Every Day' : 
                  topic === 'yesterday' ? 'ğŸŒ™ Yesterday' : 'ğŸ“– Mix Stories';
  
  var html = '<div class="level-content">' +
    '<button class="back-btn" onclick="goHome()" style="position:absolute;top:20px;left:20px">â† Home</button>' +
    '<div style="font-size:60px;margin-bottom:15px">' + 
    (topic === 'daily' ? 'â˜€ï¸' : topic === 'yesterday' ? 'ğŸŒ™' : 'ğŸ“–') + '</div>' +
    '<div class="level-title">' + topicName + '</div>' +
    '<div class="level-subtitle">Chá»n sá»‘ cÃ¢u há»i con muá»‘n lÃ m:</div>' +
    
    '<div class="level-cards">' +
    '<div class="level-card easy" onclick="startWithLevel(5)">' +
    '<div class="level-icon">ğŸŒ±</div>' +
    '<div class="level-info">' +
    '<div class="level-name">Nhanh</div>' +
    '<div class="level-desc">Luyá»‡n táº­p nháº¹ nhÃ ng</div>' +
    '</div>' +
    '<div class="level-time">5 cÃ¢u â€¢ 3 phÃºt</div>' +
    '</div>' +
    
    '<div class="level-card medium" onclick="startWithLevel(8)">' +
    '<div class="level-icon">ğŸŒ¿</div>' +
    '<div class="level-info">' +
    '<div class="level-name">Vá»«a pháº£i</div>' +
    '<div class="level-desc">Ã”n táº­p cÆ¡ báº£n</div>' +
    '</div>' +
    '<div class="level-time">8 cÃ¢u â€¢ 5 phÃºt</div>' +
    '</div>' +
    
    '<div class="level-card hard" onclick="startWithLevel(10)">' +
    '<div class="level-icon">ğŸŒ³</div>' +
    '<div class="level-info">' +
    '<div class="level-name">Thá»­ thÃ¡ch</div>' +
    '<div class="level-desc">Kiá»ƒm tra kiáº¿n thá»©c</div>' +
    '</div>' +
    '<div class="level-time">10 cÃ¢u â€¢ 8 phÃºt</div>' +
    '</div>' +
    
    '<div class="level-card" onclick="startWithLevel(15)" style="border-color:#9C27B0">' +
    '<div class="level-icon">ğŸ†</div>' +
    '<div class="level-info">' +
    '<div class="level-name" style="color:#7B1FA2">SiÃªu sao</div>' +
    '<div class="level-desc">DÃ nh cho cao thá»§!</div>' +
    '</div>' +
    '<div class="level-time">15 cÃ¢u â€¢ 12 phÃºt</div>' +
    '</div>' +
    '</div></div>';
  
  document.getElementById('levelScreen').innerHTML = html;
  showScreen('levelScreen');
}

function startWithLevel(numQuestions) {
  playSound('click');
  questionsPerRound = numQuestions;
  
  // Thu tháº­p táº¥t cáº£ cÃ¢u há»i tá»« topic
  allQuestions = [];
  var stories = STORIES[currentTopic];
  
  stories.forEach(function(story) {
    story.scenes.forEach(function(scene) {
      allQuestions.push({
        bg: story.bg,
        image: scene.image,
        text: scene.text,
        question: scene.question,
        choices: scene.choices,
        correct: scene.correct,
        feedback: scene.feedback,
        tip: scene.tip
      });
    });
  });
  
  // Trá»™n ngáº«u nhiÃªn vÃ  láº¥y sá»‘ cÃ¢u cáº§n thiáº¿t
  allQuestions = shuffle(allQuestions).slice(0, questionsPerRound);
  
  // Reset state
  currentQuestionIndex = 0;
  stars = 0;
  correctAnswers = 0;
  totalQuestions = questionsPerRound;
  
  // Báº¯t Ä‘áº§u hiá»ƒn thá»‹ cÃ¢u há»i
  showQuestion();
}

function showQuestion() {
  if (currentQuestionIndex >= allQuestions.length) {
    showResult();
    return;
  }
  
  var q = allQuestions[currentQuestionIndex];
  document.getElementById('appContainer').className = 'app-container ' + q.bg;
  
  var dotsHtml = '';
  for (var i = 0; i < totalQuestions; i++) {
    var dotClass = 'dot';
    if (i < currentQuestionIndex) dotClass += ' done';
    else if (i === currentQuestionIndex) dotClass += ' active';
    dotsHtml += '<div class="' + dotClass + '"></div>';
  }
  
  var html = '<div class="progress-header">' +
    '<button class="back-btn" onclick="goHome()">â† Home</button>' +
    '<div class="progress-dots">' + dotsHtml + '</div>' +
    '<div class="star-count">â­ ' + stars + '</div>' +
    '</div>' +
    '<div class="story-scene">' +
    '<div class="scene-image">' + q.image + '</div>' +
    '<div class="scene-text">' + q.text + '</div>' +
    '<div class="scene-question">' + q.question + '</div>' +
    '<div class="choice-buttons">';
  
  q.choices.forEach(function(choice, i) {
    html += '<button class="choice-btn" id="choice' + i + '" onclick="checkQuestionAnswer(' + i + ')">' + choice + '</button>';
  });
  
  html += '</div><div id="feedbackArea"></div></div>';
  
  document.getElementById('storyScreen').innerHTML = html;
  showScreen('storyScreen');
}

function checkQuestionAnswer(index) {
  var q = allQuestions[currentQuestionIndex];
  var correct = index === q.correct;
  
  // Disable all buttons
  document.querySelectorAll('.choice-btn').forEach(function(btn, i) {
    btn.disabled = true;
    if (i === q.correct) btn.classList.add('correct');
    if (i === index && !correct) btn.classList.add('wrong');
  });
  
  if (correct) {
    stars++;
    correctAnswers++;
    playSound('correct');
    if (stars % 3 === 0) showConfetti();
  } else {
    playSound('wrong');
  }
  
  var feedbackHtml = '<div class="feedback-box ' + (correct ? 'correct' : 'wrong') + '">' +
    '<div class="feedback-emoji">' + (correct ? 'ğŸ‰' : 'ğŸ’ª') + '</div>' +
    '<div class="feedback-text">' + q.feedback + '</div>' +
    '<div class="feedback-tip">' + q.tip + '</div>' +
    '<button class="next-btn" onclick="nextQuestion()">' +
    (currentQuestionIndex < totalQuestions - 1 ? 'Tiáº¿p theo â†’' : 'Xem káº¿t quáº£ ğŸ†') +
    '</button></div>';
  
  document.getElementById('feedbackArea').innerHTML = feedbackHtml;
}

function nextQuestion() {
  currentQuestionIndex++;
  showQuestion();
}

// ============ SOUND ============
function playSound(type) {
  if (!soundEnabled) return;
  try {
    var ctx = new (window.AudioContext || window.webkitAudioContext)();
    var osc = ctx.createOscillator();
    var gain = ctx.createGain();
    osc.connect(gain);
    gain.connect(ctx.destination);
    
    if (type === 'correct') {
      osc.frequency.setValueAtTime(523, ctx.currentTime);
      osc.frequency.setValueAtTime(659, ctx.currentTime + 0.1);
      osc.frequency.setValueAtTime(784, ctx.currentTime + 0.2);
      gain.gain.setValueAtTime(0.3, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.4);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.4);
    } else if (type === 'wrong') {
      osc.frequency.setValueAtTime(330, ctx.currentTime);
      osc.frequency.setValueAtTime(294, ctx.currentTime + 0.15);
      gain.gain.setValueAtTime(0.2, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.3);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.3);
    } else if (type === 'click') {
      osc.frequency.setValueAtTime(800, ctx.currentTime);
      gain.gain.setValueAtTime(0.1, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.05);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.05);
    } else if (type === 'complete') {
      [523, 659, 784, 1047].forEach(function(freq, i) {
        var o = ctx.createOscillator();
        var g = ctx.createGain();
        o.connect(g); g.connect(ctx.destination);
        o.frequency.setValueAtTime(freq, ctx.currentTime + i * 0.15);
        g.gain.setValueAtTime(0.2, ctx.currentTime + i * 0.15);
        g.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + i * 0.15 + 0.2);
        o.start(ctx.currentTime + i * 0.15);
        o.stop(ctx.currentTime + i * 0.15 + 0.2);
      });
    } else if (type === 'flip') {
      osc.frequency.setValueAtTime(600, ctx.currentTime);
      osc.frequency.setValueAtTime(900, ctx.currentTime + 0.05);
      gain.gain.setValueAtTime(0.15, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.1);
    }
  } catch(e) {}
}

function toggleSound() {
  soundEnabled = !soundEnabled;
  document.getElementById('soundToggle').textContent = soundEnabled ? 'ğŸ”Š' : 'ğŸ”‡';
}

// ============ CONFETTI ============
function showConfetti() {
  var container = document.getElementById('confettiContainer');
  container.innerHTML = '';
  var colors = ['#FFD700','#FF6B6B','#4CAF50','#2196F3','#E91E63'];
  for (var i = 0; i < 30; i++) {
    var c = document.createElement('div');
    c.className = 'confetti';
    c.style.left = Math.random() * 100 + '%';
    c.style.background = colors[Math.floor(Math.random() * colors.length)];
    c.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
    c.style.animationDelay = Math.random() * 0.5 + 's';
    container.appendChild(c);
  }
  setTimeout(function() { container.innerHTML = ''; }, 3000);
}

// ============ NAVIGATION ============
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(function(s) {
    s.classList.remove('active');
  });
  document.getElementById(id).classList.add('active');
}

function goHome() {
  document.getElementById('appContainer').className = 'app-container bg-fun';
  showScreen('homeScreen');
}

// ============ SHUFFLE ============
function shuffle(arr) {
  var a = arr.slice();
  for (var i = a.length - 1; i > 0; i--) {
    var j = Math.floor(Math.random() * (i + 1));
    var t = a[i]; a[i] = a[j]; a[j] = t;
  }
  return a;
}

// ============ LEARN SCREEN ============
function showLearnScreen() {
  playSound('click');
  document.getElementById('appContainer').className = 'app-container bg-sunny';
  
  var html = '<div class="progress-header" style="margin-bottom:20px">' +
    '<button class="back-btn" onclick="goHome()">â† Home</button>' +
    '<div style="color:white;font-weight:700;font-size:1.2rem">ğŸ“š Há»c kiáº¿n thá»©c</div>' +
    '<div></div></div>' +
    
    // === Dáº¤U HIá»†U NHáº¬N BIáº¾T ===
    '<div class="pattern-card">' +
    '<div class="pattern-title"><span class="icon">ğŸ”</span> Dáº¥u hiá»‡u nháº­n biáº¿t</div>' +
    '<div class="compare-box">' +
    '<div class="compare-side now">' +
    '<div class="label">â˜€ï¸ HIá»†N Táº I</div>' +
    '<div class="time-words">' +
    '<span class="time-word">every day</span>' +
    '<span class="time-word">every morning</span>' +
    '<span class="time-word">every night</span>' +
    '<span class="time-word">every week</span>' +
    '<span class="time-word">always</span>' +
    '<span class="time-word">usually</span>' +
    '<span class="time-word">often</span>' +
    '<span class="time-word">sometimes</span>' +
    '</div>' +
    '</div>' +
    '<div class="compare-side past">' +
    '<div class="label">ğŸŒ™ QUÃ KHá»¨</div>' +
    '<div class="time-words">' +
    '<span class="time-word">yesterday</span>' +
    '<span class="time-word">last night</span>' +
    '<span class="time-word">last week</span>' +
    '<span class="time-word">last month</span>' +
    '<span class="time-word">last year</span>' +
    '<span class="time-word">...ago</span>' +
    '<span class="time-word">in 2023</span>' +
    '</div>' +
    '</div></div>' +
    '<div class="tip-bubble"><span class="bulb">ğŸ’¡</span>' +
    '<span class="tip-text"><strong>Máº¹o nhá»›:</strong><br>' +
    'ğŸ‘‰ Tháº¥y <strong>"every"</strong> â†’ Hiá»‡n táº¡i<br>' +
    'ğŸ‘‰ Tháº¥y <strong>"yesterday/last/ago"</strong> â†’ QuÃ¡ khá»©</span></div>' +
    '</div>' +
    
    // === CÃ‚U KHáº²NG Äá»ŠNH ===
    '<div class="pattern-card">' +
    '<div class="pattern-title"><span class="icon">âœ…</span> CÃ¢u kháº³ng Ä‘á»‹nh</div>' +
    '<div style="background:#E8F5E9;padding:15px;border-radius:12px;margin-bottom:15px">' +
    '<div style="font-weight:700;color:#2E7D32;margin-bottom:10px">â˜€ï¸ Hiá»‡n táº¡i:</div>' +
    '<div class="example-row"><span class="emoji">ğŸ‘§</span><span class="sentence">She <strong>goes</strong> to school every day.</span></div>' +
    '<div class="example-row"><span class="emoji">ğŸ‘¦</span><span class="sentence">He <strong>plays</strong> football every weekend.</span></div>' +
    '<div class="example-row"><span class="emoji">ğŸ‘«</span><span class="sentence">They <strong>eat</strong> breakfast every morning.</span></div>' +
    '<div style="background:white;padding:10px;border-radius:8px;margin-top:10px;font-size:0.9rem">' +
    'âš ï¸ <strong>He/She/It</strong> â†’ thÃªm <strong>s/es</strong> (goes, plays, watches)' +
    '</div></div>' +
    '<div style="background:#FFF3E0;padding:15px;border-radius:12px">' +
    '<div style="font-weight:700;color:#E65100;margin-bottom:10px">ğŸŒ™ QuÃ¡ khá»©:</div>' +
    '<div class="example-row"><span class="emoji">ğŸ‘§</span><span class="sentence">She <span class="past">went</span> to school yesterday.</span></div>' +
    '<div class="example-row"><span class="emoji">ğŸ‘¦</span><span class="sentence">He <span class="past">played</span> football last week.</span></div>' +
    '<div class="example-row"><span class="emoji">ğŸ‘«</span><span class="sentence">They <span class="past">ate</span> pizza last night.</span></div>' +
    '<div style="background:white;padding:10px;border-radius:8px;margin-top:10px;font-size:0.9rem">' +
    'âš ï¸ Äá»™ng tá»« Ä‘á»•i sang dáº¡ng quÃ¡ khá»© (went, played, ate...)' +
    '</div></div>' +
    '</div>' +
    
    // === CÃ‚U PHá»¦ Äá»ŠNH ===
    '<div class="pattern-card">' +
    '<div class="pattern-title"><span class="icon">ğŸš«</span> CÃ¢u phá»§ Ä‘á»‹nh (KhÃ´ng lÃ m gÃ¬)</div>' +
    '<div style="background:#E8F5E9;padding:15px;border-radius:12px;margin-bottom:15px">' +
    '<div style="font-weight:700;color:#2E7D32;margin-bottom:10px">â˜€ï¸ Hiá»‡n táº¡i:</div>' +
    '<div class="example-row"><span class="emoji">ğŸ‘§</span><span class="sentence">She <strong>doesn\'t go</strong> to school on Sunday.</span></div>' +
    '<div class="example-row"><span class="emoji">ğŸ‘¦</span><span class="sentence">He <strong>doesn\'t like</strong> vegetables.</span></div>' +
    '<div class="example-row"><span class="emoji">ğŸ‘«</span><span class="sentence">They <strong>don\'t eat</strong> meat.</span></div>' +
    '<div style="background:white;padding:10px;border-radius:8px;margin-top:10px">' +
    '<div style="font-size:0.9rem;margin-bottom:5px">ğŸ“Œ <strong>I/You/We/They</strong> â†’ <span style="background:#FFCDD2;padding:2px 6px;border-radius:4px">don\'t</span> + Ä‘á»™ng tá»« gá»‘c</div>' +
    '<div style="font-size:0.9rem">ğŸ“Œ <strong>He/She/It</strong> â†’ <span style="background:#FFCDD2;padding:2px 6px;border-radius:4px">doesn\'t</span> + Ä‘á»™ng tá»« gá»‘c</div>' +
    '</div></div>' +
    '<div style="background:#FFF3E0;padding:15px;border-radius:12px">' +
    '<div style="font-weight:700;color:#E65100;margin-bottom:10px">ğŸŒ™ QuÃ¡ khá»©:</div>' +
    '<div class="example-row"><span class="emoji">ğŸ‘§</span><span class="sentence">She <span class="past">didn\'t go</span> to school yesterday.</span></div>' +
    '<div class="example-row"><span class="emoji">ğŸ‘¦</span><span class="sentence">He <span class="past">didn\'t watch</span> TV last night.</span></div>' +
    '<div class="example-row"><span class="emoji">ğŸ‘«</span><span class="sentence">They <span class="past">didn\'t play</span> games yesterday.</span></div>' +
    '<div style="background:white;padding:10px;border-radius:8px;margin-top:10px">' +
    '<div style="font-size:0.9rem">ğŸ“Œ <strong>Táº¥t cáº£</strong> â†’ <span style="background:#FFCC80;padding:2px 6px;border-radius:4px">didn\'t</span> + Ä‘á»™ng tá»« <strong>Gá»C</strong></div>' +
    '</div></div>' +
    '<div class="tip-bubble" style="background:#FFEBEE"><span class="bulb">âš ï¸</span>' +
    '<span class="tip-text"><strong>Quan trá»ng:</strong> Sau don\'t / doesn\'t / didn\'t â†’ Ä‘á»™ng tá»« giá»¯ nguyÃªn dáº¡ng Gá»C!<br>' +
    'âŒ She doesn\'t <s>goes</s> â†’ âœ… She doesn\'t <strong>go</strong><br>' +
    'âŒ He didn\'t <s>went</s> â†’ âœ… He didn\'t <strong>go</strong></span></div>' +
    '</div>' +
    
    // === CÃ‚U Há»I ===
    '<div class="pattern-card">' +
    '<div class="pattern-title"><span class="icon">â“</span> CÃ¢u há»i (CÃ³ lÃ m khÃ´ng?)</div>' +
    '<div style="background:#E8F5E9;padding:15px;border-radius:12px;margin-bottom:15px">' +
    '<div style="font-weight:700;color:#2E7D32;margin-bottom:10px">â˜€ï¸ Hiá»‡n táº¡i:</div>' +
    '<div class="example-row"><span class="emoji">â“</span><span class="sentence"><strong>Do you</strong> like pizza? - Yes, I do!</span></div>' +
    '<div class="example-row"><span class="emoji">â“</span><span class="sentence"><strong>Does she</strong> go to school? - Yes, she does!</span></div>' +
    '<div class="example-row"><span class="emoji">â“</span><span class="sentence"><strong>Do they</strong> play games? - No, they don\'t.</span></div>' +
    '<div style="background:white;padding:10px;border-radius:8px;margin-top:10px">' +
    '<div style="font-size:0.9rem;margin-bottom:5px">ğŸ“Œ <span style="background:#BBDEFB;padding:2px 6px;border-radius:4px">Do</span> + I/you/we/they + Ä‘á»™ng tá»« gá»‘c?</div>' +
    '<div style="font-size:0.9rem">ğŸ“Œ <span style="background:#BBDEFB;padding:2px 6px;border-radius:4px">Does</span> + he/she/it + Ä‘á»™ng tá»« gá»‘c?</div>' +
    '</div></div>' +
    '<div style="background:#FFF3E0;padding:15px;border-radius:12px">' +
    '<div style="font-weight:700;color:#E65100;margin-bottom:10px">ğŸŒ™ QuÃ¡ khá»©:</div>' +
    '<div class="example-row"><span class="emoji">â“</span><span class="sentence"><span class="past">Did you</span> go to school yesterday? - Yes, I did!</span></div>' +
    '<div class="example-row"><span class="emoji">â“</span><span class="sentence"><span class="past">Did she</span> eat pizza? - No, she didn\'t.</span></div>' +
    '<div class="example-row"><span class="emoji">â“</span><span class="sentence"><span class="past">Did they</span> watch TV? - Yes, they did!</span></div>' +
    '<div style="background:white;padding:10px;border-radius:8px;margin-top:10px">' +
    '<div style="font-size:0.9rem">ğŸ“Œ <span style="background:#FFCC80;padding:2px 6px;border-radius:4px">Did</span> + táº¥t cáº£ + Ä‘á»™ng tá»« <strong>Gá»C</strong>?</div>' +
    '</div></div>' +
    '<div class="tip-bubble" style="background:#E3F2FD"><span class="bulb">âš ï¸</span>' +
    '<span class="tip-text"><strong>Quan trá»ng:</strong> Sau Do / Does / Did â†’ Ä‘á»™ng tá»« giá»¯ nguyÃªn dáº¡ng Gá»C!<br>' +
    'âŒ Does she <s>goes</s>? â†’ âœ… Does she <strong>go</strong>?<br>' +
    'âŒ Did you <s>went</s>? â†’ âœ… Did you <strong>go</strong>?</span></div>' +
    '</div>' +
    
    // === Báº¢NG TÃ“M Táº®T ===
    '<div class="pattern-card">' +
    '<div class="pattern-title"><span class="icon">ğŸ“‹</span> Báº£ng tÃ³m táº¯t</div>' +
    '<table style="width:100%;border-collapse:collapse;font-size:0.9rem">' +
    '<tr style="background:#E3F2FD"><th style="padding:10px;border:1px solid #ddd"></th><th style="padding:10px;border:1px solid #ddd">â˜€ï¸ Hiá»‡n táº¡i</th><th style="padding:10px;border:1px solid #ddd">ğŸŒ™ QuÃ¡ khá»©</th></tr>' +
    '<tr><td style="padding:10px;border:1px solid #ddd;font-weight:700">Dáº¥u hiá»‡u</td><td style="padding:10px;border:1px solid #ddd">every day, always</td><td style="padding:10px;border:1px solid #ddd">yesterday, last...</td></tr>' +
    '<tr style="background:#E8F5E9"><td style="padding:10px;border:1px solid #ddd;font-weight:700">âœ… She</td><td style="padding:10px;border:1px solid #ddd">She <strong>goes</strong></td><td style="padding:10px;border:1px solid #ddd">She <strong>went</strong></td></tr>' +
    '<tr style="background:#FFEBEE"><td style="padding:10px;border:1px solid #ddd;font-weight:700">ğŸš« She</td><td style="padding:10px;border:1px solid #ddd">She <strong>doesn\'t go</strong></td><td style="padding:10px;border:1px solid #ddd">She <strong>didn\'t go</strong></td></tr>' +
    '<tr style="background:#E3F2FD"><td style="padding:10px;border:1px solid #ddd;font-weight:700">â“ She</td><td style="padding:10px;border:1px solid #ddd"><strong>Does</strong> she <strong>go</strong>?</td><td style="padding:10px;border:1px solid #ddd"><strong>Did</strong> she <strong>go</strong>?</td></tr>' +
    '<tr style="background:#E8F5E9"><td style="padding:10px;border:1px solid #ddd;font-weight:700">âœ… They</td><td style="padding:10px;border:1px solid #ddd">They <strong>go</strong></td><td style="padding:10px;border:1px solid #ddd">They <strong>went</strong></td></tr>' +
    '<tr style="background:#FFEBEE"><td style="padding:10px;border:1px solid #ddd;font-weight:700">ğŸš« They</td><td style="padding:10px;border:1px solid #ddd">They <strong>don\'t go</strong></td><td style="padding:10px;border:1px solid #ddd">They <strong>didn\'t go</strong></td></tr>' +
    '<tr style="background:#E3F2FD"><td style="padding:10px;border:1px solid #ddd;font-weight:700">â“ They</td><td style="padding:10px;border:1px solid #ddd"><strong>Do</strong> they <strong>go</strong>?</td><td style="padding:10px;border:1px solid #ddd"><strong>Did</strong> they <strong>go</strong>?</td></tr>' +
    '</table>' +
    '</div>' +
    
    // === QUY Táº®C VÃ€NG ===
    '<div class="pattern-card" style="background:linear-gradient(135deg,#FFF9C4,#FFECB3)">' +
    '<div class="pattern-title"><span class="icon">â­</span> QUY Táº®C VÃ€NG</div>' +
    '<div style="text-align:center;padding:15px">' +
    '<p style="font-size:1.2rem;font-weight:700;color:#F57F17;margin-bottom:15px">' +
    'Sau <span style="background:#FF8A65;color:white;padding:5px 12px;border-radius:8px">don\'t / doesn\'t / didn\'t</span></p>' +
    '<p style="font-size:1.2rem;font-weight:700;color:#F57F17;margin-bottom:15px">' +
    'Sau <span style="background:#64B5F6;color:white;padding:5px 12px;border-radius:8px">Do / Does / Did</span></p>' +
    '<p style="font-size:1.5rem;font-weight:800;color:#E65100">' +
    'â†’ Äá»™ng tá»« luÃ´n á»Ÿ <span style="background:#FFEB3B;padding:5px 15px;border-radius:8px">Dáº NG Gá»C</span>!</p>' +
    '</div></div>' +
    
    '<button class="next-btn" onclick="goHome()" style="margin-top:20px">ğŸ  Vá» trang chá»§</button>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

// ============ TOPIC START ============
function startTopic(topic) {
  playSound('click');
  currentTopic = topic;
  
  if (topic === 'games') {
    showGameMenu();
  } else if (STORIES[topic]) {
    currentStory = Math.floor(Math.random() * STORIES[topic].length);
    currentScene = 0;
    stars = 0;
    correctAnswers = 0;
    totalQuestions = STORIES[topic][currentStory].scenes.length;
    showStory();
  }
}

// ============ STORY ============
function showStory() {
  var story = STORIES[currentTopic][currentStory];
  var scene = story.scenes[currentScene];
  
  document.getElementById('appContainer').className = 'app-container ' + story.bg;
  
  var dotsHtml = '';
  for (var i = 0; i < story.scenes.length; i++) {
    var dotClass = 'dot';
    if (i < currentScene) dotClass += ' done';
    else if (i === currentScene) dotClass += ' active';
    dotsHtml += '<div class="' + dotClass + '"></div>';
  }
  
  var html = '<div class="progress-header">' +
    '<button class="back-btn" onclick="goHome()">â† Home</button>' +
    '<div class="progress-dots">' + dotsHtml + '</div>' +
    '<div class="star-count">â­ ' + stars + '</div>' +
    '</div>' +
    '<div class="story-scene">' +
    '<div class="scene-image">' + scene.image + '</div>' +
    '<div class="scene-text">' + scene.text + '</div>' +
    '<div class="scene-question">' + scene.question + '</div>' +
    '<div class="choice-buttons">';
  
  scene.choices.forEach(function(choice, i) {
    html += '<button class="choice-btn" id="choice' + i + '" onclick="checkAnswer(' + i + ')">' + choice + '</button>';
  });
  
  html += '</div><div id="feedbackArea"></div></div>';
  
  document.getElementById('storyScreen').innerHTML = html;
  showScreen('storyScreen');
}

function checkAnswer(index) {
  var story = STORIES[currentTopic][currentStory];
  var scene = story.scenes[currentScene];
  var correct = index === scene.correct;
  
  // Disable all buttons
  document.querySelectorAll('.choice-btn').forEach(function(btn, i) {
    btn.disabled = true;
    if (i === scene.correct) btn.classList.add('correct');
    if (i === index && !correct) btn.classList.add('wrong');
  });
  
  if (correct) {
    stars++;
    correctAnswers++;
    playSound('correct');
    if (stars % 3 === 0) showConfetti();
  } else {
    playSound('wrong');
  }
  
  var feedbackHtml = '<div class="feedback-box ' + (correct ? 'correct' : 'wrong') + '">' +
    '<div class="feedback-emoji">' + (correct ? 'ğŸ‰' : 'ğŸ’ª') + '</div>' +
    '<div class="feedback-text">' + scene.feedback + '</div>' +
    '<div class="feedback-tip">' + scene.tip + '</div>' +
    '<button class="next-btn" onclick="nextScene()">' +
    (currentScene < story.scenes.length - 1 ? 'Next â†’' : 'Finish! ğŸ†') +
    '</button></div>';
  
  document.getElementById('feedbackArea').innerHTML = feedbackHtml;
}

function nextScene() {
  var story = STORIES[currentTopic][currentStory];
  
  if (currentScene < story.scenes.length - 1) {
    currentScene++;
    showStory();
  } else {
    showResult();
  }
}

// ============ RESULT ============
function showResult() {
  playSound('complete');
  showConfetti();
  
  var percentage = Math.round((correctAnswers / totalQuestions) * 100);
  var starCount = Math.min(3, Math.floor(percentage / 33) + (percentage > 0 ? 1 : 0));
  var starsHtml = '';
  for (var i = 0; i < 3; i++) {
    starsHtml += i < starCount ? 'â­' : 'â˜†';
  }
  
  var emoji = percentage >= 80 ? 'ğŸ†' : percentage >= 50 ? 'ğŸŒŸ' : 'ğŸ’ª';
  var title = percentage >= 80 ? 'Xuáº¥t sáº¯c!' : percentage >= 50 ? 'Tá»‘t láº¯m!' : 'Cá»‘ gáº¯ng thÃªm!';
  var message = percentage >= 80 ? 'Con lÃ m giá»i láº¯m! ğŸ‰' : 
                percentage >= 50 ? 'Tiáº¿p tá»¥c phÃ¡t huy nhÃ©! ğŸ‘' : 
                'Luyá»‡n táº­p thÃªm con sáº½ giá»i hÆ¡n! ğŸ’ª';
  
  document.getElementById('appContainer').className = 'app-container bg-fun';
  
  var html = '<div class="result-content"><div class="result-card">' +
    '<div class="result-emoji">' + emoji + '</div>' +
    '<div class="result-title">' + title + '</div>' +
    '<div class="result-stars">' + starsHtml + '</div>' +
    '<div style="background:#f5f5f5;padding:15px;border-radius:12px;margin:15px 0">' +
    '<div style="display:flex;justify-content:space-around;text-align:center">' +
    '<div><div style="font-size:1.5rem;font-weight:700;color:#4CAF50">' + correctAnswers + '</div><div style="font-size:0.85rem;color:#666">ÄÃºng âœ“</div></div>' +
    '<div><div style="font-size:1.5rem;font-weight:700;color:#F44336">' + (totalQuestions - correctAnswers) + '</div><div style="font-size:0.85rem;color:#666">Sai âœ—</div></div>' +
    '<div><div style="font-size:1.5rem;font-weight:700;color:#2196F3">' + percentage + '%</div><div style="font-size:0.85rem;color:#666">Tá»· lá»‡</div></div>' +
    '</div></div>' +
    '<div class="result-message">' + message + '</div>' +
    '<div class="result-buttons">' +
    '<button class="result-btn primary" onclick="showLevelSelect(\'' + currentTopic + '\')">ChÆ¡i láº¡i ğŸ”„</button>' +
    '<button class="result-btn secondary" onclick="goHome()">Vá» nhÃ  ğŸ </button>' +
    '</div></div></div>';
  
  document.getElementById('resultScreen').innerHTML = html;
  showScreen('resultScreen');
}

// ============ GAME MENU ============
function showGameMenu() {
  document.getElementById('appContainer').className = 'app-container bg-fun';
  
  var html = '<div class="progress-header" style="margin-bottom:20px">' +
    '<button class="back-btn" onclick="goHome()">â† Home</button>' +
    '<div style="color:white;font-weight:700;font-size:1.2rem">ğŸ® Word Games</div>' +
    '<div></div></div>' +
    
    '<div class="topic-grid">' +
    '<div class="topic-card" onclick="startMatchingGame()" style="border-color:#9C27B0">' +
    '<div class="topic-icon">ğŸ¯</div>' +
    '<div class="topic-name">Matching</div>' +
    '</div>' +
    '<div class="topic-card" onclick="startFlashcards()" style="border-color:#FF9800">' +
    '<div class="topic-icon">ğŸ´</div>' +
    '<div class="topic-name">Flashcards</div>' +
    '</div>' +
    '</div>' +
    
    // Visual learning section
    '<div class="pattern-card" style="margin-top:20px">' +
    '<div class="pattern-title"><span class="icon">ğŸ’¡</span> Nhá»› nhanh!</div>' +
    '<div class="compare-box">' +
    '<div class="compare-side now">' +
    '<div class="label">â˜€ï¸ Hiá»‡n táº¡i</div>' +
    '<div class="time-words"><span class="time-word">every day</span><span class="time-word">always</span></div>' +
    '<div class="example">I <strong>go</strong> to school.</div>' +
    '</div>' +
    '<div class="compare-side past">' +
    '<div class="label">ğŸŒ™ QuÃ¡ khá»©</div>' +
    '<div class="time-words"><span class="time-word">yesterday</span><span class="time-word">last week</span></div>' +
    '<div class="example">I <strong style="color:#E65100">went</strong> to school.</div>' +
    '</div></div>' +
    '<div class="tip-bubble"><span class="bulb">ğŸ’¡</span>' +
    '<span class="tip-text">Tháº¥y <strong>every</strong> â†’ dÃ¹ng tá»« hiá»‡n táº¡i<br>' +
    'Tháº¥y <strong>yesterday/last</strong> â†’ dÃ¹ng tá»« quÃ¡ khá»©!</span></div>' +
    '</div>';
  
  document.getElementById('gameScreen').innerHTML = html;
  showScreen('gameScreen');
}

// ============ MATCHING GAME ============
function startMatchingGame() {
  playSound('click');
  
  var words = shuffle(WORD_GAMES.matching).slice(0, 6);
  matchCards = [];
  selectedCard = null;
  matchedPairs = [];
  
  words.forEach(function(w, i) {
    matchCards.push({ id: 'now-' + i, text: w.now, type: 'now', pairId: i });
    matchCards.push({ id: 'past-' + i, text: w.past, type: 'past', pairId: i });
  });
  matchCards = shuffle(matchCards);
  
  renderMatchingGame();
}

function renderMatchingGame() {
  var html = '<div class="progress-header" style="margin-bottom:20px">' +
    '<button class="back-btn" onclick="showGameMenu()">â† Back</button>' +
    '<div style="color:white;font-weight:700">ğŸ¯ Match the pairs!</div>' +
    '<div></div></div>' +
    
    '<div class="match-instruction">ğŸŸ¢ Chá»n tá»« hiá»‡n táº¡i â†’ ğŸŸ  Chá»n tá»« quÃ¡ khá»© cá»§a nÃ³!</div>' +
    
    '<div class="match-grid">';
  
  matchCards.forEach(function(card) {
    var isSelected = selectedCard && selectedCard.id === card.id;
    var isMatched = matchedPairs.indexOf(card.pairId) >= 0;
    html += '<button class="match-card type-' + card.type + 
      (isSelected ? ' selected' : '') + 
      (isMatched ? ' matched' : '') + '" ' +
      (isMatched ? 'disabled' : 'onclick="selectMatchCard(\'' + card.id + '\')"') + '>' +
      card.text + '</button>';
  });
  
  html += '</div>' +
    '<div class="match-score">âœ… ' + matchedPairs.length + ' / 6</div>';
  
  if (matchedPairs.length >= 6) {
    html += '<div style="text-align:center;margin-top:20px">' +
      '<div style="font-size:50px;margin-bottom:10px">ğŸ‰</div>' +
      '<div style="color:white;font-size:1.3rem;font-weight:700;margin-bottom:15px">Excellent!</div>' +
      '<button class="next-btn" onclick="startMatchingGame()">Play Again ğŸ”„</button></div>';
  }
  
  document.getElementById('gameScreen').innerHTML = html;
  showScreen('gameScreen');
}

function selectMatchCard(cardId) {
  playSound('click');
  
  var card = matchCards.find(function(c) { return c.id === cardId; });
  
  if (!selectedCard) {
    selectedCard = card;
    renderMatchingGame();
  } else {
    if (selectedCard.id === card.id) {
      selectedCard = null;
      renderMatchingGame();
      return;
    }
    
    if (selectedCard.pairId === card.pairId && selectedCard.type !== card.type) {
      matchedPairs.push(card.pairId);
      playSound('correct');
      if (matchedPairs.length >= 6) {
        playSound('complete');
        showConfetti();
      }
    } else {
      playSound('wrong');
    }
    selectedCard = null;
    renderMatchingGame();
  }
}

// ============ FLASHCARDS ============
function startFlashcards() {
  playSound('click');
  flashcardIndex = 0;
  isFlipped = false;
  renderFlashcards();
}

function renderFlashcards() {
  var words = WORD_GAMES.matching;
  var word = words[flashcardIndex];
  
  var html = '<div class="progress-header" style="margin-bottom:20px">' +
    '<button class="back-btn" onclick="showGameMenu()">â† Back</button>' +
    '<div style="color:white;font-weight:700">ğŸ´ ' + (flashcardIndex + 1) + ' / ' + words.length + '</div>' +
    '<div></div></div>' +
    
    '<div style="color:white;text-align:center;margin-bottom:8px;font-size:1.1rem">' +
    'ğŸ‘† Cháº¡m tháº» Ä‘á»ƒ láº­t!</div>' +
    
    '<div style="background:rgba(255,255,255,0.2);padding:10px 15px;border-radius:12px;margin-bottom:15px;text-align:center">' +
    '<span style="font-size:1.1rem">ğŸ”Š <strong style="color:#FFEB3B">Äá»c TO</strong> Ä‘á»ƒ nhá»› lÃ¢u nhÃ© con!</span>' +
    '</div>' +
    
    '<div class="flashcard-container">' +
    '<div class="flashcard' + (isFlipped ? ' flipped' : '') + '" onclick="flipCard()">' +
    '<div class="flashcard-face flashcard-front">' +
    '<div class="flashcard-label">â˜€ï¸ Hiá»‡n táº¡i</div>' +
    '<div class="flashcard-word">' + word.now + '</div>' +
    '<div class="flashcard-meaning">(' + word.meaning + ')</div>' +
    '<div class="flashcard-hint" style="margin-top:10px;padding:8px 12px;background:#E8F5E9;border-radius:8px;color:#2E7D32">' +
    'ğŸ—£ï¸ Äá»c to: "<strong>' + word.now + '</strong>"</div>' +
    '</div>' +
    '<div class="flashcard-face flashcard-back">' +
    '<div class="flashcard-label">ğŸŒ™ QuÃ¡ khá»©</div>' +
    '<div class="flashcard-word">' + word.past + '</div>' +
    '<div class="flashcard-meaning">' + word.now + ' â†’ ' + word.past + '</div>' +
    '<div class="flashcard-hint" style="margin-top:10px;padding:8px 12px;background:#FFF3E0;border-radius:8px;color:#E65100">' +
    'ğŸ—£ï¸ Äá»c to: "<strong>' + word.now + '</strong> â†’ <strong>' + word.past + '</strong>"</div>' +
    '</div></div></div>' +
    
    '<div class="flashcard-nav">' +
    '<button class="flashcard-btn" onclick="prevFlashcard()">â† TrÆ°á»›c</button>' +
    '<button class="flashcard-btn" onclick="shuffleFlashcards()">ğŸ”€ Trá»™n</button>' +
    '<button class="flashcard-btn" onclick="nextFlashcard()">Sau â†’</button>' +
    '</div>' +
    
    '<div class="pattern-card" style="margin-top:20px">' +
    '<div style="text-align:center;margin-bottom:10px;color:#666;font-size:0.9rem">ğŸ—£ï¸ Äá»c to cÃ¢u nÃ y nha:</div>' +
    '<div class="example-row">' +
    '<span class="emoji">â˜€ï¸</span>' +
    '<span class="sentence">I <strong>' + word.now + '</strong> every day.</span>' +
    '</div>' +
    '<div class="example-row">' +
    '<span class="emoji">ğŸŒ™</span>' +
    '<span class="sentence">I <span class="past">' + word.past + '</span> yesterday.</span>' +
    '</div></div>';
  
  document.getElementById('gameScreen').innerHTML = html;
  showScreen('gameScreen');
}

function flipCard() {
  playSound('flip');
  isFlipped = !isFlipped;
  renderFlashcards();
}

function prevFlashcard() {
  isFlipped = false;
  flashcardIndex = flashcardIndex > 0 ? flashcardIndex - 1 : WORD_GAMES.matching.length - 1;
  renderFlashcards();
}

function nextFlashcard() {
  isFlipped = false;
  flashcardIndex = flashcardIndex < WORD_GAMES.matching.length - 1 ? flashcardIndex + 1 : 0;
  renderFlashcards();
}

function shuffleFlashcards() {
  WORD_GAMES.matching = shuffle(WORD_GAMES.matching);
  flashcardIndex = 0;
  isFlipped = false;
  renderFlashcards();
}
</script>
</body>
</html>
