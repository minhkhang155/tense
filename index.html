<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>ğŸ¦‰ Fun English - Há»c vui má»—i ngÃ y!</title>
  <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ¦‰</text></svg>">
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Nunito', sans-serif;
      min-height: 100vh;
      overflow-x: hidden;
    }
    
    .app-container { max-width: 500px; margin: 0 auto; min-height: 100vh; }
    
    /* Backgrounds for different themes */
    .bg-sunny { background: linear-gradient(180deg, #87CEEB 0%, #98D8C8 100%); }
    .bg-night { background: linear-gradient(180deg, #2C3E50 0%, #4A569D 100%); }
    .bg-park { background: linear-gradient(180deg, #87CEEB 0%, #90EE90 100%); }
    .bg-home { background: linear-gradient(180deg, #FFB6C1 0%, #FFECD2 100%); }
    .bg-school { background: linear-gradient(180deg, #87CEEB 0%, #DDA0DD 100%); }
    .bg-fun { background: linear-gradient(180deg, #667eea 0%, #764ba2 100%); }
    
    .screen { display: none; min-height: 100vh; padding: 20px; }
    .screen.active { display: block; }
    
    /* Sound toggle */
    .sound-toggle {
      position: fixed; top: 15px; right: 15px; width: 45px; height: 45px;
      border-radius: 50%; border: none; background: rgba(255,255,255,0.9);
      font-size: 1.3rem; cursor: pointer; z-index: 100;
      box-shadow: 0 3px 10px rgba(0,0,0,0.2);
    }
    
    /* HOME SCREEN */
    .home-content { text-align: center; padding-top: 30px; }
    .mascot-large { font-size: 100px; animation: bounce 2s ease infinite; }
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-15px); }
    }
    .app-title {
      font-size: 2.2rem; font-weight: 800; color: white;
      text-shadow: 2px 2px 0 rgba(0,0,0,0.2); margin: 15px 0 5px;
    }
    .app-tagline { color: rgba(255,255,255,0.9); font-size: 1.1rem; margin-bottom: 30px; }
    
    .topic-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
    .topic-card {
      background: white; border-radius: 20px; padding: 20px 15px;
      text-align: center; cursor: pointer; transition: all 0.3s;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      border: 3px solid transparent;
    }
    .topic-card:hover { transform: translateY(-5px); }
    .topic-card:active { transform: scale(0.95); }
    .topic-card .topic-icon { font-size: 45px; margin-bottom: 8px; }
    .topic-card .topic-name { font-size: 1rem; font-weight: 700; color: #333; }
    .topic-card.daily { border-color: #4CAF50; }
    .topic-card.yesterday { border-color: #FF9800; }
    .topic-card.stories { border-color: #E91E63; }
    .topic-card.games { border-color: #9C27B0; }
    
    .streak-banner {
      background: linear-gradient(135deg, #FFD700, #FFA500);
      color: #5D4037; padding: 12px 20px; border-radius: 15px;
      margin-top: 25px; font-weight: 700;
      display: flex; align-items: center; justify-content: center; gap: 10px;
    }
    
    /* STORY SCREEN */
    .story-scene {
      background: white; border-radius: 25px; padding: 25px;
      margin-top: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.15);
      min-height: 400px; position: relative;
    }
    .scene-image {
      font-size: 80px; text-align: center; margin-bottom: 20px;
      animation: fadeIn 0.5s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.8); }
      to { opacity: 1; transform: scale(1); }
    }
    .scene-text {
      font-size: 1.4rem; text-align: center; color: #333;
      line-height: 1.6; margin-bottom: 25px;
    }
    .scene-text .highlight {
      background: linear-gradient(180deg, transparent 60%, #FFEB3B 60%);
      padding: 0 5px; font-weight: 700;
    }
    .scene-text .highlight-green {
      background: linear-gradient(180deg, transparent 60%, #A5D6A7 60%);
      padding: 0 5px; font-weight: 700;
    }
    .scene-text .highlight-orange {
      background: linear-gradient(180deg, transparent 60%, #FFCC80 60%);
      padding: 0 5px; font-weight: 700;
    }
    
    .scene-question {
      background: #FFF9C4; padding: 15px 20px; border-radius: 15px;
      text-align: center; font-size: 1.2rem; color: #5D4037;
      margin-bottom: 20px;
    }
    
    .choice-buttons { display: flex; flex-direction: column; gap: 12px; }
    .choice-btn {
      padding: 18px 25px; font-size: 1.2rem; font-weight: 600;
      border: 3px solid #E0E0E0; border-radius: 15px; background: white;
      cursor: pointer; font-family: 'Nunito', sans-serif; transition: all 0.2s;
      text-align: left;
    }
    .choice-btn:hover { border-color: #2196F3; background: #E3F2FD; }
    .choice-btn.correct {
      border-color: #4CAF50; background: #E8F5E9;
      animation: pulse 0.5s ease;
    }
    .choice-btn.wrong {
      border-color: #F44336; background: #FFEBEE;
      animation: shake 0.5s ease;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }
    
    .feedback-box {
      margin-top: 20px; padding: 20px; border-radius: 15px;
      text-align: center; animation: fadeIn 0.3s ease;
    }
    .feedback-box.correct { background: #E8F5E9; }
    .feedback-box.wrong { background: #FFF3E0; }
    .feedback-emoji { font-size: 50px; margin-bottom: 10px; }
    .feedback-text { font-size: 1.1rem; color: #333; margin-bottom: 15px; }
    .feedback-tip {
      background: white; padding: 12px 15px; border-radius: 10px;
      font-size: 1rem; color: #666; margin-bottom: 15px;
    }
    
    .next-btn {
      width: 100%; padding: 15px; font-size: 1.2rem; font-weight: 700;
      border: none; border-radius: 50px; cursor: pointer;
      font-family: 'Nunito', sans-serif; transition: all 0.2s;
      background: linear-gradient(135deg, #667eea, #764ba2); color: white;
    }
    .next-btn:hover { transform: translateY(-2px); }
    
    /* Progress */
    .progress-header {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 15px;
    }
    .back-btn {
      background: rgba(255,255,255,0.9); border: none; padding: 10px 18px;
      border-radius: 25px; font-weight: 700; cursor: pointer;
      font-family: 'Nunito', sans-serif; color: #333;
    }
    .progress-dots { display: flex; gap: 8px; }
    .dot {
      width: 12px; height: 12px; border-radius: 50%;
      background: rgba(255,255,255,0.4);
    }
    .dot.active { background: white; }
    .dot.done { background: #4CAF50; }
    .star-count {
      background: rgba(255,255,255,0.9); padding: 8px 15px;
      border-radius: 20px; font-weight: 700; color: #FF9800;
    }
    
    /* RESULT SCREEN */
    .result-content { text-align: center; padding-top: 40px; }
    .result-card {
      background: white; border-radius: 25px; padding: 35px 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    }
    .result-emoji { font-size: 80px; margin-bottom: 15px; }
    .result-title { font-size: 1.8rem; font-weight: 800; color: #333; margin-bottom: 10px; }
    .result-stars { font-size: 45px; margin: 15px 0; }
    .result-message { font-size: 1.1rem; color: #666; margin-bottom: 25px; }
    .result-buttons { display: flex; flex-direction: column; gap: 12px; }
    .result-btn {
      padding: 15px 25px; font-size: 1.1rem; font-weight: 700;
      border: none; border-radius: 50px; cursor: pointer;
      font-family: 'Nunito', sans-serif;
    }
    .result-btn.primary {
      background: linear-gradient(135deg, #4CAF50, #8BC34A); color: white;
    }
    .result-btn.secondary {
      background: #F5F5F5; color: #333;
    }
    
    /* LEARN SCREEN - Visual Patterns */
    .pattern-card {
      background: white; border-radius: 20px; padding: 25px;
      margin-bottom: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    .pattern-title {
      display: flex; align-items: center; gap: 10px;
      font-size: 1.3rem; font-weight: 700; color: #333; margin-bottom: 20px;
    }
    .pattern-title .icon { font-size: 30px; }
    
    .example-row {
      display: flex; align-items: center; gap: 15px;
      padding: 15px; margin-bottom: 10px; border-radius: 12px;
      background: #F5F5F5;
    }
    .example-row .emoji { font-size: 35px; }
    .example-row .sentence { font-size: 1.1rem; color: #333; }
    .example-row .sentence strong { color: #4CAF50; }
    .example-row .sentence .past { color: #FF9800; }
    
    .tip-bubble {
      background: linear-gradient(135deg, #E3F2FD, #BBDEFB);
      padding: 15px 20px; border-radius: 15px;
      display: flex; align-items: flex-start; gap: 12px;
      margin-top: 15px;
    }
    .tip-bubble .bulb { font-size: 25px; }
    .tip-bubble .tip-text { font-size: 1rem; color: #1565C0; }
    
    /* Visual comparison */
    .compare-box {
      display: grid; grid-template-columns: 1fr 1fr; gap: 15px;
      margin: 20px 0;
    }
    .compare-side {
      padding: 20px 15px; border-radius: 15px; text-align: center;
    }
    .compare-side.now { background: #E8F5E9; }
    .compare-side.past { background: #FFF3E0; }
    .compare-side .label {
      font-weight: 700; margin-bottom: 10px; font-size: 1rem;
    }
    .compare-side.now .label { color: #2E7D32; }
    .compare-side.past .label { color: #E65100; }
    .compare-side .time-words {
      display: flex; flex-wrap: wrap; gap: 6px; justify-content: center;
      margin-bottom: 12px;
    }
    .time-word {
      background: white; padding: 5px 12px; border-radius: 20px;
      font-size: 0.85rem; font-weight: 600;
    }
    .compare-side.now .time-word { color: #4CAF50; }
    .compare-side.past .time-word { color: #FF9800; }
    .compare-side .example {
      background: white; padding: 10px; border-radius: 10px;
      font-size: 0.95rem; color: #333;
    }
    
    /* Word cards for irregular verbs */
    .word-pairs { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .word-pair {
      display: flex; align-items: center; justify-content: center; gap: 8px;
      background: #F5F5F5; padding: 12px; border-radius: 12px;
    }
    .word-pair .now { color: #4CAF50; font-weight: 700; }
    .word-pair .arrow { color: #999; }
    .word-pair .past { color: #FF9800; font-weight: 700; }
    .word-pair .meaning { color: #999; font-size: 0.85rem; }
    
    /* Matching game */
    .match-instruction {
      text-align: center; color: white; font-size: 1.1rem;
      margin-bottom: 20px; padding: 15px;
      background: rgba(255,255,255,0.2); border-radius: 15px;
    }
    .match-grid {
      display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;
    }
    .match-card {
      padding: 18px 10px; border-radius: 15px; font-size: 1.1rem;
      font-weight: 700; cursor: pointer; text-align: center;
      font-family: 'Nunito', sans-serif; border: none;
      transition: all 0.2s;
    }
    .match-card.type-now { background: #E8F5E9; color: #2E7D32; }
    .match-card.type-past { background: #FFF3E0; color: #E65100; }
    .match-card.selected { transform: scale(1.05); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
    .match-card.matched { opacity: 0.5; cursor: default; }
    
    .match-score {
      text-align: center; margin-top: 20px;
      background: white; padding: 15px; border-radius: 15px;
      font-size: 1.2rem; font-weight: 700;
    }
    
    /* Flashcards */
    .flashcard-container { perspective: 1000px; margin: 20px 0; }
    .flashcard {
      width: 100%; height: 200px; cursor: pointer;
      position: relative; transform-style: preserve-3d;
      transition: transform 0.6s;
    }
    .flashcard.flipped { transform: rotateY(180deg); }
    .flashcard-face {
      position: absolute; width: 100%; height: 100%;
      backface-visibility: hidden; border-radius: 20px;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      padding: 20px;
    }
    .flashcard-front { background: linear-gradient(135deg, #E8F5E9, #C8E6C9); }
    .flashcard-back {
      background: linear-gradient(135deg, #FFF3E0, #FFE0B2);
      transform: rotateY(180deg);
    }
    .flashcard-word { font-size: 2.5rem; font-weight: 800; margin-bottom: 10px; }
    .flashcard-front .flashcard-word { color: #2E7D32; }
    .flashcard-back .flashcard-word { color: #E65100; }
    .flashcard-label { font-size: 1rem; color: #666; }
    .flashcard-meaning { font-size: 1.1rem; color: #666; margin-top: 10px; }
    .flashcard-hint { font-size: 0.9rem; color: #999; margin-top: 15px; }
    
    .flashcard-nav {
      display: flex; justify-content: center; gap: 15px; margin-top: 20px;
    }
    .flashcard-btn {
      padding: 12px 25px; border-radius: 25px; font-weight: 700;
      cursor: pointer; font-family: 'Nunito', sans-serif; border: none;
      background: white; color: #333;
    }
    .flashcard-btn:hover { background: #F5F5F5; }
    
    /* Confetti */
    .confetti-container {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none; z-index: 1000;
    }
    .confetti {
      position: absolute; width: 10px; height: 10px;
      animation: confettiFall 3s linear forwards;
    }
    @keyframes confettiFall {
      0% { transform: translateY(-100%) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }
    
    /* Responsive */
    @media (max-width: 400px) {
      .app-title { font-size: 1.8rem; }
      .scene-text { font-size: 1.2rem; }
      .choice-btn { font-size: 1rem; padding: 15px 20px; }
    }
  </style>
</head>
<body>
  <div class="app-container bg-fun" id="appContainer">
    <button class="sound-toggle" id="soundToggle" onclick="toggleSound()">ğŸ”Š</button>
    <div id="confettiContainer" class="confetti-container"></div>
    
    <!-- HOME SCREEN -->
    <div id="homeScreen" class="screen active">
      <div class="home-content">
        <div class="mascot-large">ğŸ¦‰</div>
        <h1 class="app-title">Fun English!</h1>
        <p class="app-tagline">Há»c tiáº¿ng Anh vui váº» má»—i ngÃ y</p>
        
        <div class="topic-grid">
          <div class="topic-card daily" onclick="startTopic('daily')">
            <div class="topic-icon">â˜€ï¸</div>
            <div class="topic-name">Every Day</div>
          </div>
          <div class="topic-card yesterday" onclick="startTopic('yesterday')">
            <div class="topic-icon">ğŸŒ™</div>
            <div class="topic-name">Yesterday</div>
          </div>
          <div class="topic-card stories" onclick="startTopic('stories')">
            <div class="topic-icon">ğŸ“–</div>
            <div class="topic-name">Stories</div>
          </div>
          <div class="topic-card games" onclick="startTopic('games')">
            <div class="topic-icon">ğŸ®</div>
            <div class="topic-name">Word Games</div>
          </div>
        </div>
        
        <div class="streak-banner" id="streakBanner">
          <span>ğŸ”¥</span>
          <span id="streakText">Báº¯t Ä‘áº§u há»c nÃ o!</span>
        </div>
      </div>
    </div>
    
    <!-- STORY SCREEN -->
    <div id="storyScreen" class="screen"></div>
    
    <!-- RESULT SCREEN -->
    <div id="resultScreen" class="screen"></div>
    
    <!-- LEARN SCREEN -->
    <div id="learnScreen" class="screen"></div>
    
    <!-- GAME SCREEN -->
    <div id="gameScreen" class="screen"></div>
  </div>

<script>
// ============ DATA - Cambridge Style ============
var STORIES = {
  daily: [
    {
      bg: 'bg-sunny',
      scenes: [
        {
          image: 'ğŸŒ…ğŸ‘§',
          text: 'This is Lily. She <span class="highlight-green">wakes up</span> at 7 o\'clock <span class="highlight">every morning</span>.',
          question: 'Lily wakes up at 7...',
          choices: ['every morning â˜€ï¸', 'yesterday morning ğŸŒ™'],
          correct: 0,
          feedback: 'Yes! Every morning = má»—i sÃ¡ng ğŸ‘',
          tip: 'â˜€ï¸ "every morning" - viá»‡c Lily lÃ m má»—i ngÃ y!'
        },
        {
          image: 'ğŸ³ğŸ‘§',
          text: 'Lily <span class="highlight-green">eats</span> breakfast <span class="highlight">every day</span>. She likes eggs!',
          question: 'Lily ___ breakfast every day.',
          choices: ['eats ğŸ³', 'ate ğŸ³'],
          correct: 0,
          feedback: 'Great! Every day â†’ eats ğŸŒŸ',
          tip: 'ğŸ”„ "every day" - viá»‡c lÃ m má»—i ngÃ y â†’ eats'
        },
        {
          image: 'ğŸš¶â€â™€ï¸ğŸ«',
          text: 'She <span class="highlight-green">walks</span> to school <span class="highlight">every day</span>. Her school is near her house.',
          question: 'Lily ___ to school every day.',
          choices: ['walks ğŸš¶â€â™€ï¸', 'walked ğŸš¶â€â™€ï¸'],
          correct: 0,
          feedback: 'Perfect! Má»—i ngÃ y Lily Ä‘i bá»™ Ä‘áº¿n trÆ°á»ng ğŸ’',
          tip: 'ğŸ« Viá»‡c láº·p láº¡i má»—i ngÃ y â†’ walks'
        },
        {
          image: 'ğŸ“šğŸ‘§',
          text: 'Lily <span class="highlight-green">studies</span> English <span class="highlight">every afternoon</span>. She loves it!',
          question: 'Lily ___ English every afternoon.',
          choices: ['studies ğŸ“–', 'studied ğŸ“–'],
          correct: 0,
          feedback: 'Wonderful! Lily há»c tiáº¿ng Anh má»—i chiá»u â­',
          tip: 'ğŸ“š "every afternoon" â†’ viá»‡c lÃ m thÆ°á»ng xuyÃªn'
        },
        {
          image: 'ğŸ˜´ğŸ›ï¸',
          text: 'At night, Lily <span class="highlight-green">goes</span> to bed at 9 o\'clock. Good night, Lily!',
          question: 'Lily ___ to bed at 9 every night.',
          choices: ['goes ğŸ˜´', 'went ğŸ˜´'],
          correct: 0,
          feedback: 'Excellent! Lily Ä‘i ngá»§ lÃºc 9 giá» má»—i tá»‘i ğŸŒ™',
          tip: 'ğŸŒ™ ThÃ³i quen má»—i tá»‘i â†’ goes'
        }
      ]
    },
    {
      bg: 'bg-park',
      scenes: [
        {
          image: 'ğŸ‘¦ğŸ•',
          text: 'This is Tom and his dog Max. They <span class="highlight-green">play</span> in the park <span class="highlight">every weekend</span>.',
          question: 'Tom and Max ___ in the park every weekend.',
          choices: ['play ğŸ¾', 'played ğŸ¾'],
          correct: 0,
          feedback: 'Yes! Má»—i cuá»‘i tuáº§n Tom vÃ  Max chÆ¡i trong cÃ´ng viÃªn ğŸŒ³',
          tip: 'ğŸƒ "every weekend" â†’ viá»‡c lÃ m thÆ°á»ng xuyÃªn'
        },
        {
          image: 'ğŸ•ğŸ’¨',
          text: 'Max <span class="highlight-green">runs</span> very fast! He <span class="highlight-green">loves</span> to catch the ball.',
          question: 'Max ___ very fast.',
          choices: ['runs ğŸƒ', 'ran ğŸƒ'],
          correct: 0,
          feedback: 'Great! Max cháº¡y ráº¥t nhanh ğŸ•',
          tip: 'ğŸ• Äiá»u Max luÃ´n lÃ m â†’ runs'
        },
        {
          image: 'ğŸ¦†ğŸŒŠ',
          text: 'There are ducks in the pond. The ducks <span class="highlight-green">swim</span> <span class="highlight">every day</span>.',
          question: 'The ducks ___ every day.',
          choices: ['swim ğŸ¦†', 'swam ğŸ¦†'],
          correct: 0,
          feedback: 'Perfect! Nhá»¯ng chÃº vá»‹t bÆ¡i má»—i ngÃ y ğŸŒŠ',
          tip: 'ğŸ¦† "every day" â†’ swim'
        },
        {
          image: 'â˜€ï¸ğŸ˜Š',
          text: 'The sun <span class="highlight-green">shines</span> in the sky. It\'s a beautiful day!',
          question: 'The sun ___ in the sky.',
          choices: ['shines â˜€ï¸', 'shined â˜€ï¸'],
          correct: 0,
          feedback: 'Wonderful! Máº·t trá»i tá»a sÃ¡ng - Ä‘iá»u luÃ´n xáº£y ra â˜€ï¸',
          tip: 'â˜€ï¸ Sá»± tháº­t luÃ´n Ä‘Ãºng â†’ shines'
        }
      ]
    }
  ],
  yesterday: [
    {
      bg: 'bg-night',
      scenes: [
        {
          image: 'ğŸŒ™ğŸ‘§',
          text: '<span class="highlight-orange">Yesterday</span>, Lily <span class="highlight-orange">woke up</span> late. It was Sunday!',
          question: 'Yesterday, Lily ___ up late.',
          choices: ['woke ğŸ›ï¸', 'wakes ğŸ›ï¸'],
          correct: 0,
          feedback: 'Yes! HÃ´m qua Lily dáº­y muá»™n ğŸ˜´',
          tip: 'ğŸŒ™ "yesterday" â†’ Ä‘Ã£ xáº£y ra â†’ woke'
        },
        {
          image: 'ğŸ¥ğŸ‘¨â€ğŸ³',
          text: 'Dad <span class="highlight-orange">made</span> pancakes for breakfast <span class="highlight-orange">yesterday</span>. Yummy!',
          question: 'Yesterday, Dad ___ pancakes.',
          choices: ['made ğŸ¥', 'makes ğŸ¥'],
          correct: 0,
          feedback: 'Great! HÃ´m qua bá»‘ lÃ m bÃ¡nh pancake ğŸ˜‹',
          tip: 'ğŸ¥ "yesterday" â†’ Ä‘Ã£ xong â†’ made'
        },
        {
          image: 'ğŸ¢ğŸ‘¨â€ğŸ‘©â€ğŸ‘§',
          text: 'The family <span class="highlight-orange">went</span> to the park <span class="highlight-orange">yesterday</span>. They had fun!',
          question: 'Yesterday, the family ___ to the park.',
          choices: ['went ğŸ¢', 'go ğŸ¢'],
          correct: 0,
          feedback: 'Perfect! HÃ´m qua cáº£ nhÃ  Ä‘i cÃ´ng viÃªn ğŸ‰',
          tip: 'ğŸŒ³ "yesterday" - viá»‡c Ä‘Ã£ xáº£y ra â†’ went'
        },
        {
          image: 'ğŸ¦ğŸ˜‹',
          text: 'Lily <span class="highlight-orange">ate</span> ice cream <span class="highlight-orange">yesterday</span>. It was delicious!',
          question: 'Yesterday, Lily ___ ice cream.',
          choices: ['ate ğŸ¦', 'eats ğŸ¦'],
          correct: 0,
          feedback: 'Wonderful! HÃ´m qua Lily Äƒn kem ğŸ¦',
          tip: 'ğŸ¦ "yesterday" â†’ ate (khÃ´ng pháº£i eats)'
        },
        {
          image: 'ğŸ˜´ğŸ’¤',
          text: 'At night, everyone <span class="highlight-orange">slept</span> well. What a great day!',
          question: 'Last night, everyone ___ well.',
          choices: ['slept ğŸ˜´', 'sleeps ğŸ˜´'],
          correct: 0,
          feedback: 'Excellent! Tá»‘i qua má»i ngÆ°á»i ngá»§ ngon ğŸŒ™',
          tip: 'ğŸ˜´ "last night" - Ä‘Ã£ qua â†’ slept'
        }
      ]
    },
    {
      bg: 'bg-school',
      scenes: [
        {
          image: 'ğŸ“šğŸ‘¦',
          text: '<span class="highlight-orange">Last week</span>, Tom <span class="highlight-orange">had</span> a test at school.',
          question: 'Last week, Tom ___ a test.',
          choices: ['had ğŸ“', 'has ğŸ“'],
          correct: 0,
          feedback: 'Yes! Tuáº§n trÆ°á»›c Tom cÃ³ bÃ i kiá»ƒm tra ğŸ“š',
          tip: 'ğŸ“… "last week" - tuáº§n trÆ°á»›c â†’ had'
        },
        {
          image: 'âœï¸ğŸ“–',
          text: 'He <span class="highlight-orange">studied</span> very hard <span class="highlight-orange">last week</span>.',
          question: 'Tom ___ very hard last week.',
          choices: ['studied ğŸ“–', 'studies ğŸ“–'],
          correct: 0,
          feedback: 'Great! Tom Ä‘Ã£ há»c ráº¥t chÄƒm ğŸ’ª',
          tip: 'âœï¸ "last week" â†’ studied'
        },
        {
          image: 'âœ…ğŸ’¯',
          text: 'Tom <span class="highlight-orange">got</span> 100 points! He was very happy!',
          question: 'Tom ___ 100 points!',
          choices: ['got ğŸ†', 'gets ğŸ†'],
          correct: 0,
          feedback: 'Perfect! Tom Ä‘Æ°á»£c 100 Ä‘iá»ƒm! ğŸ‰',
          tip: 'ğŸ’¯ Viá»‡c Ä‘Ã£ xáº£y ra â†’ got'
        },
        {
          image: 'ğŸğŸ‘¨â€ğŸ‘©â€ğŸ‘¦',
          text: 'Mom and Dad <span class="highlight-orange">gave</span> Tom a gift <span class="highlight-orange">yesterday</span>.',
          question: 'Yesterday, Mom and Dad ___ Tom a gift.',
          choices: ['gave ğŸ', 'give ğŸ'],
          correct: 0,
          feedback: 'Wonderful! HÃ´m qua bá»‘ máº¹ táº·ng quÃ  cho Tom ğŸ',
          tip: 'ğŸ "yesterday" â†’ gave'
        }
      ]
    }
  ],
  stories: [
    {
      bg: 'bg-home',
      scenes: [
        {
          image: 'ğŸ‘§ğŸ“…',
          text: 'Lily\'s day: She <span class="highlight-green">wakes up</span> at 7 <span class="highlight">every morning</span>.',
          question: 'Every morning, Lily...',
          choices: ['wakes up at 7 â˜€ï¸', 'woke up at 7 ğŸŒ™'],
          correct: 0,
          feedback: 'Yes! Má»—i sÃ¡ng = every morning â†’ wakes up',
          tip: 'â˜€ï¸ Every = má»—i â†’ viá»‡c lÃ m thÆ°á»ng xuyÃªn'
        },
        {
          image: 'ğŸ‘§ğŸŒ™',
          text: 'But <span class="highlight-orange">yesterday</span>, Lily <span class="highlight-orange">woke up</span> at 9! She was late!',
          question: 'Yesterday, Lily...',
          choices: ['woke up at 9 ğŸ˜±', 'wakes up at 9 â˜€ï¸'],
          correct: 0,
          feedback: 'Yes! HÃ´m qua = yesterday â†’ woke up',
          tip: 'ğŸŒ™ Yesterday = hÃ´m qua â†’ viá»‡c Ä‘Ã£ xáº£y ra'
        },
        {
          image: 'ğŸğŸ‘§',
          text: 'Lily <span class="highlight-green">eats</span> an apple <span class="highlight">every day</span>. Apples are healthy!',
          question: 'Every day, Lily ___ an apple.',
          choices: ['eats ğŸ', 'ate ğŸ'],
          correct: 0,
          feedback: 'Great! Má»—i ngÃ y Lily Äƒn tÃ¡o ğŸ',
          tip: 'ğŸ "every day" â†’ eats'
        },
        {
          image: 'ğŸ•ğŸ‘§',
          text: 'But <span class="highlight-orange">yesterday</span>, she <span class="highlight-orange">ate</span> pizza! It was her birthday!',
          question: 'Yesterday, Lily ___ pizza.',
          choices: ['ate ğŸ•', 'eats ğŸ•'],
          correct: 0,
          feedback: 'Perfect! HÃ´m qua Lily Äƒn pizza ğŸ‚',
          tip: 'ğŸ• "yesterday" â†’ ate'
        },
        {
          image: 'ğŸš¶â€â™€ï¸ğŸ«',
          text: 'Lily <span class="highlight-green">walks</span> to school <span class="highlight">every day</span>.',
          question: 'Every day, Lily ___ to school.',
          choices: ['walks ğŸš¶â€â™€ï¸', 'walked ğŸš¶â€â™€ï¸'],
          correct: 0,
          feedback: 'Wonderful! Má»—i ngÃ y Lily Ä‘i bá»™ ğŸ«',
          tip: 'ğŸš¶â€â™€ï¸ "every day" â†’ walks'
        },
        {
          image: 'ğŸš—ğŸ‘¨',
          text: 'But <span class="highlight-orange">yesterday</span>, Dad <span class="highlight-orange">drove</span> her to school!',
          question: 'Yesterday, Dad ___ Lily to school.',
          choices: ['drove ğŸš—', 'drives ğŸš—'],
          correct: 0,
          feedback: 'Excellent! HÃ´m qua bá»‘ lÃ¡i xe Ä‘Æ°a Lily ğŸš—',
          tip: 'ğŸš— "yesterday" â†’ drove'
        }
      ]
    }
  ]
};

var WORD_GAMES = {
  matching: [
    { now: 'go', past: 'went', meaning: 'Ä‘i' },
    { now: 'eat', past: 'ate', meaning: 'Äƒn' },
    { now: 'see', past: 'saw', meaning: 'tháº¥y' },
    { now: 'have', past: 'had', meaning: 'cÃ³' },
    { now: 'make', past: 'made', meaning: 'lÃ m' },
    { now: 'come', past: 'came', meaning: 'Ä‘áº¿n' },
    { now: 'take', past: 'took', meaning: 'láº¥y' },
    { now: 'give', past: 'gave', meaning: 'cho' },
    { now: 'run', past: 'ran', meaning: 'cháº¡y' },
    { now: 'swim', past: 'swam', meaning: 'bÆ¡i' },
    { now: 'drink', past: 'drank', meaning: 'uá»‘ng' },
    { now: 'sing', past: 'sang', meaning: 'hÃ¡t' },
    { now: 'sleep', past: 'slept', meaning: 'ngá»§' },
    { now: 'write', past: 'wrote', meaning: 'viáº¿t' },
    { now: 'read', past: 'read', meaning: 'Ä‘á»c' },
    { now: 'buy', past: 'bought', meaning: 'mua' },
    { now: 'get', past: 'got', meaning: 'láº¥y/Ä‘Æ°á»£c' },
    { now: 'sit', past: 'sat', meaning: 'ngá»“i' },
    { now: 'stand', past: 'stood', meaning: 'Ä‘á»©ng' },
    { now: 'fly', past: 'flew', meaning: 'bay' }
  ]
};

// ============ STATE ============
var soundEnabled = true;
var currentTopic = '';
var currentStory = 0;
var currentScene = 0;
var stars = 0;
var totalQuestions = 0;
var correctAnswers = 0;

// Matching game state
var matchCards = [];
var selectedCard = null;
var matchedPairs = [];

// Flashcard state
var flashcardIndex = 0;
var isFlipped = false;

// ============ SOUND ============
function playSound(type) {
  if (!soundEnabled) return;
  try {
    var ctx = new (window.AudioContext || window.webkitAudioContext)();
    var osc = ctx.createOscillator();
    var gain = ctx.createGain();
    osc.connect(gain);
    gain.connect(ctx.destination);
    
    if (type === 'correct') {
      osc.frequency.setValueAtTime(523, ctx.currentTime);
      osc.frequency.setValueAtTime(659, ctx.currentTime + 0.1);
      osc.frequency.setValueAtTime(784, ctx.currentTime + 0.2);
      gain.gain.setValueAtTime(0.3, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.4);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.4);
    } else if (type === 'wrong') {
      osc.frequency.setValueAtTime(330, ctx.currentTime);
      osc.frequency.setValueAtTime(294, ctx.currentTime + 0.15);
      gain.gain.setValueAtTime(0.2, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.3);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.3);
    } else if (type === 'click') {
      osc.frequency.setValueAtTime(800, ctx.currentTime);
      gain.gain.setValueAtTime(0.1, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.05);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.05);
    } else if (type === 'complete') {
      [523, 659, 784, 1047].forEach(function(freq, i) {
        var o = ctx.createOscillator();
        var g = ctx.createGain();
        o.connect(g); g.connect(ctx.destination);
        o.frequency.setValueAtTime(freq, ctx.currentTime + i * 0.15);
        g.gain.setValueAtTime(0.2, ctx.currentTime + i * 0.15);
        g.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + i * 0.15 + 0.2);
        o.start(ctx.currentTime + i * 0.15);
        o.stop(ctx.currentTime + i * 0.15 + 0.2);
      });
    } else if (type === 'flip') {
      osc.frequency.setValueAtTime(600, ctx.currentTime);
      osc.frequency.setValueAtTime(900, ctx.currentTime + 0.05);
      gain.gain.setValueAtTime(0.15, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.1);
    }
  } catch(e) {}
}

function toggleSound() {
  soundEnabled = !soundEnabled;
  document.getElementById('soundToggle').textContent = soundEnabled ? 'ğŸ”Š' : 'ğŸ”‡';
}

// ============ CONFETTI ============
function showConfetti() {
  var container = document.getElementById('confettiContainer');
  container.innerHTML = '';
  var colors = ['#FFD700','#FF6B6B','#4CAF50','#2196F3','#E91E63'];
  for (var i = 0; i < 30; i++) {
    var c = document.createElement('div');
    c.className = 'confetti';
    c.style.left = Math.random() * 100 + '%';
    c.style.background = colors[Math.floor(Math.random() * colors.length)];
    c.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
    c.style.animationDelay = Math.random() * 0.5 + 's';
    container.appendChild(c);
  }
  setTimeout(function() { container.innerHTML = ''; }, 3000);
}

// ============ NAVIGATION ============
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(function(s) {
    s.classList.remove('active');
  });
  document.getElementById(id).classList.add('active');
}

function goHome() {
  document.getElementById('appContainer').className = 'app-container bg-fun';
  showScreen('homeScreen');
}

// ============ SHUFFLE ============
function shuffle(arr) {
  var a = arr.slice();
  for (var i = a.length - 1; i > 0; i--) {
    var j = Math.floor(Math.random() * (i + 1));
    var t = a[i]; a[i] = a[j]; a[j] = t;
  }
  return a;
}

// ============ TOPIC START ============
function startTopic(topic) {
  playSound('click');
  currentTopic = topic;
  
  if (topic === 'games') {
    showGameMenu();
  } else if (STORIES[topic]) {
    currentStory = Math.floor(Math.random() * STORIES[topic].length);
    currentScene = 0;
    stars = 0;
    correctAnswers = 0;
    totalQuestions = STORIES[topic][currentStory].scenes.length;
    showStory();
  }
}

// ============ STORY ============
function showStory() {
  var story = STORIES[currentTopic][currentStory];
  var scene = story.scenes[currentScene];
  
  document.getElementById('appContainer').className = 'app-container ' + story.bg;
  
  var dotsHtml = '';
  for (var i = 0; i < story.scenes.length; i++) {
    var dotClass = 'dot';
    if (i < currentScene) dotClass += ' done';
    else if (i === currentScene) dotClass += ' active';
    dotsHtml += '<div class="' + dotClass + '"></div>';
  }
  
  var html = '<div class="progress-header">' +
    '<button class="back-btn" onclick="goHome()">â† Home</button>' +
    '<div class="progress-dots">' + dotsHtml + '</div>' +
    '<div class="star-count">â­ ' + stars + '</div>' +
    '</div>' +
    '<div class="story-scene">' +
    '<div class="scene-image">' + scene.image + '</div>' +
    '<div class="scene-text">' + scene.text + '</div>' +
    '<div class="scene-question">' + scene.question + '</div>' +
    '<div class="choice-buttons">';
  
  scene.choices.forEach(function(choice, i) {
    html += '<button class="choice-btn" id="choice' + i + '" onclick="checkAnswer(' + i + ')">' + choice + '</button>';
  });
  
  html += '</div><div id="feedbackArea"></div></div>';
  
  document.getElementById('storyScreen').innerHTML = html;
  showScreen('storyScreen');
}

function checkAnswer(index) {
  var story = STORIES[currentTopic][currentStory];
  var scene = story.scenes[currentScene];
  var correct = index === scene.correct;
  
  // Disable all buttons
  document.querySelectorAll('.choice-btn').forEach(function(btn, i) {
    btn.disabled = true;
    if (i === scene.correct) btn.classList.add('correct');
    if (i === index && !correct) btn.classList.add('wrong');
  });
  
  if (correct) {
    stars++;
    correctAnswers++;
    playSound('correct');
    if (stars % 3 === 0) showConfetti();
  } else {
    playSound('wrong');
  }
  
  var feedbackHtml = '<div class="feedback-box ' + (correct ? 'correct' : 'wrong') + '">' +
    '<div class="feedback-emoji">' + (correct ? 'ğŸ‰' : 'ğŸ’ª') + '</div>' +
    '<div class="feedback-text">' + scene.feedback + '</div>' +
    '<div class="feedback-tip">' + scene.tip + '</div>' +
    '<button class="next-btn" onclick="nextScene()">' +
    (currentScene < story.scenes.length - 1 ? 'Next â†’' : 'Finish! ğŸ†') +
    '</button></div>';
  
  document.getElementById('feedbackArea').innerHTML = feedbackHtml;
}

function nextScene() {
  var story = STORIES[currentTopic][currentStory];
  
  if (currentScene < story.scenes.length - 1) {
    currentScene++;
    showStory();
  } else {
    showResult();
  }
}

// ============ RESULT ============
function showResult() {
  playSound('complete');
  showConfetti();
  
  var percentage = Math.round((correctAnswers / totalQuestions) * 100);
  var starCount = Math.min(3, Math.floor(percentage / 33) + (percentage > 0 ? 1 : 0));
  var starsHtml = '';
  for (var i = 0; i < 3; i++) {
    starsHtml += i < starCount ? 'â­' : 'â˜†';
  }
  
  var emoji = percentage >= 80 ? 'ğŸ†' : percentage >= 50 ? 'ğŸŒŸ' : 'ğŸ’ª';
  var message = percentage >= 80 ? 'Excellent! Con giá»i láº¯m!' : 
                percentage >= 50 ? 'Good job! Tiáº¿p tá»¥c nhÃ©!' : 
                'Keep trying! Cá»‘ gáº¯ng lÃªn nÃ o!';
  
  document.getElementById('appContainer').className = 'app-container bg-fun';
  
  var html = '<div class="result-content"><div class="result-card">' +
    '<div class="result-emoji">' + emoji + '</div>' +
    '<div class="result-title">Well Done!</div>' +
    '<div class="result-stars">' + starsHtml + '</div>' +
    '<div class="result-message">' + message + '</div>' +
    '<div class="result-buttons">' +
    '<button class="result-btn primary" onclick="startTopic(\'' + currentTopic + '\')">Play Again ğŸ”„</button>' +
    '<button class="result-btn secondary" onclick="goHome()">Home ğŸ </button>' +
    '</div></div></div>';
  
  document.getElementById('resultScreen').innerHTML = html;
  showScreen('resultScreen');
}

// ============ GAME MENU ============
function showGameMenu() {
  document.getElementById('appContainer').className = 'app-container bg-fun';
  
  var html = '<div class="progress-header" style="margin-bottom:20px">' +
    '<button class="back-btn" onclick="goHome()">â† Home</button>' +
    '<div style="color:white;font-weight:700;font-size:1.2rem">ğŸ® Word Games</div>' +
    '<div></div></div>' +
    
    '<div class="topic-grid">' +
    '<div class="topic-card" onclick="startMatchingGame()" style="border-color:#9C27B0">' +
    '<div class="topic-icon">ğŸ¯</div>' +
    '<div class="topic-name">Matching</div>' +
    '</div>' +
    '<div class="topic-card" onclick="startFlashcards()" style="border-color:#FF9800">' +
    '<div class="topic-icon">ğŸ´</div>' +
    '<div class="topic-name">Flashcards</div>' +
    '</div>' +
    '</div>' +
    
    // Visual learning section
    '<div class="pattern-card" style="margin-top:20px">' +
    '<div class="pattern-title"><span class="icon">ğŸ’¡</span> Nhá»› nhanh!</div>' +
    '<div class="compare-box">' +
    '<div class="compare-side now">' +
    '<div class="label">â˜€ï¸ Every day</div>' +
    '<div class="time-words"><span class="time-word">every day</span><span class="time-word">always</span></div>' +
    '<div class="example">I <strong>go</strong> to school.</div>' +
    '</div>' +
    '<div class="compare-side past">' +
    '<div class="label">ğŸŒ™ Yesterday</div>' +
    '<div class="time-words"><span class="time-word">yesterday</span><span class="time-word">last week</span></div>' +
    '<div class="example">I <strong style="color:#E65100">went</strong> to school.</div>' +
    '</div></div>' +
    '<div class="tip-bubble"><span class="bulb">ğŸ’¡</span>' +
    '<span class="tip-text">Tháº¥y <strong>every</strong> â†’ dÃ¹ng tá»« bÃ¬nh thÆ°á»ng<br>' +
    'Tháº¥y <strong>yesterday/last</strong> â†’ dÃ¹ng tá»« Ä‘áº·c biá»‡t!</span></div>' +
    '</div>';
  
  document.getElementById('gameScreen').innerHTML = html;
  showScreen('gameScreen');
}

// ============ MATCHING GAME ============
function startMatchingGame() {
  playSound('click');
  
  var words = shuffle(WORD_GAMES.matching).slice(0, 6);
  matchCards = [];
  selectedCard = null;
  matchedPairs = [];
  
  words.forEach(function(w, i) {
    matchCards.push({ id: 'now-' + i, text: w.now, type: 'now', pairId: i });
    matchCards.push({ id: 'past-' + i, text: w.past, type: 'past', pairId: i });
  });
  matchCards = shuffle(matchCards);
  
  renderMatchingGame();
}

function renderMatchingGame() {
  var html = '<div class="progress-header" style="margin-bottom:20px">' +
    '<button class="back-btn" onclick="showGameMenu()">â† Back</button>' +
    '<div style="color:white;font-weight:700">ğŸ¯ Match the pairs!</div>' +
    '<div></div></div>' +
    
    '<div class="match-instruction">ğŸŸ¢ Chá»n tá»« bÃ¬nh thÆ°á»ng â†’ ğŸŸ  Chá»n tá»« Ä‘áº·c biá»‡t cá»§a nÃ³!</div>' +
    
    '<div class="match-grid">';
  
  matchCards.forEach(function(card) {
    var isSelected = selectedCard && selectedCard.id === card.id;
    var isMatched = matchedPairs.indexOf(card.pairId) >= 0;
    html += '<button class="match-card type-' + card.type + 
      (isSelected ? ' selected' : '') + 
      (isMatched ? ' matched' : '') + '" ' +
      (isMatched ? 'disabled' : 'onclick="selectMatchCard(\'' + card.id + '\')"') + '>' +
      card.text + '</button>';
  });
  
  html += '</div>' +
    '<div class="match-score">âœ… ' + matchedPairs.length + ' / 6</div>';
  
  if (matchedPairs.length >= 6) {
    html += '<div style="text-align:center;margin-top:20px">' +
      '<div style="font-size:50px;margin-bottom:10px">ğŸ‰</div>' +
      '<div style="color:white;font-size:1.3rem;font-weight:700;margin-bottom:15px">Excellent!</div>' +
      '<button class="next-btn" onclick="startMatchingGame()">Play Again ğŸ”„</button></div>';
  }
  
  document.getElementById('gameScreen').innerHTML = html;
  showScreen('gameScreen');
}

function selectMatchCard(cardId) {
  playSound('click');
  
  var card = matchCards.find(function(c) { return c.id === cardId; });
  
  if (!selectedCard) {
    selectedCard = card;
    renderMatchingGame();
  } else {
    if (selectedCard.id === card.id) {
      selectedCard = null;
      renderMatchingGame();
      return;
    }
    
    if (selectedCard.pairId === card.pairId && selectedCard.type !== card.type) {
      matchedPairs.push(card.pairId);
      playSound('correct');
      if (matchedPairs.length >= 6) {
        playSound('complete');
        showConfetti();
      }
    } else {
      playSound('wrong');
    }
    selectedCard = null;
    renderMatchingGame();
  }
}

// ============ FLASHCARDS ============
function startFlashcards() {
  playSound('click');
  flashcardIndex = 0;
  isFlipped = false;
  renderFlashcards();
}

function renderFlashcards() {
  var words = WORD_GAMES.matching;
  var word = words[flashcardIndex];
  
  var html = '<div class="progress-header" style="margin-bottom:20px">' +
    '<button class="back-btn" onclick="showGameMenu()">â† Back</button>' +
    '<div style="color:white;font-weight:700">ğŸ´ ' + (flashcardIndex + 1) + ' / ' + words.length + '</div>' +
    '<div></div></div>' +
    
    '<div style="color:white;text-align:center;margin-bottom:15px;font-size:1.1rem">' +
    'ğŸ‘† Cháº¡m tháº» Ä‘á»ƒ láº­t!</div>' +
    
    '<div class="flashcard-container">' +
    '<div class="flashcard' + (isFlipped ? ' flipped' : '') + '" onclick="flipCard()">' +
    '<div class="flashcard-face flashcard-front">' +
    '<div class="flashcard-label">â˜€ï¸ Every day</div>' +
    '<div class="flashcard-word">' + word.now + '</div>' +
    '<div class="flashcard-meaning">(' + word.meaning + ')</div>' +
    '<div class="flashcard-hint">ğŸ‘† Cháº¡m Ä‘á»ƒ xem tá»« Ä‘áº·c biá»‡t</div>' +
    '</div>' +
    '<div class="flashcard-face flashcard-back">' +
    '<div class="flashcard-label">ğŸŒ™ Yesterday</div>' +
    '<div class="flashcard-word">' + word.past + '</div>' +
    '<div class="flashcard-meaning">' + word.now + ' â†’ ' + word.past + '</div>' +
    '</div></div></div>' +
    
    '<div class="flashcard-nav">' +
    '<button class="flashcard-btn" onclick="prevFlashcard()">â† TrÆ°á»›c</button>' +
    '<button class="flashcard-btn" onclick="shuffleFlashcards()">ğŸ”€ Trá»™n</button>' +
    '<button class="flashcard-btn" onclick="nextFlashcard()">Sau â†’</button>' +
    '</div>' +
    
    '<div class="pattern-card" style="margin-top:25px">' +
    '<div class="example-row">' +
    '<span class="emoji">â˜€ï¸</span>' +
    '<span class="sentence">I <strong>' + word.now + '</strong> every day.</span>' +
    '</div>' +
    '<div class="example-row">' +
    '<span class="emoji">ğŸŒ™</span>' +
    '<span class="sentence">I <span class="past">' + word.past + '</span> yesterday.</span>' +
    '</div></div>';
  
  document.getElementById('gameScreen').innerHTML = html;
  showScreen('gameScreen');
}

function flipCard() {
  playSound('flip');
  isFlipped = !isFlipped;
  renderFlashcards();
}

function prevFlashcard() {
  isFlipped = false;
  flashcardIndex = flashcardIndex > 0 ? flashcardIndex - 1 : WORD_GAMES.matching.length - 1;
  renderFlashcards();
}

function nextFlashcard() {
  isFlipped = false;
  flashcardIndex = flashcardIndex < WORD_GAMES.matching.length - 1 ? flashcardIndex + 1 : 0;
  renderFlashcards();
}

function shuffleFlashcards() {
  WORD_GAMES.matching = shuffle(WORD_GAMES.matching);
  flashcardIndex = 0;
  isFlipped = false;
  renderFlashcards();
}
</script>
</body>
</html>
