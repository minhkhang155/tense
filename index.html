<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>Fun English - H·ªçc vui m·ªói ng√†y!</title>
  <link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAALQAAAC0CAIAAACyr5FlAAAL6klEQVR4nO3de3BU1R0H8N/ZRzbvJwSI0YBoEMJDQKkhLSBiQWvHWrQqsdoRWu3Y1qmDj7Gt07GKogw+ptppxTojw9SqLYqP+n6gVlChPEI0RgOBhJAlJGSz2SSb3T39g8Busvs7u0nu3nt39/uZ/JHkPs7v3vu755x77t274hf3OAkgEpuU0ugYwKQsRgcA5oXkABaSA1g2QpcDGKg5gIXkABaSA1hIDmDZCINgwEDNASwkB7BsaFSAg0EwYKFZARaSA1hIDmAhOYCFQTBgoeYAFpIDWEgOYGEQDFioOYCF5AAWbrwBCzUHsDAIBizUHMBCcgALyQEsDIIBCzUHsJAcwEJyAAvJASwMggELNQewcOMNWDady3vgzuLiIo0LfXOr+/lXXdquEyhJBsEkJcNWmA/6HMBCcgALyQEsJAewkmUQLDm2wmRQcwBL73EOtR17ep58tt3oKGCAuZIjpVgsNOOc9HMr0stK08YWWtMdlt6+gMsdaHH69tT27trX43IHjI3QfINgWsSz8pqC+ednclPvf/xoQ6N3xIvf87Cz+Uh/xEmzpqX/ZmURt+CWt7peftNFREJQ1fmZly/NLcy3hs6QmWHJzLCMH2ubXZF+zeV5r7/X9eb77n6fYUcINYfe8nKsq1YUTCt3qGdzpIkrluVWlDse3XCsr8+Y/LDIk6PP+vxEpU9Bo1l8NAuOK7b97taxUTPjlPIzHbeuLCKh6zE69ZOKVytGXfaOLbTe8csxRQXW6LOGmDLZcdF3s+MUklpKJodB5c4/LzM/d3iZccLyS3Iz0oXm8URlvkEwHeKRcnSl8IvHJ3iHQ8yblfHhtu54rFzBXB3SuTMz/r6+dFiLbP6P65W3h/cwh9lOh1hUzs1M9eTQh+Ffpevzy3c/dm/f2dN61BeQ8owS+9JFOXNmZCgWmVSWZrFQQN+Bj9RMDiNLd7kD6/5ytKklOFJSv99bv//YtT/Kv3gB2/G020TJOHvoUjqwGHCFpLlhFiEDcbsOjiYQoMeeams63B++7AuvdLq7VTXDhGKbzkcqFa9WDLR1W/f+g5EHZ30++dU3fYplMzP0PlipmBwGNivvf+JWTG1pVbUa6Q4kR/wZlRvHOvyHDqsOv7pZSXfoPdSRislhlEPNqrt9RNTrVeat7sNg5hoE27G754ln2jRYkXqjog6CjXhx5XLtx/3qNfvVN2Cl3i2iuT7xFqermYgFKVitqpNUEaR6tZ6egHoGf5TpejeIqdisqI89EWVkxKUG9/ujzGCmSpwoNZPDFm3kryAvFccGwyXnk2DqU9CRZlGUYrOKkvHK5BhxuxJ1hlEurrXkrDm8/aq9mJut2urpU9Nt0dqdFJGcydHToxowKBlnV0xdND9L63ASVXImh0eZHDMr0rlJ507PmFWhujuaUpIzOVqcPsXUstK0JZHuf5ZPdtx8PfvseAoy1yDYqJ/RGtB4SHUHi4iqlxecXmJ/7yN3S2u/3S5Kxtvnz8taWJktYulsqII0aPAtPpLzmq29w9/e4S9UPsq7oDJ7QaUxD+4miuRsVojo0y/0fqgu+SRtcny0zW2qBjMR6f4kWFQaFdTq9L39QdcI9khzS//ump6RRziarYtK34OVtJ94k0T/evW4+vGZcAebvA/92dmlfK5CEeToN02fPRPjT9I2K0TU55UPPu5sjvmh3O07PWsedXa6ot0fSxnJebVySqfLf98jrZcvy1uyMFsxKH7E2f/Cls4duz16xmZ+4oZfNRodgx4KC6xzZmbOnJY+bqw9N9uS5rD09gacbb6GA3079/bU1vWi9xpO3HDLAaNjAJNK5j4HjBKSA1hIDmCZ70kwMA3UHMBCcgALyQEsJAewbIa/5gZMCzUHsJAcwEJyAAuDYMBCzQGsJH/YZzT+9FtxRsnA77X1tPZvMpZJWhVhBsYkx41XiYXzos/2zn9p42Zz7a+UgmYFWAZ+HDKGTx7q/gHAwUIjHBKJYpJWRRjPFH2OdRvk3q/MtV/U/rDe4G9f0weaFWCZ5W2CsYRx322WU337ffVy7V/ljClicSWdVSayM8ntoboGueVdefBwhGXnThdLqmhiqUizU0cn1XwtX/9ACkEP3xU8PTZulm9/EjmQIZ84Co8kdObp5aJqLk0qFYX5ZLeTp4eOu6itQzYcon1fy4ZDkb/84EQRsW+RDgwaBJNhfw4zDLtN3HwtzZ8bbLPzcmjeLDG7QqzfIPfVB1cnBK38iVgwLzhncREtrhQLzheb3worVRFGbJNWXT2oLCLKyaKcLDp9gpg9jZYvFeuflrtqI6wr9i3SjSn6HKt/LiL2T2+5J9DFfFa+fBKVT4qwiN1GK68Wq9fIU2fnFd8ferROsNnoqks1fvfXnIrIZcUi9i3SjSmSY2S6PfT083JPnRw/hm6utpSOH/j/mAI6eyLVNRARFeTRDy8K7vHePnrmRbmjRmY4aNlC8YMLNU6OGecEf6+pkxtfkkfbKc1GeblUVCCmTqaKcqE4xrFskZ4SuEO6cbP8Yq/0eungYXrulUG1bumEgaNeNVdYQ97g8u835Kc7pddLnV30z1dlTZ3GdbUjLfj7gWZqcZLPR55eanFSTZ184XX5x0cDe/jrsli2SE+mqDnWPSUVuywiTw9t2xVcpLVNhjZMWSffCHf2xEFLbf18UCkfbKfpU4YXqtrh1uDvly0WlbNF0xHZ2kYtR+nAIXmgWfUS4xi3SE9GDYINPg9iHewK7i/nMRnwBxfxDv4+AiEGVpifGyyou4c8nkGlONsGRzI0DDl0arRJH26XSxdY83IG/l1UQEUFp2YT3R56f5vc/Eag3xdhPTFukZ4StVnpHvx6lZg6a2H7NqbXww1Hl5vufcy/fZf0RaohsjLpssVi1TWR9/lItijOTNGsxM/xkC8VzcqkdAf1hrxncGyh9iUebacnng040mhymThtHBWPEROK6ZwzRdrJ7sgFs8Wml8il+sYms0jy5KjfL2dXBOuHqvPEuyHDXIsuiFcvr89LtfWytp5O1FcTS8W9tw1UGEJQ8Rjhcptk9FElUQfBhi4SvrgkIvrkC7n8Ejp1wXLVpRZXV2B3rUx30LJFlulTwpKDC0MRYciki6rEvHNFTZ2s30/HXdLlpj4v5ecOGtoiIo9HRg44hi3SkylqjtU3RW6GnW20+v5RvYSpo5O2vCOvWDpwbDIz6Nc/i2M3y2ajqWeJqWepKqTmI4MuaswsUTuksXv5rcDWzyKcdD4fvfjaoF6fDlcDHZ305LMm6GrGxiw33jgx3utQNFP+AD31j8D/9oklVWLS6SLNTu2dVFMnX3svkJstrgxZqtsz2lsr73wsGw4Gpkym8kliTAHl5oisTPL7yeWm5iNy95fyo89kL//m7Ri3SDfiulXf6l6oWVz/Y8vF3ws2Ab9fF2hsNvnJoiuTvRg/DvJy6PabrJ/vkfu+lu3HZWcX2W102nix8DviwvnBzGhqkY1NCVPh68MUHdL4ElRWKspKxZWXsrN4vbThOWTGUCmQHNE0H5Ebngt825jkNegIJH9ydLro7of8cyrEtHJRVED5ucJqpd5eauuQjU1yx16550vpR60Ribjuxm+MjgFMKvnHOWDEkBzAQnIAC8kBrOQfBIMRQ80BLLPfeAMDoeYAFt4JBizUHMBCcgALyQEsJAewMAgGLNQcwEJyAAvJASwMggELNQewcOMNWMn/9HmMNt15e+if1WsfNioS80CzQhSWGRH/k4LEip/Wab7STXfdEfpn9YMPaV6EhoZEGyqxItc8Wu1rjvB9rdj7hlPHlliRax6txsnBxWfmvZyI9NnPWiZH4p6FiUW3/azvIFgiXjencMy4WgFWqidH9QOqHr56atJL9eQgPgNSPDNI2+RI3LMwPLbEijb2qcMiVlR/pdW6Tth0953h/6xes1bbUkCH/WyRJ19jqNXPirD4VqxZq3kp+NFhP4trta45IGmgQwosPAkGLNQcwEJyAAvJASwkB7DwcUhgoeYAFpIDWEgOYGEQDFj4xBuw0KwAC8kBLCQHsDAIBizUHMBCcgALyQEsDIIBCzUHsJAcwEJyAOv/Jmy8S5nchcUAAAAASUVORK5CYII=">
  <link rel="apple-touch-icon" href="apple-touch-icon.png">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Fun English">
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700;800&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Nunito', sans-serif;
      min-height: 100vh;
      overflow-x: hidden;
    }
    
    .app-container { max-width: 500px; margin: 0 auto; min-height: 100vh; }
    
    /* Backgrounds for different themes */
    .bg-sunny { background: linear-gradient(180deg, #87CEEB 0%, #98D8C8 100%); }
    .bg-night { background: linear-gradient(180deg, #2C3E50 0%, #4A569D 100%); }
    .bg-park { background: linear-gradient(180deg, #87CEEB 0%, #90EE90 100%); }
    .bg-home { background: linear-gradient(180deg, #FFB6C1 0%, #FFECD2 100%); }
    .bg-school { background: linear-gradient(180deg, #87CEEB 0%, #DDA0DD 100%); }
    .bg-fun { background: linear-gradient(180deg, #667eea 0%, #764ba2 100%); }
    
    .screen { display: none; min-height: 100vh; padding: 20px; }
    .screen.active { display: block; }
    
    /* Sound toggle */
    .sound-toggle {
      position: fixed; top: 15px; right: 15px; width: 45px; height: 45px;
      border-radius: 50%; border: none; background: rgba(255,255,255,0.9);
      font-size: 1.3rem; cursor: pointer; z-index: 100;
      box-shadow: 0 3px 10px rgba(0,0,0,0.2);
    }
    
    /* HOME SCREEN */
    .home-content { text-align: center; padding-top: 30px; }
    .mascot-large { font-size: 100px; animation: bounce 2s ease infinite; }
    @keyframes bounce {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-15px); }
    }
    .app-title {
      font-size: 2.2rem; font-weight: 800; color: white;
      text-shadow: 2px 2px 0 rgba(0,0,0,0.2); margin: 15px 0 5px;
    }
    .app-tagline { color: rgba(255,255,255,0.9); font-size: 1.1rem; margin-bottom: 30px; }
    
    .topic-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin-top: 20px; }
    .topic-card {
      background: white; border-radius: 20px; padding: 20px 15px;
      text-align: center; cursor: pointer; transition: all 0.3s;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      border: 3px solid transparent;
    }
    .topic-card:hover { transform: translateY(-5px); }
    .topic-card:active { transform: scale(0.95); }
    .topic-card .topic-icon { font-size: 45px; margin-bottom: 8px; }
    .topic-card .topic-name { font-size: 1rem; font-weight: 700; color: #333; }
    .topic-card.daily { border-color: #4CAF50; }
    .topic-card.yesterday { border-color: #FF9800; }
    .topic-card.stories { border-color: #E91E63; }
    .topic-card.games { border-color: #9C27B0; }
    .topic-card.quiz { border-color: #2196F3; }
    
    .streak-banner {
      background: linear-gradient(135deg, #FFD700, #FFA500);
      color: #5D4037; padding: 12px 20px; border-radius: 15px;
      margin-top: 25px; font-weight: 700;
      display: flex; align-items: center; justify-content: center; gap: 10px;
    }
    
    /* STORY SCREEN */
    .story-scene {
      background: white; border-radius: 25px; padding: 25px;
      margin-top: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.15);
      min-height: 400px; position: relative;
    }
    .scene-image {
      font-size: 80px; text-align: center; margin-bottom: 20px;
      animation: fadeIn 0.5s ease;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: scale(0.8); }
      to { opacity: 1; transform: scale(1); }
    }
    .scene-text {
      font-size: 1.4rem; text-align: center; color: #333;
      line-height: 1.6; margin-bottom: 25px;
    }
    .scene-text .highlight {
      background: linear-gradient(180deg, transparent 60%, #FFEB3B 60%);
      padding: 0 5px; font-weight: 700;
    }
    .scene-text .highlight-green {
      background: linear-gradient(180deg, transparent 60%, #A5D6A7 60%);
      padding: 0 5px; font-weight: 700;
    }
    .scene-text .highlight-orange {
      background: linear-gradient(180deg, transparent 60%, #FFCC80 60%);
      padding: 0 5px; font-weight: 700;
    }
    
    .scene-question {
      background: #FFF9C4; padding: 15px 20px; border-radius: 15px;
      text-align: center; font-size: 1.2rem; color: #5D4037;
      margin-bottom: 20px;
    }
    
    .choice-buttons { display: flex; flex-direction: column; gap: 12px; }
    .choice-btn {
      padding: 18px 25px; font-size: 1.2rem; font-weight: 600;
      border: 3px solid #E0E0E0; border-radius: 15px; background: white;
      cursor: pointer; font-family: 'Nunito', sans-serif; transition: all 0.2s;
      text-align: left;
    }
    .choice-btn:hover { border-color: #2196F3; background: #E3F2FD; }
    .choice-btn.correct {
      border-color: #4CAF50; background: #E8F5E9;
      animation: pulse 0.5s ease;
    }
    .choice-btn.wrong {
      border-color: #F44336; background: #FFEBEE;
      animation: shake 0.5s ease;
    }
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.02); }
    }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      75% { transform: translateX(5px); }
    }
    
    .feedback-box {
      margin-top: 20px; padding: 20px; border-radius: 15px;
      text-align: center; animation: fadeIn 0.3s ease;
    }
    .feedback-box.correct { background: #E8F5E9; }
    .feedback-box.wrong { background: #FFF3E0; }
    .feedback-emoji { font-size: 50px; margin-bottom: 10px; }
    .feedback-text { font-size: 1.1rem; color: #333; margin-bottom: 15px; }
    .feedback-tip {
      background: white; padding: 12px 15px; border-radius: 10px;
      font-size: 1rem; color: #666; margin-bottom: 15px;
    }
    
    .next-btn {
      width: 100%; padding: 15px; font-size: 1.2rem; font-weight: 700;
      border: none; border-radius: 50px; cursor: pointer;
      font-family: 'Nunito', sans-serif; transition: all 0.2s;
      background: linear-gradient(135deg, #667eea, #764ba2); color: white;
    }
    .next-btn:hover { transform: translateY(-2px); }
    
    /* Progress */
    .progress-header {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 15px;
    }
    .back-btn {
      background: rgba(255,255,255,0.9); border: none; padding: 10px 18px;
      border-radius: 25px; font-weight: 700; cursor: pointer;
      font-family: 'Nunito', sans-serif; color: #333;
    }
    .progress-dots { display: flex; gap: 8px; }
    .dot {
      width: 12px; height: 12px; border-radius: 50%;
      background: rgba(255,255,255,0.4);
    }
    .dot.active { background: white; }
    .dot.done { background: #4CAF50; }
    .star-count {
      background: rgba(255,255,255,0.9); padding: 8px 15px;
      border-radius: 20px; font-weight: 700; color: #FF9800;
    }
    
    /* RESULT SCREEN */
    .result-content { text-align: center; padding-top: 40px; }
    .result-card {
      background: white; border-radius: 25px; padding: 35px 25px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.15);
    }
    .result-emoji { font-size: 80px; margin-bottom: 15px; }
    .result-title { font-size: 1.8rem; font-weight: 800; color: #333; margin-bottom: 10px; }
    .result-stars { font-size: 45px; margin: 15px 0; }
    .result-message { font-size: 1.1rem; color: #666; margin-bottom: 25px; }
    .result-buttons { display: flex; flex-direction: column; gap: 12px; }
    .result-btn {
      padding: 15px 25px; font-size: 1.1rem; font-weight: 700;
      border: none; border-radius: 50px; cursor: pointer;
      font-family: 'Nunito', sans-serif;
    }
    .result-btn.primary {
      background: linear-gradient(135deg, #4CAF50, #8BC34A); color: white;
    }
    .result-btn.secondary {
      background: #F5F5F5; color: #333;
    }
    
    /* LEARN SCREEN - Visual Patterns */
    .pattern-card {
      background: white; border-radius: 20px; padding: 25px;
      margin-bottom: 20px; box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    .pattern-title {
      display: flex; align-items: center; gap: 10px;
      font-size: 1.3rem; font-weight: 700; color: #333; margin-bottom: 20px;
    }
    .pattern-title .icon { font-size: 30px; }
    
    .example-row {
      display: flex; align-items: center; gap: 15px;
      padding: 15px; margin-bottom: 10px; border-radius: 12px;
      background: #F5F5F5;
    }
    .example-row .emoji { font-size: 35px; }
    .example-row .sentence { font-size: 1.1rem; color: #333; }
    .example-row .sentence strong { color: #4CAF50; }
    .example-row .sentence .past { color: #FF9800; }
    
    .tip-bubble {
      background: linear-gradient(135deg, #E3F2FD, #BBDEFB);
      padding: 15px 20px; border-radius: 15px;
      display: flex; align-items: flex-start; gap: 12px;
      margin-top: 15px;
    }
    .tip-bubble .bulb { font-size: 25px; }
    .tip-bubble .tip-text { font-size: 1rem; color: #1565C0; }
    
    /* Visual comparison */
    .compare-box {
      display: grid; grid-template-columns: 1fr 1fr; gap: 15px;
      margin: 20px 0;
    }
    .compare-side {
      padding: 20px 15px; border-radius: 15px; text-align: center;
    }
    .compare-side.now { background: #E8F5E9; }
    .compare-side.past { background: #FFF3E0; }
    .compare-side .label {
      font-weight: 700; margin-bottom: 10px; font-size: 1rem;
    }
    .compare-side.now .label { color: #2E7D32; }
    .compare-side.past .label { color: #E65100; }
    .compare-side .time-words {
      display: flex; flex-wrap: wrap; gap: 6px; justify-content: center;
      margin-bottom: 12px;
    }
    .time-word {
      background: white; padding: 5px 12px; border-radius: 20px;
      font-size: 0.85rem; font-weight: 600;
    }
    .compare-side.now .time-word { color: #4CAF50; }
    .compare-side.past .time-word { color: #FF9800; }
    .compare-side .example {
      background: white; padding: 10px; border-radius: 10px;
      font-size: 0.95rem; color: #333;
    }
    
    /* Word cards for irregular verbs */
    .word-pairs { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
    .word-pair {
      display: flex; align-items: center; justify-content: center; gap: 8px;
      background: #F5F5F5; padding: 12px; border-radius: 12px;
    }
    .word-pair .now { color: #4CAF50; font-weight: 700; }
    .word-pair .arrow { color: #999; }
    .word-pair .past { color: #FF9800; font-weight: 700; }
    .word-pair .meaning { color: #999; font-size: 0.85rem; }
    
    /* Matching game */
    .match-instruction {
      text-align: center; color: white; font-size: 1.1rem;
      margin-bottom: 20px; padding: 15px;
      background: rgba(255,255,255,0.2); border-radius: 15px;
    }
    .match-grid {
      display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;
    }
    .match-card {
      padding: 18px 10px; border-radius: 15px; font-size: 1.1rem;
      font-weight: 700; cursor: pointer; text-align: center;
      font-family: 'Nunito', sans-serif; border: none;
      transition: all 0.2s;
    }
    .match-card.type-now { background: #E8F5E9; color: #2E7D32; }
    .match-card.type-past { background: #FFF3E0; color: #E65100; }
    .match-card.selected { transform: scale(1.05); box-shadow: 0 5px 15px rgba(0,0,0,0.2); }
    .match-card.matched { opacity: 0.5; cursor: default; }
    
    /* STUDY SCREEN STYLES */
    .study-header {
      text-align: center; padding: 15px 0; margin-bottom: 15px;
    }
    .study-title {
      font-size: 1.8rem; font-weight: 800; color: white;
      text-shadow: 2px 2px 0 rgba(0,0,0,0.2);
    }
    .study-subtitle { color: rgba(255,255,255,0.9); margin-top: 5px; }
    
    .group-selector {
      display: flex; flex-wrap: wrap; gap: 8px;
      justify-content: center; margin-bottom: 20px;
    }
    .group-btn {
      padding: 8px 16px; border-radius: 20px;
      border: 2px solid rgba(255,255,255,0.3);
      background: rgba(255,255,255,0.15);
      color: white; font-weight: 600; cursor: pointer;
      font-family: 'Nunito', sans-serif; font-size: 0.85rem;
      transition: all 0.2s;
    }
    .group-btn:hover { background: rgba(255,255,255,0.25); }
    .group-btn.active {
      background: white; color: #667eea;
      border-color: white;
    }
    
    .verb-group-card {
      background: white; border-radius: 20px;
      margin-bottom: 15px; overflow: hidden;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    .verb-group-header {
      padding: 15px 20px;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white; cursor: pointer;
      display: flex; justify-content: space-between; align-items: center;
    }
    .verb-group-header.expanded { border-radius: 0; }
    .verb-group-title {
      font-weight: 700; font-size: 1.1rem;
      display: flex; align-items: center; gap: 10px;
    }
    .verb-group-count {
      background: rgba(255,255,255,0.2);
      padding: 4px 12px; border-radius: 15px;
      font-size: 0.85rem;
    }
    .verb-group-arrow {
      transition: transform 0.3s;
      font-size: 1.2rem;
    }
    .verb-group-arrow.rotated { transform: rotate(180deg); }
    
    .verb-group-content {
      max-height: 0; overflow: hidden;
      transition: max-height 0.3s ease;
    }
    .verb-group-content.expanded {
      max-height: 2000px;
    }
    
    .verb-table {
      width: 100%; border-collapse: collapse;
    }
    .verb-table th {
      padding: 12px 10px;
      background: #f8f9fa;
      font-weight: 700; font-size: 0.85rem;
      color: #666; text-align: center;
      border-bottom: 2px solid #eee;
      position: sticky; top: 0;
    }
    .verb-table th:first-child { text-align: left; padding-left: 20px; }
    .verb-table td {
      padding: 12px 10px;
      border-bottom: 1px solid #f0f0f0;
      text-align: center; font-size: 0.95rem;
    }
    .verb-table td:first-child {
      text-align: left; padding-left: 20px;
      font-weight: 600; color: #4CAF50;
    }
    .verb-table td:nth-child(2) { color: #FF9800; font-weight: 600; }
    .verb-table td:nth-child(3) { color: #9C27B0; font-weight: 600; }
    .verb-table td:last-child { color: #666; font-size: 0.85rem; }
    
    .verb-table tr:hover { background: #f8f9fa; }
    .verb-table tr.mastered { background: #E8F5E9; }
    .verb-table tr.mastered td:first-child::before {
      content: '‚úì '; color: #4CAF50;
    }
    
    .study-tip-box {
      background: linear-gradient(135deg, #FFF9C4 0%, #FFECB3 100%);
      padding: 15px 20px; border-radius: 15px;
      margin-bottom: 20px;
      display: flex; align-items: flex-start; gap: 12px;
    }
    .study-tip-icon { font-size: 30px; }
    .study-tip-text { color: #5D4037; font-size: 0.95rem; line-height: 1.5; }
    
    .study-modes {
      display: grid; grid-template-columns: 1fr 1fr; gap: 10px;
      margin-bottom: 20px;
    }
    .study-mode-btn {
      padding: 15px; border-radius: 15px;
      border: none; cursor: pointer;
      font-family: 'Nunito', sans-serif;
      font-weight: 700; font-size: 1rem;
      display: flex; flex-direction: column;
      align-items: center; gap: 5px;
      transition: all 0.2s;
    }
    .study-mode-btn:hover { transform: translateY(-3px); }
    .study-mode-btn .icon { font-size: 30px; }
    .study-mode-btn.quiz { background: #E3F2FD; color: #1565C0; }
    .study-mode-btn.practice { background: #E8F5E9; color: #2E7D32; }
    .study-mode-btn.speed { background: #FFF3E0; color: #E65100; }
    .study-mode-btn.memory { background: #F3E5F5; color: #7B1FA2; }
    
    /* Quick Quiz Modal */
    .quiz-overlay {
      position: fixed; top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.7);
      display: flex; align-items: center; justify-content: center;
      z-index: 1000; padding: 20px;
    }
    .quiz-modal {
      background: white; border-radius: 25px;
      padding: 30px; max-width: 400px; width: 100%;
      text-align: center;
      animation: modalIn 0.3s ease;
    }
    @keyframes modalIn {
      from { transform: scale(0.8); opacity: 0; }
      to { transform: scale(1); opacity: 1; }
    }
    .quiz-question { font-size: 1.1rem; color: #333; margin-bottom: 10px; }
    .quiz-verb {
      font-size: 2.5rem; font-weight: 800;
      color: #4CAF50; margin: 20px 0;
    }
    .quiz-input {
      width: 100%; padding: 15px 20px;
      font-size: 1.3rem; font-family: 'Nunito', sans-serif;
      border: 3px solid #E0E0E0; border-radius: 15px;
      text-align: center; font-weight: 700;
      outline: none; transition: border-color 0.2s;
    }
    .quiz-input:focus { border-color: #667eea; }
    .quiz-input.correct { border-color: #4CAF50; background: #E8F5E9; }
    .quiz-input.wrong { border-color: #F44336; background: #FFEBEE; }
    .quiz-hint {
      margin-top: 10px; color: #999; font-size: 0.9rem;
    }
    .quiz-progress {
      display: flex; justify-content: center; gap: 8px;
      margin-top: 20px;
    }
    .quiz-dot {
      width: 12px; height: 12px; border-radius: 50%;
      background: #E0E0E0;
    }
    .quiz-dot.done { background: #4CAF50; }
    .quiz-dot.wrong-dot { background: #F44336; }
    .quiz-dot.current { background: #667eea; transform: scale(1.2); }
    
    /* Speed Challenge */
    .speed-timer {
      font-size: 3rem; font-weight: 800;
      color: white; text-align: center;
      margin: 20px 0;
      text-shadow: 2px 2px 0 rgba(0,0,0,0.2);
    }
    .speed-timer.warning { color: #FFEB3B; animation: pulse 0.5s infinite; }
    .speed-timer.danger { color: #F44336; animation: shake 0.3s infinite; }
    
    .speed-score {
      background: rgba(255,255,255,0.2);
      padding: 10px 20px; border-radius: 15px;
      color: white; font-weight: 700;
      text-align: center; margin-bottom: 20px;
    }
    
    /* Memory Game */
    .memory-grid {
      display: grid; grid-template-columns: repeat(4, 1fr);
      gap: 10px; margin: 20px 0;
    }
    .memory-card {
      aspect-ratio: 1; border-radius: 12px;
      background: linear-gradient(135deg, #667eea, #764ba2);
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; font-size: 1rem; font-weight: 700;
      color: white; transition: all 0.3s;
      position: relative;
    }
    .memory-card.flipped {
      background: white; color: #333;
    }
    .memory-card.matched {
      background: #4CAF50; color: white;
      animation: pulse 0.5s;
    }
    .memory-card .card-back {
      font-size: 1.5rem;
    }
    
    /* Pattern highlight colors */
    .pattern-important { background: linear-gradient(135deg, #E91E63, #F48FB1); }
    .pattern-perception { background: linear-gradient(135deg, #9C27B0, #CE93D8); }
    .pattern-no-change { background: linear-gradient(135deg, #607D8B, #90A4AE); }
    .pattern-vowel { background: linear-gradient(135deg, #2196F3, #90CAF9); }
    .pattern-drink { background: linear-gradient(135deg, #00BCD4, #80DEEA); }
    .pattern-ow-ew { background: linear-gradient(135deg, #4CAF50, #A5D6A7); }
    .pattern-ought { background: linear-gradient(135deg, #FF9800, #FFCC80); }
    .pattern-stand { background: linear-gradient(135deg, #795548, #BCAAA4); }
    .pattern-ee { background: linear-gradient(135deg, #3F51B5, #9FA8DA); }
    .pattern-d-t { background: linear-gradient(135deg, #009688, #80CBC4); }
    .pattern-t { background: linear-gradient(135deg, #FF5722, #FFAB91); }
    .pattern-misc { background: linear-gradient(135deg, #673AB7, #B39DDB); }
    
    /* Easy Match Game */
    .easy-match-container {
      background: white; border-radius: 20px;
      padding: 20px; margin-top: 15px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.15);
    }
    .easy-match-header {
      text-align: center; margin-bottom: 20px;
    }
    .easy-match-title {
      font-size: 1.3rem; font-weight: 700; color: #333;
      margin-bottom: 5px;
    }
    .easy-match-hint {
      color: #666; font-size: 0.95rem;
    }
    .easy-match-columns {
      display: flex; gap: 15px;
    }
    .easy-match-column {
      flex: 1; display: flex; flex-direction: column; gap: 10px;
    }
    .easy-match-label {
      text-align: center; font-weight: 700; padding: 8px;
      border-radius: 10px; font-size: 0.9rem;
    }
    .easy-match-label.base { background: #E8F5E9; color: #2E7D32; }
    .easy-match-label.past { background: #FFF3E0; color: #E65100; }
    
    .easy-match-card {
      padding: 15px 12px; border-radius: 12px;
      text-align: center; cursor: pointer;
      transition: all 0.2s; border: 3px solid transparent;
      font-family: 'Nunito', sans-serif; font-weight: 600;
    }
    .easy-match-card.base-card {
      background: #E8F5E9; color: #2E7D32;
    }
    .easy-match-card.past-card {
      background: #FFF3E0; color: #E65100;
    }
    .easy-match-card:hover:not(.matched):not(.disabled) {
      transform: scale(1.03);
    }
    .easy-match-card.selected {
      border-color: #667eea;
      box-shadow: 0 4px 15px rgba(102,126,234,0.4);
      transform: scale(1.05);
    }
    .easy-match-card.matched {
      opacity: 0.4; cursor: default;
      text-decoration: line-through;
    }
    .easy-match-card.correct-flash {
      animation: correctFlash 0.5s ease;
      background: #4CAF50 !important;
      color: white !important;
      border-color: #4CAF50;
    }
    .easy-match-card.wrong-flash {
      animation: wrongFlash 0.5s ease;
      border-color: #F44336;
    }
    @keyframes correctFlash {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.1); }
    }
    @keyframes wrongFlash {
      0%, 100% { transform: translateX(0); }
      25% { transform: translateX(-8px); }
      75% { transform: translateX(8px); }
    }
    .easy-match-card .verb-text {
      font-size: 1.2rem; margin-bottom: 3px;
    }
    .easy-match-card .verb-meaning {
      font-size: 0.75rem; opacity: 0.8; font-weight: 400;
    }
    .easy-match-score {
      text-align: center; margin-top: 20px;
      padding: 15px; background: linear-gradient(135deg, #E8F5E9, #C8E6C9);
      border-radius: 12px;
    }
    .easy-match-progress {
      display: flex; justify-content: center; gap: 6px;
      margin-bottom: 10px;
    }
    .easy-match-dot {
      width: 24px; height: 24px; border-radius: 50%;
      background: #E0E0E0; display: flex;
      align-items: center; justify-content: center;
      font-size: 0.7rem;
    }
    .easy-match-dot.done {
      background: #4CAF50; color: white;
    }
    .easy-match-level-select {
      display: flex; flex-direction: column; gap: 12px;
      margin-top: 15px;
    }
    .easy-match-level {
      display: flex; align-items: center; gap: 15px;
      background: white; padding: 18px 20px; border-radius: 15px;
      cursor: pointer; transition: all 0.2s;
      border: 3px solid transparent;
    }
    .easy-match-level:hover { transform: translateY(-2px); }
    .easy-match-level.easy { border-color: #4CAF50; }
    .easy-match-level.medium { border-color: #FF9800; }
    .easy-match-level.hard { border-color: #E91E63; }
    .easy-match-level .level-icon { font-size: 2rem; }
    .easy-match-level .level-info { flex: 1; }
    .easy-match-level .level-name { font-weight: 700; color: #333; }
    .easy-match-level .level-desc { font-size: 0.85rem; color: #666; }
    
    /* Triple Match Game */
    .triple-match-container {
      background: white; border-radius: 20px;
      padding: 15px; margin-top: 15px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.15);
    }
    .triple-columns {
      display: flex; gap: 8px;
    }
    .triple-column {
      flex: 1; display: flex; flex-direction: column; gap: 8px;
    }
    .triple-label {
      text-align: center; font-weight: 700; padding: 6px 4px;
      border-radius: 10px; font-size: 0.6rem;
      line-height: 1.2;
    }
    .triple-label.inf { background: #E3F2FD; color: #1565C0; }
    .triple-label.past { background: #FFF3E0; color: #E65100; }
    .triple-label.pp { background: #F3E5F5; color: #7B1FA2; }
    
    .triple-card {
      padding: 12px 6px; border-radius: 10px;
      text-align: center; cursor: pointer;
      transition: all 0.2s; border: 3px solid transparent;
      font-family: 'Nunito', sans-serif; font-weight: 600;
      font-size: 0.9rem;
    }
    .triple-card.inf-card { background: #E3F2FD; color: #1565C0; }
    .triple-card.past-card { background: #FFF3E0; color: #E65100; }
    .triple-card.pp-card { background: #F3E5F5; color: #7B1FA2; }
    
    .triple-card:hover:not(.matched) { transform: scale(1.03); }
    .triple-card.selected {
      border-color: #333;
      box-shadow: 0 3px 10px rgba(0,0,0,0.3);
      transform: scale(1.05);
    }
    .triple-card.locked {
      border-color: #4CAF50;
      background: #C8E6C9 !important;
      color: #2E7D32 !important;
    }
    .triple-card.matched {
      opacity: 0.35; cursor: default;
      text-decoration: line-through;
    }
    .triple-card.correct-flash {
      animation: tripleCorrect 0.6s ease;
      background: #4CAF50 !important;
      color: white !important;
    }
    @keyframes tripleCorrect {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.15); }
    }
    .triple-card .card-meaning {
      font-size: 0.65rem; font-weight: 400;
      opacity: 0.8; margin-top: 2px;
    }
    .triple-hint-bar {
      background: linear-gradient(135deg, #FFF9C4, #FFECB3);
      padding: 12px 15px; border-radius: 12px;
      margin-bottom: 12px; text-align: center;
      font-size: 0.9rem; color: #5D4037;
    }
    .triple-hint-bar .step {
      display: inline-block; padding: 3px 10px;
      border-radius: 15px; margin: 0 3px;
      font-weight: 700;
    }
    .triple-hint-bar .step.active { background: #4CAF50; color: white; }
    .triple-hint-bar .step.done { background: #81C784; color: white; }
    .triple-hint-bar .step.waiting { background: #E0E0E0; color: #999; }
    .triple-score-bar {
      display: flex; justify-content: space-between;
      align-items: center; margin-top: 15px;
      padding: 12px 15px; background: #F5F5F5;
      border-radius: 12px;
    }
    .triple-progress-dots {
      display: flex; gap: 5px;
    }
    .triple-dot {
      width: 22px; height: 22px; border-radius: 50%;
      background: #E0E0E0; display: flex;
      align-items: center; justify-content: center;
      font-size: 0.65rem; font-weight: 700;
    }
    .triple-dot.done { background: #4CAF50; color: white; }
    
    /* Context Learn */
    .context-container {
      background: white; border-radius: 20px;
      padding: 20px; margin-top: 15px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.15);
    }
    .context-card {
      background: linear-gradient(135deg, #FFF8E1, #FFECB3);
      border-radius: 15px; padding: 20px;
      margin-bottom: 15px;
    }
    .context-title {
      font-size: 1.2rem; font-weight: 700;
      color: #E65100; margin-bottom: 15px;
      text-align: center;
    }
    .context-rule {
      display: flex; align-items: center; gap: 15px;
      padding: 12px 15px; background: white;
      border-radius: 12px; margin-bottom: 10px;
    }
    .context-emoji { font-size: 2rem; }
    .context-text { flex: 1; }
    .context-signal {
      font-weight: 700; color: #E65100;
      font-size: 1.1rem;
    }
    .context-explain {
      font-size: 0.85rem; color: #666;
      margin-top: 3px;
    }
    .context-example-box {
      background: white; border-radius: 12px;
      padding: 15px; margin-top: 15px;
    }
    .context-example {
      padding: 10px 15px; border-radius: 10px;
      margin-bottom: 8px; font-size: 1.05rem;
    }
    .context-example.present {
      background: #E8F5E9; border-left: 4px solid #4CAF50;
    }
    .context-example.past {
      background: #FFF3E0; border-left: 4px solid #FF9800;
    }
    .context-example .signal-word {
      text-decoration: underline;
      text-decoration-color: #FF9800;
      text-decoration-thickness: 2px;
      font-weight: 600;
    }
    .context-example .verb-word {
      font-weight: 700;
    }
    .context-example.present .verb-word { color: #2E7D32; }
    .context-example.past .verb-word { color: #E65100; }
    .context-nav {
      display: flex; justify-content: center; gap: 10px;
      margin-top: 20px;
    }
    .context-nav-btn {
      padding: 12px 25px; border-radius: 25px;
      border: none; font-weight: 700;
      font-family: 'Nunito', sans-serif;
      cursor: pointer; font-size: 1rem;
    }
    .context-progress {
      text-align: center; color: #666;
      font-size: 0.9rem; margin-bottom: 10px;
    }
    
    /* Sentence Quiz */
    .sentence-quiz-card {
      background: white; border-radius: 20px;
      padding: 25px 20px; margin-top: 15px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.15);
    }
    .sentence-quiz-signal {
      text-align: center; margin-bottom: 15px;
    }
    .signal-badge {
      display: inline-block; padding: 8px 20px;
      border-radius: 20px; font-weight: 700;
      font-size: 1.1rem;
    }
    .signal-badge.present {
      background: #E8F5E9; color: #2E7D32;
    }
    .signal-badge.past {
      background: #FFF3E0; color: #E65100;
    }
    .sentence-quiz-sentence {
      font-size: 1.3rem; text-align: center;
      padding: 20px; margin: 15px 0;
      background: #F5F5F5; border-radius: 15px;
      line-height: 1.6;
    }
    .sentence-quiz-sentence .blank {
      display: inline-block; min-width: 80px;
      border-bottom: 3px solid #667eea;
      margin: 0 5px; color: #667eea;
      font-weight: 700;
    }
    .sentence-quiz-meaning {
      text-align: center; color: #666;
      font-size: 0.95rem; margin-bottom: 20px;
    }
    .sentence-quiz-choices {
      display: grid; grid-template-columns: 1fr 1fr;
      gap: 10px;
    }
    .sentence-choice-btn {
      padding: 12px 10px; border-radius: 12px;
      border: 3px solid #E0E0E0;
      background: white; cursor: pointer;
      font-family: 'Nunito', sans-serif;
      font-size: 1.05rem; font-weight: 700;
      transition: all 0.2s;
    }
    .sentence-choice-btn:hover {
      border-color: #667eea; background: #F5F5FF;
    }
    .sentence-choice-btn.correct {
      border-color: #4CAF50; background: #E8F5E9;
      color: #2E7D32;
    }
    .sentence-choice-btn.wrong {
      border-color: #F44336; background: #FFEBEE;
      color: #C62828;
    }
    .sentence-choice-btn.show-correct {
      border-color: #4CAF50; background: #E8F5E9;
      color: #2E7D32;
    }
    .sentence-choice-btn .choice-label {
      font-size: 0.7rem; color: #999;
      margin-bottom: 2px; font-weight: 400;
    }
    .sentence-feedback {
      margin-top: 20px; padding: 15px;
      border-radius: 12px; text-align: center;
    }
    .sentence-feedback.correct { background: #E8F5E9; }
    .sentence-feedback.wrong { background: #FFF3E0; }
    .sentence-feedback .emoji { font-size: 2.5rem; margin-bottom: 8px; }
    .sentence-feedback .message { font-weight: 700; margin-bottom: 5px; }
    .sentence-feedback .explanation {
      font-size: 0.9rem; color: #666;
      margin-bottom: 15px;
    }
    
    .match-score {
      text-align: center; margin-top: 20px;
      background: white; padding: 15px; border-radius: 15px;
      font-size: 1.2rem; font-weight: 700;
    }
    
    /* Flashcards */
    .flashcard-container { perspective: 1000px; margin: 20px 0; }
    .flashcard {
      width: 100%; height: 200px; cursor: pointer;
      position: relative; transform-style: preserve-3d;
      transition: transform 0.6s;
    }
    .flashcard.flipped { transform: rotateY(180deg); }
    .flashcard-face {
      position: absolute; width: 100%; height: 100%;
      backface-visibility: hidden; border-radius: 20px;
      display: flex; flex-direction: column;
      align-items: center; justify-content: center;
      padding: 20px;
    }
    .flashcard-front { background: linear-gradient(135deg, #E8F5E9, #C8E6C9); }
    .flashcard-back {
      background: linear-gradient(135deg, #FFF3E0, #FFE0B2);
      transform: rotateY(180deg);
    }
    .flashcard-word { font-size: 2.5rem; font-weight: 800; margin-bottom: 10px; }
    .flashcard-front .flashcard-word { color: #2E7D32; }
    .flashcard-back .flashcard-word { color: #E65100; }
    .flashcard-label { font-size: 1rem; color: #666; }
    .flashcard-meaning { font-size: 1.1rem; color: #666; margin-top: 10px; }
    .flashcard-hint { font-size: 0.9rem; color: #999; margin-top: 15px; }
    
    .flashcard-nav {
      display: flex; justify-content: center; gap: 15px; margin-top: 20px;
    }
    .flashcard-btn {
      padding: 12px 25px; border-radius: 25px; font-weight: 700;
      cursor: pointer; font-family: 'Nunito', sans-serif; border: none;
      background: white; color: #333;
    }
    .flashcard-btn:hover { background: #F5F5F5; }
    
    /* Confetti */
    .confetti-container {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      pointer-events: none; z-index: 1000;
    }
    .confetti {
      position: absolute; width: 10px; height: 10px;
      animation: confettiFall 3s linear forwards;
    }
    @keyframes confettiFall {
      0% { transform: translateY(-100%) rotate(0deg); opacity: 1; }
      100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
    }
    
    /* Responsive */
    @media (max-width: 400px) {
      .app-title { font-size: 1.8rem; }
      .scene-text { font-size: 1.2rem; }
      .choice-btn { font-size: 1rem; padding: 15px 20px; }
    }
    
    /* Level Select */
    .level-content { text-align: center; padding-top: 30px; }
    .level-title { font-size: 1.5rem; font-weight: 700; color: white; margin-bottom: 10px; }
    .level-subtitle { color: rgba(255,255,255,0.8); margin-bottom: 25px; }
    .level-cards { display: flex; flex-direction: column; gap: 15px; padding: 0 10px; }
    .level-card {
      background: white; border-radius: 20px; padding: 20px;
      display: flex; align-items: center; gap: 15px;
      cursor: pointer; transition: all 0.3s;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
      border: 3px solid transparent;
    }
    .level-card:hover { transform: translateY(-3px); }
    .level-card:active { transform: scale(0.98); }
    .level-card.easy { border-color: #4CAF50; }
    .level-card.medium { border-color: #FF9800; }
    .level-card.hard { border-color: #E91E63; }
    .level-card .level-icon { font-size: 40px; }
    .level-card .level-info { text-align: left; flex: 1; }
    .level-card .level-name { font-size: 1.2rem; font-weight: 700; color: #333; }
    .level-card .level-desc { font-size: 0.9rem; color: #666; }
    .level-card .level-time { 
      background: #f5f5f5; padding: 5px 12px; border-radius: 15px;
      font-size: 0.85rem; color: #888; font-weight: 600;
    }
    .level-card.easy .level-name { color: #2E7D32; }
    .level-card.medium .level-name { color: #E65100; }
    .level-card.hard .level-name { color: #C2185B; }
  </style>
</head>
<body>
  <div class="app-container bg-fun" id="appContainer">
    <button class="sound-toggle" id="soundToggle" onclick="toggleSound()">üîä</button>
    <div id="confettiContainer" class="confetti-container"></div>
    
    <!-- HOME SCREEN -->
    <div id="homeScreen" class="screen active">
      <div class="home-content">
        <div class="mascot-large">ü¶â</div>
        <h1 class="app-title">Fun English!</h1>
        <p class="app-tagline">H·ªçc ti·∫øng Anh vui v·∫ª m·ªói ng√†y</p>
        
        <!-- Hi·ªÉn th·ªã t·ªïng sao -->
        <div id="starDisplay" style="display:flex;justify-content:center;gap:15px;margin:15px 0;flex-wrap:wrap">
          <div style="background:linear-gradient(135deg,#FFD700,#FFA000);padding:10px 20px;border-radius:20px;color:white;font-weight:700;box-shadow:0 3px 10px rgba(255,152,0,0.3)">
            ‚≠ê T·ªïng: <span id="totalStarsDisplay">0</span>
          </div>
          <div style="background:linear-gradient(135deg,#4CAF50,#2E7D32);padding:10px 20px;border-radius:20px;color:white;font-weight:700;box-shadow:0 3px 10px rgba(76,175,80,0.3)">
            üìÖ H√¥m nay: <span id="todayStarsDisplay">0</span>
          </div>
        </div>
        
        <div class="topic-grid">
          <div class="topic-card daily" onclick="showLevelSelect('daily')">
            <div class="topic-icon">‚òÄÔ∏è</div>
            <div class="topic-name">Every Day</div>
          </div>
          <div class="topic-card yesterday" onclick="showLevelSelect('yesterday')">
            <div class="topic-icon">üåô</div>
            <div class="topic-name">Yesterday</div>
          </div>
          <div class="topic-card stories" onclick="showLevelSelect('stories')">
            <div class="topic-icon">üìñ</div>
            <div class="topic-name">Mix Stories</div>
          </div>
          <div class="topic-card quiz" onclick="startVerbSentenceQuiz()">
            <div class="topic-icon">üìù</div>
            <div class="topic-name">Tr·∫Øc nghi·ªám</div>
          </div>
          <div class="topic-card games" onclick="startTopic('games')">
            <div class="topic-icon">üéÆ</div>
            <div class="topic-name">Word Games</div>
          </div>
          <div class="topic-card" onclick="showLearnScreen()" style="border-color:#4CAF50">
            <div class="topic-icon">üìö</div>
            <div class="topic-name">H·ªçc ki·∫øn th·ª©c</div>
          </div>
        </div>
        
        <div id="motivationalMsg" style="margin-top:25px;padding:14px 20px;background:rgba(255,255,255,0.15);border-radius:15px;text-align:center;color:white;font-size:0.95rem;line-height:1.5;backdrop-filter:blur(5px)">
        </div>
      </div>
    </div>
    
    <!-- LEVEL SELECT SCREEN -->
    <div id="levelScreen" class="screen"></div>
    
    <!-- STORY SCREEN -->
    <div id="storyScreen" class="screen"></div>
    
    <!-- RESULT SCREEN -->
    <div id="resultScreen" class="screen"></div>
    
    <!-- LEARN SCREEN -->
    <div id="learnScreen" class="screen"></div>
    
    <!-- GAME SCREEN -->
    <div id="gameScreen" class="screen"></div>
  </div>

<script>
// ============ DATA - Cambridge Style ============
// ============ DATA - Cambridge Style (Expanded with All Signal Words) ============
var STORIES = {
  daily: [
    // ===== EVERY DAY =====
    {
      bg: 'bg-sunny',
      scenes: [
        { image: 'üåÖüëß', text: 'Lily <span class="highlight-green">wakes up</span> at 7 <span class="highlight">every day</span>.', question: 'Every day, Lily ___ up at 7.', choices: ['wakes ‚òÄÔ∏è', 'woke üåô'], correct: 0, feedback: 'Yes! every day ‚Üí wakes', tip: '‚òÄÔ∏è every day = m·ªói ng√†y' },
        { image: 'üö´üç¨', text: 'She <span class="highlight-green">doesn\'t eat</span> candy <span class="highlight">every day</span>.', question: 'She ___ eat candy every day.', choices: ['doesn\'t üö´', 'didn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! every day ‚Üí doesn\'t', tip: 'üö´ every day ‚Üí doesn\'t' },
        { image: '‚ùìüè´', text: '"<span class="highlight-green">Does she go</span> to school <span class="highlight">every day</span>?"', question: '___ she go to school every day?', choices: ['Does ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Perfect! every day ‚Üí Does', tip: '‚ùì every day ‚Üí Does...?' },
        { image: 'üçéüë¶', text: 'Tom <span class="highlight-green">eats</span> an apple <span class="highlight">every day</span>.', question: 'Tom ___ an apple every day.', choices: ['eats ‚òÄÔ∏è', 'ate üåô'], correct: 0, feedback: 'Wonderful! every day ‚Üí eats', tip: '‚òÄÔ∏è every day ‚Üí hi·ªán t·∫°i' },
        { image: 'üö´üçî', text: 'He <span class="highlight-green">doesn\'t eat</span> fast food <span class="highlight">every day</span>.', question: 'He doesn\'t ___ fast food every day.', choices: ['eat üö´', 'eats üö´'], correct: 0, feedback: 'Excellent! doesn\'t + eat (g·ªëc)', tip: '‚ö†Ô∏è doesn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìü•õ', text: '"<span class="highlight-green">Do you drink</span> milk <span class="highlight">every day</span>?"', question: '___ you drink milk every day?', choices: ['Do ‚ùì', 'Does ‚ùì'], correct: 0, feedback: 'Great! you ‚Üí Do', tip: '‚ùì Do + you...?' }
      ]
    },
    // ===== EVERY MORNING =====
    {
      bg: 'bg-sunny',
      scenes: [
        { image: 'ü¶∑üëß', text: 'Lily <span class="highlight-green">brushes</span> her teeth <span class="highlight">every morning</span>.', question: 'Lily ___ her teeth every morning.', choices: ['brushes ‚òÄÔ∏è', 'brushed üåô'], correct: 0, feedback: 'Yes! every morning ‚Üí brushes', tip: '‚òÄÔ∏è every morning = m·ªói s√°ng' },
        { image: 'üö´‚òï', text: 'She <span class="highlight-green">doesn\'t drink</span> coffee <span class="highlight">every morning</span>.', question: 'She ___ drink coffee every morning.', choices: ['doesn\'t üö´', 'didn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! every morning ‚Üí doesn\'t', tip: 'üö´ every morning ‚Üí doesn\'t' },
        { image: '‚ùìüç≥', text: '"<span class="highlight-green">Does Mom cook</span> breakfast <span class="highlight">every morning</span>?"', question: '___ Mom cook every morning?', choices: ['Does ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Perfect! Mom (she) ‚Üí Does', tip: '‚ùì every morning ‚Üí Does...?' },
        { image: 'üèÉüë¶', text: 'Tom <span class="highlight-green">runs</span> in the park <span class="highlight">every morning</span>.', question: 'Tom ___ in the park every morning.', choices: ['runs ‚òÄÔ∏è', 'ran üåô'], correct: 0, feedback: 'Wonderful! every morning ‚Üí runs', tip: '‚òÄÔ∏è every morning ‚Üí hi·ªán t·∫°i' },
        { image: 'üö´üì∫', text: 'He <span class="highlight-green">doesn\'t watch</span> TV <span class="highlight">every morning</span>.', question: 'He doesn\'t ___ TV every morning.', choices: ['watch üö´', 'watches üö´'], correct: 0, feedback: 'Excellent! doesn\'t + watch (g·ªëc)', tip: '‚ö†Ô∏è doesn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüöå', text: '"<span class="highlight-green">Do they take</span> the bus <span class="highlight">every morning</span>?"', question: '___ they take the bus every morning?', choices: ['Do ‚ùì', 'Does ‚ùì'], correct: 0, feedback: 'Great! they ‚Üí Do', tip: '‚ùì Do + they...?' }
      ]
    },
    // ===== EVERY NIGHT =====
    {
      bg: 'bg-night',
      scenes: [
        { image: 'üìñüëß', text: 'Lily <span class="highlight-green">reads</span> books <span class="highlight">every night</span>.', question: 'Lily ___ books every night.', choices: ['reads ‚òÄÔ∏è', 'read üåô'], correct: 0, feedback: 'Yes! every night ‚Üí reads', tip: '‚òÄÔ∏è every night = m·ªói t·ªëi' },
        { image: 'üö´üéÆ', text: 'She <span class="highlight-green">doesn\'t play</span> games <span class="highlight">every night</span>.', question: 'She ___ play games every night.', choices: ['doesn\'t üö´', 'didn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! every night ‚Üí doesn\'t', tip: 'üö´ every night ‚Üí doesn\'t' },
        { image: '‚ùìüò¥', text: '"<span class="highlight-green">Does she sleep</span> early <span class="highlight">every night</span>?"', question: '___ she sleep early every night?', choices: ['Does ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Perfect! she ‚Üí Does', tip: '‚ùì every night ‚Üí Does...?' },
        { image: 'üì∫üë®‚Äçüë©‚Äçüëß', text: 'The family <span class="highlight-green">watches</span> TV <span class="highlight">every night</span>.', question: 'The family ___ TV every night.', choices: ['watches ‚òÄÔ∏è', 'watched üåô'], correct: 0, feedback: 'Wonderful! every night ‚Üí watches', tip: '‚òÄÔ∏è every night ‚Üí hi·ªán t·∫°i' },
        { image: 'üö´üçï', text: 'They <span class="highlight-green">don\'t eat</span> pizza <span class="highlight">every night</span>.', question: 'They ___ eat pizza every night.', choices: ['don\'t üö´', 'didn\'t üö´', 'doesn\'t üö´'], correct: 0, feedback: 'Excellent! they ‚Üí don\'t', tip: 'üö´ They + don\'t' },
        { image: '‚ùìüéµ', text: '"<span class="highlight-green">Do you listen</span> to music <span class="highlight">every night</span>?"', question: '___ you listen to music every night?', choices: ['Do ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Great! you ‚Üí Do', tip: '‚ùì every night ‚Üí Do...?' }
      ]
    },
    // ===== EVERY WEEK =====
    {
      bg: 'bg-park',
      scenes: [
        { image: '‚öΩüë¶', text: 'Tom <span class="highlight-green">plays</span> football <span class="highlight">every week</span>.', question: 'Tom ___ football every week.', choices: ['plays ‚òÄÔ∏è', 'played üåô'], correct: 0, feedback: 'Yes! every week ‚Üí plays', tip: '‚òÄÔ∏è every week = m·ªói tu·∫ßn' },
        { image: 'üö´üèä', text: 'He <span class="highlight-green">doesn\'t swim</span> <span class="highlight">every week</span>.', question: 'He ___ swim every week.', choices: ['doesn\'t üö´', 'didn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! every week ‚Üí doesn\'t', tip: 'üö´ every week ‚Üí doesn\'t' },
        { image: '‚ùìüéæ', text: '"<span class="highlight-green">Does he play</span> tennis <span class="highlight">every week</span>?"', question: '___ he play tennis every week?', choices: ['Does ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Perfect! he ‚Üí Does', tip: '‚ùì every week ‚Üí Does...?' },
        { image: 'üõíüë©', text: 'Mom <span class="highlight-green">goes</span> shopping <span class="highlight">every week</span>.', question: 'Mom ___ shopping every week.', choices: ['goes ‚òÄÔ∏è', 'went üåô'], correct: 0, feedback: 'Wonderful! every week ‚Üí goes', tip: '‚òÄÔ∏è every week ‚Üí hi·ªán t·∫°i' },
        { image: 'üö´üç∞', text: 'She <span class="highlight-green">doesn\'t buy</span> cake <span class="highlight">every week</span>.', question: 'She doesn\'t ___ cake every week.', choices: ['buy üö´', 'buys üö´'], correct: 0, feedback: 'Excellent! doesn\'t + buy (g·ªëc)', tip: '‚ö†Ô∏è doesn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüè†', text: '"<span class="highlight-green">Do they clean</span> the house <span class="highlight">every week</span>?"', question: '___ they clean the house every week?', choices: ['Do ‚ùì', 'Does ‚ùì'], correct: 0, feedback: 'Great! they ‚Üí Do', tip: '‚ùì Do + they...?' }
      ]
    },
    // ===== ALWAYS =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'üçéüëß', text: 'Lily <span class="highlight">always</span> <span class="highlight-green">eats</span> fruit.', question: 'Lily always ___ fruit.', choices: ['eats ‚òÄÔ∏è', 'ate üåô'], correct: 0, feedback: 'Yes! always ‚Üí eats', tip: '‚òÄÔ∏è always = lu√¥n lu√¥n' },
        { image: 'üö´üç≠', text: 'She <span class="highlight">always</span> <span class="highlight-green">doesn\'t forget</span> homework.', question: 'She always ___ forget homework.', choices: ['doesn\'t üö´', 'didn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! always ‚Üí doesn\'t', tip: 'üö´ always ‚Üí doesn\'t' },
        { image: '‚ùìüìö', text: '"<span class="highlight-green">Does she always study</span> hard?"', question: '___ she always study hard?', choices: ['Does ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Perfect! always ‚Üí Does', tip: '‚ùì always ‚Üí Does...?' },
        { image: 'üòäüë¶', text: 'Tom is <span class="highlight">always</span> <span class="highlight-green">happy</span>.', question: 'Tom is always ___.', choices: ['happy ‚òÄÔ∏è', 'was happy üåô'], correct: 0, feedback: 'Wonderful! always ‚Üí is', tip: '‚òÄÔ∏è always ‚Üí hi·ªán t·∫°i' },
        { image: 'üö´üò†', text: 'He <span class="highlight">always</span> <span class="highlight-green">doesn\'t get</span> angry.', question: 'He always ___ get angry.', choices: ['doesn\'t üö´', 'didn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Excellent! always ‚Üí doesn\'t', tip: 'üö´ always ‚Üí doesn\'t' },
        { image: '‚ùìüôã', text: '"<span class="highlight-green">Do you always help</span> your friends?"', question: '___ you always help your friends?', choices: ['Do ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Great! you ‚Üí Do', tip: '‚ùì always ‚Üí Do...?' }
      ]
    },
    // ===== USUALLY =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'üö∂üëß', text: 'Lily <span class="highlight">usually</span> <span class="highlight-green">walks</span> to school.', question: 'Lily usually ___ to school.', choices: ['walks ‚òÄÔ∏è', 'walked üåô'], correct: 0, feedback: 'Yes! usually ‚Üí walks', tip: '‚òÄÔ∏è usually = th∆∞·ªùng th∆∞·ªùng' },
        { image: 'üö´üöå', text: 'She <span class="highlight">usually</span> <span class="highlight-green">doesn\'t take</span> the bus.', question: 'She usually ___ take the bus.', choices: ['doesn\'t üö´', 'didn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! usually ‚Üí doesn\'t', tip: 'üö´ usually ‚Üí doesn\'t' },
        { image: '‚ùìüèÉ', text: '"<span class="highlight-green">Does she usually run</span> in the morning?"', question: '___ she usually run in the morning?', choices: ['Does ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Perfect! usually ‚Üí Does', tip: '‚ùì usually ‚Üí Does...?' },
        { image: 'üçöüë®', text: 'Dad <span class="highlight">usually</span> <span class="highlight-green">cooks</span> dinner.', question: 'Dad usually ___ dinner.', choices: ['cooks ‚òÄÔ∏è', 'cooked üåô'], correct: 0, feedback: 'Wonderful! usually ‚Üí cooks', tip: '‚òÄÔ∏è usually ‚Üí hi·ªán t·∫°i' },
        { image: 'üö´üçú', text: 'He <span class="highlight">usually</span> <span class="highlight-green">doesn\'t make</span> noodles.', question: 'He usually doesn\'t ___ noodles.', choices: ['make üö´', 'makes üö´'], correct: 0, feedback: 'Excellent! doesn\'t + make (g·ªëc)', tip: '‚ö†Ô∏è doesn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüç≥', text: '"<span class="highlight-green">Do they usually eat</span> together?"', question: '___ they usually eat together?', choices: ['Do ‚ùì', 'Does ‚ùì'], correct: 0, feedback: 'Great! they ‚Üí Do', tip: '‚ùì usually ‚Üí Do...?' }
      ]
    },
    // ===== OFTEN =====
    {
      bg: 'bg-park',
      scenes: [
        { image: 'üéÆüëß', text: 'Lily <span class="highlight">often</span> <span class="highlight-green">plays</span> games.', question: 'Lily often ___ games.', choices: ['plays ‚òÄÔ∏è', 'played üåô'], correct: 0, feedback: 'Yes! often ‚Üí plays', tip: '‚òÄÔ∏è often = th∆∞·ªùng xuy√™n' },
        { image: 'üö´üò¢', text: 'She <span class="highlight">often</span> <span class="highlight-green">doesn\'t cry</span>.', question: 'She often ___ cry.', choices: ['doesn\'t üö´', 'didn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! often ‚Üí doesn\'t', tip: 'üö´ often ‚Üí doesn\'t' },
        { image: '‚ùìüé®', text: '"<span class="highlight-green">Does she often draw</span> pictures?"', question: '___ she often draw pictures?', choices: ['Does ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Perfect! often ‚Üí Does', tip: '‚ùì often ‚Üí Does...?' },
        { image: 'üìñüë¶', text: 'Tom <span class="highlight">often</span> <span class="highlight-green">reads</span> comics.', question: 'Tom often ___ comics.', choices: ['reads ‚òÄÔ∏è', 'read üåô'], correct: 0, feedback: 'Wonderful! often ‚Üí reads', tip: '‚òÄÔ∏è often ‚Üí hi·ªán t·∫°i' },
        { image: 'üö´üìö', text: 'He <span class="highlight">often</span> <span class="highlight-green">doesn\'t read</span> textbooks.', question: 'He often doesn\'t ___ textbooks.', choices: ['read üö´', 'reads üö´'], correct: 0, feedback: 'Excellent! doesn\'t + read (g·ªëc)', tip: '‚ö†Ô∏è doesn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüé¨', text: '"<span class="highlight-green">Do you often watch</span> movies?"', question: '___ you often watch movies?', choices: ['Do ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Great! you ‚Üí Do', tip: '‚ùì often ‚Üí Do...?' }
      ]
    },
    // ===== SOMETIMES =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'üç¶üëß', text: 'Lily <span class="highlight">sometimes</span> <span class="highlight-green">eats</span> ice cream.', question: 'Lily sometimes ___ ice cream.', choices: ['eats ‚òÄÔ∏è', 'ate üåô'], correct: 0, feedback: 'Yes! sometimes ‚Üí eats', tip: '‚òÄÔ∏è sometimes = ƒë√¥i khi' },
        { image: 'üö´üç´', text: 'She <span class="highlight">sometimes</span> <span class="highlight-green">doesn\'t eat</span> chocolate.', question: 'She sometimes ___ eat chocolate.', choices: ['doesn\'t üö´', 'didn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! sometimes ‚Üí doesn\'t', tip: 'üö´ sometimes ‚Üí doesn\'t' },
        { image: '‚ùìüéÇ', text: '"<span class="highlight-green">Does she sometimes bake</span> cakes?"', question: '___ she sometimes bake cakes?', choices: ['Does ‚ùì', 'Did ‚ùì'], correct: 0, feedback: 'Perfect! sometimes ‚Üí Does', tip: '‚ùì sometimes ‚Üí Does...?' },
        { image: 'üé∏üë¶', text: 'Tom <span class="highlight">sometimes</span> <span class="highlight-green">plays</span> guitar.', question: 'Tom sometimes ___ guitar.', choices: ['plays ‚òÄÔ∏è', 'played üåô'], correct: 0, feedback: 'Wonderful! sometimes ‚Üí plays', tip: '‚òÄÔ∏è sometimes ‚Üí hi·ªán t·∫°i' },
        { image: 'üö´üéπ', text: 'He <span class="highlight">sometimes</span> <span class="highlight-green">doesn\'t practice</span> piano.', question: 'He sometimes doesn\'t ___ piano.', choices: ['practice üö´', 'practices üö´'], correct: 0, feedback: 'Excellent! doesn\'t + practice (g·ªëc)', tip: '‚ö†Ô∏è doesn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüé§', text: '"<span class="highlight-green">Do they sometimes sing</span> songs?"', question: '___ they sometimes sing songs?', choices: ['Do ‚ùì', 'Does ‚ùì'], correct: 0, feedback: 'Great! they ‚Üí Do', tip: '‚ùì sometimes ‚Üí Do...?' }
      ]
    }
  ],
  yesterday: [
    // ===== YESTERDAY =====
    {
      bg: 'bg-night',
      scenes: [
        { image: 'üåôüëß', text: 'Lily <span class="highlight-orange">woke up</span> late <span class="highlight-orange">yesterday</span>.', question: 'Yesterday, Lily ___ up late.', choices: ['woke üåô', 'wakes ‚òÄÔ∏è'], correct: 0, feedback: 'Yes! yesterday ‚Üí woke', tip: 'üåô yesterday = h√¥m qua' },
        { image: 'üö´üè´', text: 'She <span class="highlight-orange">didn\'t go</span> to school <span class="highlight-orange">yesterday</span>.', question: 'Yesterday, she ___ go to school.', choices: ['didn\'t üö´', 'doesn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! yesterday ‚Üí didn\'t', tip: 'üö´ yesterday ‚Üí didn\'t' },
        { image: '‚ùìüõèÔ∏è', text: '"<span class="highlight-orange">Did she sleep</span> well <span class="highlight-orange">yesterday</span>?"', question: '___ she sleep well yesterday?', choices: ['Did ‚ùì', 'Does ‚ùì'], correct: 0, feedback: 'Perfect! yesterday ‚Üí Did', tip: '‚ùì yesterday ‚Üí Did...?' },
        { image: 'üçïüë¶', text: 'Tom <span class="highlight-orange">ate</span> pizza <span class="highlight-orange">yesterday</span>.', question: 'Yesterday, Tom ___ pizza.', choices: ['ate üåô', 'eats ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! yesterday ‚Üí ate', tip: 'üåô yesterday ‚Üí qu√° kh·ª©' },
        { image: 'üö´ü•ó', text: 'He <span class="highlight-orange">didn\'t eat</span> salad <span class="highlight-orange">yesterday</span>.', question: 'Yesterday, he didn\'t ___ salad.', choices: ['eat üö´', 'ate üö´'], correct: 0, feedback: 'Excellent! didn\'t + eat (g·ªëc)', tip: '‚ö†Ô∏è didn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüéÆ', text: '"<span class="highlight-orange">Did you play</span> games <span class="highlight-orange">yesterday</span>?"', question: 'Did you ___ games yesterday?', choices: ['play ‚ùì', 'played ‚ùì'], correct: 0, feedback: 'Great! Did + play (g·ªëc)', tip: '‚ö†Ô∏è Did + ƒë·ªông t·ª´ G·ªêC' }
      ]
    },
    // ===== LAST NIGHT =====
    {
      bg: 'bg-night',
      scenes: [
        { image: 'üì∫üë®‚Äçüë©‚Äçüëß', text: 'We <span class="highlight-orange">watched</span> a movie <span class="highlight-orange">last night</span>.', question: 'Last night, we ___ a movie.', choices: ['watched üåô', 'watch ‚òÄÔ∏è'], correct: 0, feedback: 'Yes! last night ‚Üí watched', tip: 'üåô last night = t·ªëi qua' },
        { image: 'üö´üìñ', text: 'Lily <span class="highlight-orange">didn\'t read</span> books <span class="highlight-orange">last night</span>.', question: 'Last night, Lily ___ read books.', choices: ['didn\'t üö´', 'doesn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! last night ‚Üí didn\'t', tip: 'üö´ last night ‚Üí didn\'t' },
        { image: '‚ùìüò¥', text: '"<span class="highlight-orange">Did you sleep</span> early <span class="highlight-orange">last night</span>?"', question: '___ you sleep early last night?', choices: ['Did ‚ùì', 'Do ‚ùì'], correct: 0, feedback: 'Perfect! last night ‚Üí Did', tip: '‚ùì last night ‚Üí Did...?' },
        { image: 'üçùüë®', text: 'Dad <span class="highlight-orange">cooked</span> pasta <span class="highlight-orange">last night</span>.', question: 'Last night, Dad ___ pasta.', choices: ['cooked üåô', 'cooks ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! last night ‚Üí cooked', tip: 'üåô last night ‚Üí qu√° kh·ª©' },
        { image: 'üö´üç∞', text: 'We <span class="highlight-orange">didn\'t have</span> dessert <span class="highlight-orange">last night</span>.', question: 'Last night, we didn\'t ___ dessert.', choices: ['have üö´', 'had üö´'], correct: 0, feedback: 'Excellent! didn\'t + have (g·ªëc)', tip: '‚ö†Ô∏è didn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüéµ', text: '"<span class="highlight-orange">Did they listen</span> to music <span class="highlight-orange">last night</span>?"', question: 'Did they ___ to music last night?', choices: ['listen ‚ùì', 'listened ‚ùì'], correct: 0, feedback: 'Great! Did + listen (g·ªëc)', tip: '‚ö†Ô∏è Did + ƒë·ªông t·ª´ G·ªêC' }
      ]
    },
    // ===== LAST WEEK =====
    {
      bg: 'bg-school',
      scenes: [
        { image: 'üìùüëß', text: 'Lily <span class="highlight-orange">had</span> a test <span class="highlight-orange">last week</span>.', question: 'Last week, Lily ___ a test.', choices: ['had üåô', 'has ‚òÄÔ∏è'], correct: 0, feedback: 'Yes! last week ‚Üí had', tip: 'üåô last week = tu·∫ßn tr∆∞·ªõc' },
        { image: 'üö´üò∞', text: 'She <span class="highlight-orange">didn\'t fail</span> <span class="highlight-orange">last week</span>.', question: 'Last week, she ___ fail.', choices: ['didn\'t üö´', 'doesn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! last week ‚Üí didn\'t', tip: 'üö´ last week ‚Üí didn\'t' },
        { image: '‚ùìüíØ', text: '"<span class="highlight-orange">Did she get</span> 100 points <span class="highlight-orange">last week</span>?"', question: '___ she get 100 points last week?', choices: ['Did ‚ùì', 'Does ‚ùì'], correct: 0, feedback: 'Perfect! last week ‚Üí Did', tip: '‚ùì last week ‚Üí Did...?' },
        { image: 'üèÜüë¶', text: 'Tom <span class="highlight-orange">won</span> a prize <span class="highlight-orange">last week</span>.', question: 'Last week, Tom ___ a prize.', choices: ['won üåô', 'wins ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! last week ‚Üí won', tip: 'üåô last week ‚Üí qu√° kh·ª©' },
        { image: 'üö´üéÆ', text: 'He <span class="highlight-orange">didn\'t play</span> games <span class="highlight-orange">last week</span>.', question: 'Last week, he didn\'t ___ games.', choices: ['play üö´', 'played üö´'], correct: 0, feedback: 'Excellent! didn\'t + play (g·ªëc)', tip: '‚ö†Ô∏è didn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüìö', text: '"<span class="highlight-orange">Did they study</span> hard <span class="highlight-orange">last week</span>?"', question: 'Did they ___ hard last week?', choices: ['study ‚ùì', 'studied ‚ùì'], correct: 0, feedback: 'Great! Did + study (g·ªëc)', tip: '‚ö†Ô∏è Did + ƒë·ªông t·ª´ G·ªêC' }
      ]
    },
    // ===== LAST MONTH =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'üéÇüëß', text: 'Lily <span class="highlight-orange">celebrated</span> her birthday <span class="highlight-orange">last month</span>.', question: 'Last month, Lily ___ her birthday.', choices: ['celebrated üåô', 'celebrates ‚òÄÔ∏è'], correct: 0, feedback: 'Yes! last month ‚Üí celebrated', tip: 'üåô last month = th√°ng tr∆∞·ªõc' },
        { image: 'üö´üéÅ', text: 'She <span class="highlight-orange">didn\'t get</span> a bike <span class="highlight-orange">last month</span>.', question: 'Last month, she ___ get a bike.', choices: ['didn\'t üö´', 'doesn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! last month ‚Üí didn\'t', tip: 'üö´ last month ‚Üí didn\'t' },
        { image: '‚ùìüéâ', text: '"<span class="highlight-orange">Did friends come</span> to the party <span class="highlight-orange">last month</span>?"', question: '___ friends come to the party last month?', choices: ['Did ‚ùì', 'Do ‚ùì'], correct: 0, feedback: 'Perfect! last month ‚Üí Did', tip: '‚ùì last month ‚Üí Did...?' },
        { image: 'üè†üë®‚Äçüë©‚Äçüëß', text: 'We <span class="highlight-orange">moved</span> to a new house <span class="highlight-orange">last month</span>.', question: 'Last month, we ___ to a new house.', choices: ['moved üåô', 'move ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! last month ‚Üí moved', tip: 'üåô last month ‚Üí qu√° kh·ª©' },
        { image: 'üö´üêï', text: 'We <span class="highlight-orange">didn\'t buy</span> a dog <span class="highlight-orange">last month</span>.', question: 'Last month, we didn\'t ___ a dog.', choices: ['buy üö´', 'bought üö´'], correct: 0, feedback: 'Excellent! didn\'t + buy (g·ªëc)', tip: '‚ö†Ô∏è didn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüå≥', text: '"<span class="highlight-orange">Did they plant</span> trees <span class="highlight-orange">last month</span>?"', question: 'Did they ___ trees last month?', choices: ['plant ‚ùì', 'planted ‚ùì'], correct: 0, feedback: 'Great! Did + plant (g·ªëc)', tip: '‚ö†Ô∏è Did + ƒë·ªông t·ª´ G·ªêC' }
      ]
    },
    // ===== LAST YEAR =====
    {
      bg: 'bg-park',
      scenes: [
        { image: '‚úàÔ∏èüë®‚Äçüë©‚Äçüëß', text: 'We <span class="highlight-orange">went</span> to Japan <span class="highlight-orange">last year</span>.', question: 'Last year, we ___ to Japan.', choices: ['went üåô', 'go ‚òÄÔ∏è'], correct: 0, feedback: 'Yes! last year ‚Üí went', tip: 'üåô last year = nƒÉm ngo√°i' },
        { image: 'üö´üèîÔ∏è', text: 'We <span class="highlight-orange">didn\'t climb</span> a mountain <span class="highlight-orange">last year</span>.', question: 'Last year, we ___ climb a mountain.', choices: ['didn\'t üö´', 'don\'t üö´', 'doesn\'t üö´'], correct: 0, feedback: 'Great! last year ‚Üí didn\'t', tip: 'üö´ last year ‚Üí didn\'t' },
        { image: '‚ùìüåä', text: '"<span class="highlight-orange">Did you swim</span> in the sea <span class="highlight-orange">last year</span>?"', question: '___ you swim in the sea last year?', choices: ['Did ‚ùì', 'Do ‚ùì'], correct: 0, feedback: 'Perfect! last year ‚Üí Did', tip: '‚ùì last year ‚Üí Did...?' },
        { image: 'üéìüëß', text: 'Lily <span class="highlight-orange">finished</span> grade 2 <span class="highlight-orange">last year</span>.', question: 'Last year, Lily ___ grade 2.', choices: ['finished üåô', 'finishes ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! last year ‚Üí finished', tip: 'üåô last year ‚Üí qu√° kh·ª©' },
        { image: 'üö´üèÜ', text: 'Tom <span class="highlight-orange">didn\'t win</span> any prize <span class="highlight-orange">last year</span>.', question: 'Last year, Tom didn\'t ___ any prize.', choices: ['win üö´', 'won üö´'], correct: 0, feedback: 'Excellent! didn\'t + win (g·ªëc)', tip: '‚ö†Ô∏è didn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüéÑ', text: '"<span class="highlight-orange">Did they visit</span> grandma <span class="highlight-orange">last year</span>?"', question: 'Did they ___ grandma last year?', choices: ['visit ‚ùì', 'visited ‚ùì'], correct: 0, feedback: 'Great! Did + visit (g·ªëc)', tip: '‚ö†Ô∏è Did + ƒë·ªông t·ª´ G·ªêC' }
      ]
    },
    // ===== ...AGO =====
    {
      bg: 'bg-school',
      scenes: [
        { image: 'üéíüëß', text: 'Lily <span class="highlight-orange">started</span> school <span class="highlight-orange">2 years ago</span>.', question: '2 years ago, Lily ___ school.', choices: ['started üåô', 'starts ‚òÄÔ∏è'], correct: 0, feedback: 'Yes! ...ago ‚Üí started', tip: 'üåô ...ago = c√°ch ƒë√¢y...' },
        { image: 'üö´üò¢', text: 'She <span class="highlight-orange">didn\'t cry</span> <span class="highlight-orange">2 years ago</span>.', question: '2 years ago, she ___ cry.', choices: ['didn\'t üö´', 'doesn\'t üö´', 'don\'t üö´'], correct: 0, feedback: 'Great! ...ago ‚Üí didn\'t', tip: 'üö´ ...ago ‚Üí didn\'t' },
        { image: '‚ùìüë´', text: '"<span class="highlight-orange">Did she make</span> friends <span class="highlight-orange">2 years ago</span>?"', question: '___ she make friends 2 years ago?', choices: ['Did ‚ùì', 'Does ‚ùì'], correct: 0, feedback: 'Perfect! ...ago ‚Üí Did', tip: '‚ùì ...ago ‚Üí Did...?' },
        { image: 'üêïüë¶', text: 'Tom <span class="highlight-orange">got</span> a dog <span class="highlight-orange">3 months ago</span>.', question: '3 months ago, Tom ___ a dog.', choices: ['got üåô', 'gets ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! ...ago ‚Üí got', tip: 'üåô ...ago ‚Üí qu√° kh·ª©' },
        { image: 'üö´üê±', text: 'He <span class="highlight-orange">didn\'t get</span> a cat <span class="highlight-orange">3 months ago</span>.', question: '3 months ago, he didn\'t ___ a cat.', choices: ['get üö´', 'got üö´'], correct: 0, feedback: 'Excellent! didn\'t + get (g·ªëc)', tip: '‚ö†Ô∏è didn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüè†', text: '"<span class="highlight-orange">Did they move</span> <span class="highlight-orange">5 years ago</span>?"', question: 'Did they ___ 5 years ago?', choices: ['move ‚ùì', 'moved ‚ùì'], correct: 0, feedback: 'Great! Did + move (g·ªëc)', tip: '‚ö†Ô∏è Did + ƒë·ªông t·ª´ G·ªêC' }
      ]
    },
    // ===== IN 2023 =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'üë∂', text: 'My sister <span class="highlight-orange">was born</span> <span class="highlight-orange">in 2020</span>.', question: 'In 2020, my sister ___ born.', choices: ['was üåô', 'is ‚òÄÔ∏è'], correct: 0, feedback: 'Yes! in 2020 ‚Üí was', tip: 'üåô in + nƒÉm = qu√° kh·ª©' },
        { image: 'üö´üè´', text: 'I <span class="highlight-orange">didn\'t go</span> to school <span class="highlight-orange">in 2020</span>.', question: 'In 2020, I ___ go to school.', choices: ['didn\'t üö´', 'don\'t üö´', 'doesn\'t üö´'], correct: 0, feedback: 'Great! in 2020 ‚Üí didn\'t', tip: 'üö´ in + nƒÉm ‚Üí didn\'t' },
        { image: '‚ùìüè†', text: '"<span class="highlight-orange">Did you stay</span> home <span class="highlight-orange">in 2020</span>?"', question: '___ you stay home in 2020?', choices: ['Did ‚ùì', 'Do ‚ùì'], correct: 0, feedback: 'Perfect! in 2020 ‚Üí Did', tip: '‚ùì in + nƒÉm ‚Üí Did...?' },
        { image: 'üéÆüë¶', text: 'Tom <span class="highlight-orange">got</span> a new game <span class="highlight-orange">in 2023</span>.', question: 'In 2023, Tom ___ a new game.', choices: ['got üåô', 'gets ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! in 2023 ‚Üí got', tip: 'üåô in + nƒÉm ‚Üí qu√° kh·ª©' },
        { image: 'üö´üì±', text: 'He <span class="highlight-orange">didn\'t have</span> a phone <span class="highlight-orange">in 2021</span>.', question: 'In 2021, he didn\'t ___ a phone.', choices: ['have üö´', 'had üö´'], correct: 0, feedback: 'Excellent! didn\'t + have (g·ªëc)', tip: '‚ö†Ô∏è didn\'t + ƒë·ªông t·ª´ G·ªêC' },
        { image: '‚ùìüåç', text: '"<span class="highlight-orange">Did they travel</span> <span class="highlight-orange">in 2022</span>?"', question: 'Did they ___ in 2022?', choices: ['travel ‚ùì', 'traveled ‚ùì'], correct: 0, feedback: 'Great! Did + travel (g·ªëc)', tip: '‚ö†Ô∏è Did + ƒë·ªông t·ª´ G·ªêC' }
      ]
    }
  ],
  stories: [
    // ===== MIX: Every day vs Yesterday =====
    {
      bg: 'bg-home',
      scenes: [
        { image: '‚òÄÔ∏èüç≥', text: '<span class="highlight">Every day</span>, Lily <span class="highlight-green">eats</span> breakfast.', question: 'every day ‚Üí Lily ___ breakfast.', choices: ['eats ‚òÄÔ∏è', 'ate üåô'], correct: 0, feedback: 'Yes! every day ‚Üí eats', tip: '‚òÄÔ∏è every day ‚Üí hi·ªán t·∫°i' },
        { image: 'üåôü•û', text: '<span class="highlight-orange">Yesterday</span>, she <span class="highlight-orange">ate</span> pancakes.', question: 'yesterday ‚Üí she ___ pancakes.', choices: ['ate üåô', 'eats ‚òÄÔ∏è'], correct: 0, feedback: 'Great! yesterday ‚Üí ate', tip: 'üåô yesterday ‚Üí qu√° kh·ª©' },
        { image: 'üö´‚òÄÔ∏è', text: 'She <span class="highlight-green">doesn\'t drink</span> coffee <span class="highlight">every morning</span>.', question: 'every morning ‚Üí she ___ drink coffee.', choices: ['doesn\'t ‚òÄÔ∏è', 'didn\'t üåô'], correct: 0, feedback: 'Perfect! every morning ‚Üí doesn\'t', tip: '‚òÄÔ∏è every morning ‚Üí doesn\'t' },
        { image: 'üö´üåô', text: 'She <span class="highlight-orange">didn\'t drink</span> milk <span class="highlight-orange">last night</span>.', question: 'last night ‚Üí she ___ drink milk.', choices: ['didn\'t üåô', 'doesn\'t ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! last night ‚Üí didn\'t', tip: 'üåô last night ‚Üí didn\'t' },
        { image: '‚ùì‚òÄÔ∏è', text: '"<span class="highlight-green">Does</span> she go to school <span class="highlight">every day</span>?"', question: 'every day ‚Üí ___ she go to school?', choices: ['Does ‚òÄÔ∏è', 'Did üåô'], correct: 0, feedback: 'Excellent! every day ‚Üí Does', tip: '‚òÄÔ∏è every day ‚Üí Does...?' },
        { image: '‚ùìüåô', text: '"<span class="highlight-orange">Did</span> she go to school <span class="highlight-orange">yesterday</span>?"', question: 'yesterday ‚Üí ___ she go to school?', choices: ['Did üåô', 'Does ‚òÄÔ∏è'], correct: 0, feedback: 'Great! yesterday ‚Üí Did', tip: 'üåô yesterday ‚Üí Did...?' }
      ]
    },
    // ===== MIX: Always/Usually vs Last week =====
    {
      bg: 'bg-park',
      scenes: [
        { image: '‚òÄÔ∏è‚öΩ', text: 'Tom <span class="highlight">always</span> <span class="highlight-green">plays</span> football.', question: 'always ‚Üí Tom ___ football.', choices: ['plays ‚òÄÔ∏è', 'played üåô'], correct: 0, feedback: 'Yes! always ‚Üí plays', tip: '‚òÄÔ∏è always ‚Üí hi·ªán t·∫°i' },
        { image: 'üåô‚öΩ', text: 'He <span class="highlight-orange">played</span> in a match <span class="highlight-orange">last Saturday</span>.', question: 'last Saturday ‚Üí he ___ in a match.', choices: ['played üåô', 'plays ‚òÄÔ∏è'], correct: 0, feedback: 'Great! last Saturday ‚Üí played', tip: 'üåô last Saturday ‚Üí qu√° kh·ª©' },
        { image: 'üö´‚òÄÔ∏è', text: 'He <span class="highlight">usually</span> <span class="highlight-green">doesn\'t lose</span>.', question: 'usually ‚Üí he ___ lose.', choices: ['doesn\'t ‚òÄÔ∏è', 'didn\'t üåô'], correct: 0, feedback: 'Perfect! usually ‚Üí doesn\'t', tip: '‚òÄÔ∏è usually ‚Üí doesn\'t' },
        { image: 'üö´üåô', text: 'But he <span class="highlight-orange">didn\'t win</span> <span class="highlight-orange">last week</span>.', question: 'last week ‚Üí he ___ win.', choices: ['didn\'t üåô', 'doesn\'t ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! last week ‚Üí didn\'t', tip: 'üåô last week ‚Üí didn\'t' },
        { image: '‚ùì‚òÄÔ∏è', text: '"<span class="highlight-green">Does</span> he <span class="highlight">often</span> score goals?"', question: 'often ‚Üí ___ he score goals?', choices: ['Does ‚òÄÔ∏è', 'Did üåô'], correct: 0, feedback: 'Excellent! often ‚Üí Does', tip: '‚òÄÔ∏è often ‚Üí Does...?' },
        { image: '‚ùìüåô', text: '"<span class="highlight-orange">Did</span> he score <span class="highlight-orange">last month</span>?"', question: 'last month ‚Üí ___ he score?', choices: ['Did üåô', 'Does ‚òÄÔ∏è'], correct: 0, feedback: 'Great! last month ‚Üí Did', tip: 'üåô last month ‚Üí Did...?' }
      ]
    },
    // ===== MIX: Sometimes vs ...ago =====
    {
      bg: 'bg-home',
      scenes: [
        { image: '‚òÄÔ∏èüéÆ', text: 'Lily <span class="highlight">sometimes</span> <span class="highlight-green">plays</span> video games.', question: 'sometimes ‚Üí Lily ___ video games.', choices: ['plays ‚òÄÔ∏è', 'played üåô'], correct: 0, feedback: 'Yes! sometimes ‚Üí plays', tip: '‚òÄÔ∏è sometimes ‚Üí hi·ªán t·∫°i' },
        { image: 'üåôüéÆ', text: 'She <span class="highlight-orange">played</span> a new game <span class="highlight-orange">2 days ago</span>.', question: '2 days ago ‚Üí she ___ a new game.', choices: ['played üåô', 'plays ‚òÄÔ∏è'], correct: 0, feedback: 'Great! ...ago ‚Üí played', tip: 'üåô ...ago ‚Üí qu√° kh·ª©' },
        { image: 'üö´‚òÄÔ∏è', text: 'She <span class="highlight">sometimes</span> <span class="highlight-green">doesn\'t do</span> homework on time.', question: 'sometimes ‚Üí she ___ do homework on time.', choices: ['doesn\'t ‚òÄÔ∏è', 'didn\'t üåô'], correct: 0, feedback: 'Perfect! sometimes ‚Üí doesn\'t', tip: '‚òÄÔ∏è sometimes ‚Üí doesn\'t' },
        { image: 'üö´üåô', text: 'She <span class="highlight-orange">didn\'t finish</span> her project <span class="highlight-orange">a week ago</span>.', question: 'a week ago ‚Üí she ___ finish her project.', choices: ['didn\'t üåô', 'doesn\'t ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! ...ago ‚Üí didn\'t', tip: 'üåô ...ago ‚Üí didn\'t' },
        { image: '‚ùì‚òÄÔ∏è', text: '"<span class="highlight-green">Does</span> she <span class="highlight">often</span> help Mom?"', question: 'often ‚Üí ___ she help Mom?', choices: ['Does ‚òÄÔ∏è', 'Did üåô'], correct: 0, feedback: 'Excellent! often ‚Üí Does', tip: '‚òÄÔ∏è often ‚Üí Does...?' },
        { image: '‚ùìüåô', text: '"<span class="highlight-orange">Did</span> she help <span class="highlight-orange">in 2023</span>?"', question: 'in 2023 ‚Üí ___ she help?', choices: ['Did üåô', 'Does ‚òÄÔ∏è'], correct: 0, feedback: 'Great! in 2023 ‚Üí Did', tip: 'üåô in 2023 ‚Üí Did...?' }
      ]
    },
    // ===== MIX: Every week vs Last year =====
    {
      bg: 'bg-park',
      scenes: [
        { image: '‚òÄÔ∏èüèä', text: 'We <span class="highlight-green">go</span> swimming <span class="highlight">every week</span>.', question: 'every week ‚Üí we ___ swimming.', choices: ['go ‚òÄÔ∏è', 'went üåô'], correct: 0, feedback: 'Yes! every week ‚Üí go', tip: '‚òÄÔ∏è every week ‚Üí hi·ªán t·∫°i' },
        { image: 'üåôüèä', text: 'We <span class="highlight-orange">went</span> to the beach <span class="highlight-orange">last year</span>.', question: 'last year ‚Üí we ___ to the beach.', choices: ['went üåô', 'go ‚òÄÔ∏è'], correct: 0, feedback: 'Great! last year ‚Üí went', tip: 'üåô last year ‚Üí qu√° kh·ª©' },
        { image: 'üö´‚òÄÔ∏è', text: 'We <span class="highlight-green">don\'t swim</span> in winter <span class="highlight">every year</span>.', question: 'every year ‚Üí we ___ swim in winter.', choices: ['don\'t ‚òÄÔ∏è', 'didn\'t üåô'], correct: 0, feedback: 'Perfect! every year ‚Üí don\'t', tip: '‚òÄÔ∏è every year ‚Üí don\'t' },
        { image: 'üö´üåô', text: 'We <span class="highlight-orange">didn\'t travel</span> <span class="highlight-orange">last summer</span>.', question: 'last summer ‚Üí we ___ travel.', choices: ['didn\'t üåô', 'don\'t ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! last summer ‚Üí didn\'t', tip: 'üåô last summer ‚Üí didn\'t' },
        { image: '‚ùì‚òÄÔ∏è', text: '"<span class="highlight-green">Do</span> you <span class="highlight">usually</span> go on vacation?"', question: 'usually ‚Üí ___ you go on vacation?', choices: ['Do ‚òÄÔ∏è', 'Did üåô'], correct: 0, feedback: 'Excellent! usually ‚Üí Do', tip: '‚òÄÔ∏è usually ‚Üí Do...?' },
        { image: '‚ùìüåô', text: '"<span class="highlight-orange">Did</span> you visit grandma <span class="highlight-orange">last holiday</span>?"', question: 'last holiday ‚Üí ___ you visit grandma?', choices: ['Did üåô', 'Do ‚òÄÔ∏è'], correct: 0, feedback: 'Great! last holiday ‚Üí Did', tip: 'üåô last holiday ‚Üí Did...?' }
      ]
    },
    // ===== MIX: All signals - Animals =====
    {
      bg: 'bg-park',
      scenes: [
        { image: 'üêï‚òÄÔ∏è', text: 'Dogs <span class="highlight">always</span> <span class="highlight-green">love</span> bones.', question: 'always ‚Üí dogs ___ bones.', choices: ['love ‚òÄÔ∏è', 'loved üåô'], correct: 0, feedback: 'Yes! always ‚Üí love', tip: '‚òÄÔ∏è always ‚Üí hi·ªán t·∫°i' },
        { image: 'üêïüåô', text: 'My dog <span class="highlight-orange">ate</span> a big bone <span class="highlight-orange">yesterday</span>.', question: 'yesterday ‚Üí my dog ___ a big bone.', choices: ['ate üåô', 'eats ‚òÄÔ∏è'], correct: 0, feedback: 'Great! yesterday ‚Üí ate', tip: 'üåô yesterday ‚Üí qu√° kh·ª©' },
        { image: 'üö´üê±‚òÄÔ∏è', text: 'Cats <span class="highlight-green">don\'t like</span> water.', question: 'Cats ___ like water. (fact)', choices: ['don\'t ‚òÄÔ∏è', 'didn\'t üåô'], correct: 0, feedback: 'Perfect! Fact ‚Üí don\'t', tip: '‚òÄÔ∏è S·ª± th·∫≠t ‚Üí don\'t' },
        { image: 'üö´üê±üåô', text: 'My cat <span class="highlight-orange">didn\'t eat</span> fish <span class="highlight-orange">last night</span>.', question: 'last night ‚Üí my cat ___ eat fish.', choices: ['didn\'t üåô', 'doesn\'t ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! last night ‚Üí didn\'t', tip: 'üåô last night ‚Üí didn\'t' },
        { image: '‚ùìüê¶‚òÄÔ∏è', text: '"<span class="highlight-green">Do</span> birds <span class="highlight">usually</span> fly south in winter?"', question: 'usually ‚Üí ___ birds fly south?', choices: ['Do ‚òÄÔ∏è', 'Did üåô'], correct: 0, feedback: 'Excellent! usually ‚Üí Do', tip: '‚òÄÔ∏è usually ‚Üí Do...?' },
        { image: '‚ùìüê¶üåô', text: '"<span class="highlight-orange">Did</span> you see birds <span class="highlight-orange">3 days ago</span>?"', question: '3 days ago ‚Üí ___ you see birds?', choices: ['Did üåô', 'Do ‚òÄÔ∏è'], correct: 0, feedback: 'Great! ...ago ‚Üí Did', tip: 'üåô ...ago ‚Üí Did...?' }
      ]
    },
    // ===== MIX: All signals - School =====
    {
      bg: 'bg-school',
      scenes: [
        { image: 'üè´‚òÄÔ∏è', text: 'We <span class="highlight-green">go</span> to school <span class="highlight">every day</span>.', question: 'every day ‚Üí we ___ to school.', choices: ['go ‚òÄÔ∏è', 'went üåô'], correct: 0, feedback: 'Yes! every day ‚Üí go', tip: '‚òÄÔ∏è every day ‚Üí hi·ªán t·∫°i' },
        { image: 'üè´üåô', text: 'We <span class="highlight-orange">had</span> a field trip <span class="highlight-orange">last Friday</span>.', question: 'last Friday ‚Üí we ___ a field trip.', choices: ['had üåô', 'have ‚òÄÔ∏è'], correct: 0, feedback: 'Great! last Friday ‚Üí had', tip: 'üåô last Friday ‚Üí qu√° kh·ª©' },
        { image: 'üö´‚òÄÔ∏è', text: 'We <span class="highlight-green">don\'t have</span> school on Sunday.', question: 'We ___ have school on Sunday.', choices: ['don\'t ‚òÄÔ∏è', 'didn\'t üåô'], correct: 0, feedback: 'Perfect! Fact ‚Üí don\'t', tip: '‚òÄÔ∏è Quy t·∫Øc ‚Üí don\'t' },
        { image: 'üö´üåô', text: 'We <span class="highlight-orange">didn\'t have</span> homework <span class="highlight-orange">yesterday</span>.', question: 'yesterday ‚Üí we ___ have homework.', choices: ['didn\'t üåô', 'don\'t ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! yesterday ‚Üí didn\'t', tip: 'üåô yesterday ‚Üí didn\'t' },
        { image: '‚ùì‚òÄÔ∏è', text: '"<span class="highlight-green">Does</span> the teacher <span class="highlight">always</span> give tests?"', question: 'always ‚Üí ___ the teacher give tests?', choices: ['Does ‚òÄÔ∏è', 'Did üåô'], correct: 0, feedback: 'Excellent! always ‚Üí Does', tip: '‚òÄÔ∏è always ‚Üí Does...?' },
        { image: '‚ùìüåô', text: '"<span class="highlight-orange">Did</span> you pass the test <span class="highlight-orange">last month</span>?"', question: 'last month ‚Üí ___ you pass the test?', choices: ['Did üåô', 'Does ‚òÄÔ∏è'], correct: 0, feedback: 'Great! last month ‚Üí Did', tip: 'üåô last month ‚Üí Did...?' }
      ]
    },
    // ===== MIX: All signals - Food =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'üçé‚òÄÔ∏è', text: 'I <span class="highlight">usually</span> <span class="highlight-green">eat</span> fruit for breakfast.', question: 'usually ‚Üí I ___ fruit for breakfast.', choices: ['eat ‚òÄÔ∏è', 'ate üåô'], correct: 0, feedback: 'Yes! usually ‚Üí eat', tip: '‚òÄÔ∏è usually ‚Üí hi·ªán t·∫°i' },
        { image: 'üçïüåô', text: 'I <span class="highlight-orange">ate</span> pizza <span class="highlight-orange">last weekend</span>.', question: 'last weekend ‚Üí I ___ pizza.', choices: ['ate üåô', 'eat ‚òÄÔ∏è'], correct: 0, feedback: 'Great! last weekend ‚Üí ate', tip: 'üåô last weekend ‚Üí qu√° kh·ª©' },
        { image: 'üö´‚òÄÔ∏è', text: 'I <span class="highlight-green">don\'t eat</span> spicy food <span class="highlight">every day</span>.', question: 'every day ‚Üí I ___ eat spicy food.', choices: ['don\'t ‚òÄÔ∏è', 'didn\'t üåô'], correct: 0, feedback: 'Perfect! every day ‚Üí don\'t', tip: '‚òÄÔ∏è every day ‚Üí don\'t' },
        { image: 'üö´üåô', text: 'I <span class="highlight-orange">didn\'t eat</span> breakfast <span class="highlight-orange">yesterday</span>.', question: 'yesterday ‚Üí I ___ eat breakfast.', choices: ['didn\'t üåô', 'don\'t ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! yesterday ‚Üí didn\'t', tip: 'üåô yesterday ‚Üí didn\'t' },
        { image: '‚ùì‚òÄÔ∏è', text: '"<span class="highlight-green">Do</span> you <span class="highlight">sometimes</span> eat ice cream?"', question: 'sometimes ‚Üí ___ you eat ice cream?', choices: ['Do ‚òÄÔ∏è', 'Did üåô'], correct: 0, feedback: 'Excellent! sometimes ‚Üí Do', tip: '‚òÄÔ∏è sometimes ‚Üí Do...?' },
        { image: '‚ùìüåô', text: '"<span class="highlight-orange">Did</span> you try the new restaurant <span class="highlight-orange">2 weeks ago</span>?"', question: '2 weeks ago ‚Üí ___ you try the new restaurant?', choices: ['Did üåô', 'Do ‚òÄÔ∏è'], correct: 0, feedback: 'Great! ...ago ‚Üí Did', tip: 'üåô ...ago ‚Üí Did...?' }
      ]
    },
    // ===== MIX: All signals - Family =====
    {
      bg: 'bg-home',
      scenes: [
        { image: 'üë®‚Äçüë©‚Äçüëß‚òÄÔ∏è', text: 'My family <span class="highlight">often</span> <span class="highlight-green">eats</span> dinner together.', question: 'often ‚Üí my family ___ dinner together.', choices: ['eats ‚òÄÔ∏è', 'ate üåô'], correct: 0, feedback: 'Yes! often ‚Üí eats', tip: '‚òÄÔ∏è often ‚Üí hi·ªán t·∫°i' },
        { image: 'üë®‚Äçüë©‚Äçüëßüåô', text: 'We <span class="highlight-orange">went</span> to a restaurant <span class="highlight-orange">last Sunday</span>.', question: 'last Sunday ‚Üí we ___ to a restaurant.', choices: ['went üåô', 'go ‚òÄÔ∏è'], correct: 0, feedback: 'Great! last Sunday ‚Üí went', tip: 'üåô last Sunday ‚Üí qu√° kh·ª©' },
        { image: 'üö´‚òÄÔ∏è', text: 'Dad <span class="highlight-green">doesn\'t work</span> on weekends.', question: 'Dad ___ work on weekends.', choices: ['doesn\'t ‚òÄÔ∏è', 'didn\'t üåô'], correct: 0, feedback: 'Perfect! Fact ‚Üí doesn\'t', tip: '‚òÄÔ∏è Quy t·∫Øc ‚Üí doesn\'t' },
        { image: 'üö´üåô', text: 'Mom <span class="highlight-orange">didn\'t cook</span> <span class="highlight-orange">last night</span>.', question: 'last night ‚Üí Mom ___ cook.', choices: ['didn\'t üåô', 'doesn\'t ‚òÄÔ∏è'], correct: 0, feedback: 'Wonderful! last night ‚Üí didn\'t', tip: 'üåô last night ‚Üí didn\'t' },
        { image: '‚ùì‚òÄÔ∏è', text: '"<span class="highlight-green">Does</span> your sister <span class="highlight">always</span> help with chores?"', question: 'always ‚Üí ___ your sister help with chores?', choices: ['Does ‚òÄÔ∏è', 'Did üåô'], correct: 0, feedback: 'Excellent! always ‚Üí Does', tip: '‚òÄÔ∏è always ‚Üí Does...?' },
        { image: '‚ùìüåô', text: '"<span class="highlight-orange">Did</span> grandma visit <span class="highlight-orange">last month</span>?"', question: 'last month ‚Üí ___ grandma visit?', choices: ['Did üåô', 'Does ‚òÄÔ∏è'], correct: 0, feedback: 'Great! last month ‚Üí Did', tip: 'üåô last month ‚Üí Did...?' }
      ]
    }
  ]
};
var WORD_GAMES = {
  matching: [
    { now: 'go', past: 'went', meaning: 'ƒëi' },
    { now: 'eat', past: 'ate', meaning: 'ƒÉn' },
    { now: 'see', past: 'saw', meaning: 'th·∫•y' },
    { now: 'have', past: 'had', meaning: 'c√≥' },
    { now: 'make', past: 'made', meaning: 'l√†m' },
    { now: 'come', past: 'came', meaning: 'ƒë·∫øn' },
    { now: 'take', past: 'took', meaning: 'l·∫•y' },
    { now: 'give', past: 'gave', meaning: 'cho' },
    { now: 'run', past: 'ran', meaning: 'ch·∫°y' },
    { now: 'swim', past: 'swam', meaning: 'b∆°i' },
    { now: 'drink', past: 'drank', meaning: 'u·ªëng' },
    { now: 'sing', past: 'sang', meaning: 'h√°t' },
    { now: 'sleep', past: 'slept', meaning: 'ng·ªß' },
    { now: 'write', past: 'wrote', meaning: 'vi·∫øt' },
    { now: 'read', past: 'read', meaning: 'ƒë·ªçc' },
    { now: 'buy', past: 'bought', meaning: 'mua' },
    { now: 'get', past: 'got', meaning: 'ƒë∆∞·ª£c' },
    { now: 'sit', past: 'sat', meaning: 'ng·ªìi' },
    { now: 'stand', past: 'stood', meaning: 'ƒë·ª©ng' },
    { now: 'fly', past: 'flew', meaning: 'bay' },
    { now: 'do', past: 'did', meaning: 'l√†m' },
    { now: 'say', past: 'said', meaning: 'n√≥i' },
    { now: 'tell', past: 'told', meaning: 'k·ªÉ' },
    { now: 'think', past: 'thought', meaning: 'nghƒ©' },
    { now: 'know', past: 'knew', meaning: 'bi·∫øt' },
    { now: 'put', past: 'put', meaning: 'ƒë·∫∑t' },
    { now: 'cut', past: 'cut', meaning: 'c·∫Øt' },
    { now: 'draw', past: 'drew', meaning: 'v·∫Ω' },
    { now: 'grow', past: 'grew', meaning: 'l·ªõn l√™n' },
    { now: 'throw', past: 'threw', meaning: 'n√©m' },
    { now: 'catch', past: 'caught', meaning: 'b·∫Øt' },
    { now: 'teach', past: 'taught', meaning: 'd·∫°y' },
    { now: 'bring', past: 'brought', meaning: 'mang' },
    { now: 'find', past: 'found', meaning: 't√¨m th·∫•y' },
    { now: 'feel', past: 'felt', meaning: 'c·∫£m th·∫•y' },
    { now: 'leave', past: 'left', meaning: 'r·ªùi ƒëi' },
    { now: 'meet', past: 'met', meaning: 'g·∫∑p' },
    { now: 'send', past: 'sent', meaning: 'g·ª≠i' },
    { now: 'build', past: 'built', meaning: 'x√¢y' },
    { now: 'wear', past: 'wore', meaning: 'm·∫∑c' }
  ]
};

// ============ STATE ============
var soundEnabled = true;
var currentTopic = '';
var currentStory = 0;
var currentScene = 0;
var stars = 0;
var totalQuestions = 0;
var correctAnswers = 0;
var questionsPerRound = 6; // S·ªë c√¢u m·ªói l∆∞·ª£t
var allQuestions = []; // M·∫£ng ch·ª©a c√¢u h·ªèi ƒë√£ tr·ªôn
var currentQuestionIndex = 0;

// H·ªá th·ªëng t√≠ch l≈©y sao
var totalStars = 0;
var todayStars = 0;
var streakDays = 0;
var todayMistakes = []; // Theo d√µi c√¢u sai h√¥m nay

// Load sao t·ª´ localStorage
function loadStarData() {
  try {
    var saved = localStorage.getItem('verbStarData');
    if (saved) {
      var data = JSON.parse(saved);
      totalStars = data.totalStars || 0;
      
      // Ki·ªÉm tra ng√†y h√¥m nay
      var today = new Date().toDateString();
      if (data.lastDate === today) {
        todayStars = data.todayStars || 0;
        todayMistakes = data.todayMistakes || [];
      } else {
        todayStars = 0;
        todayMistakes = []; // Reset c√¢u sai m·ªói ng√†y m·ªõi
        // Ki·ªÉm tra streak
        var lastDate = new Date(data.lastDate);
        var todayDate = new Date(today);
        var diffDays = Math.floor((todayDate - lastDate) / (1000 * 60 * 60 * 24));
        if (diffDays === 1) {
          streakDays = (data.streakDays || 0) + 1;
        } else if (diffDays > 1) {
          streakDays = 1;
        } else {
          streakDays = data.streakDays || 1;
        }
      }
      streakDays = data.streakDays || 1;
    }
  } catch(e) {
    console.log('Cannot load star data');
  }
}

// L∆∞u sao v√†o localStorage
function saveStarData() {
  try {
    var data = {
      totalStars: totalStars,
      todayStars: todayStars,
      lastDate: new Date().toDateString(),
      streakDays: streakDays,
      todayMistakes: todayMistakes
    };
    localStorage.setItem('verbStarData', JSON.stringify(data));
  } catch(e) {
    console.log('Cannot save star data');
  }
}

// Th√™m c√¢u sai v√†o danh s√°ch
function addMistake(mistakeData) {
  // Ki·ªÉm tra xem ƒë√£ c√≥ c√¢u t∆∞∆°ng t·ª± ch∆∞a (tr√°nh tr√πng l·∫∑p)
  var isDuplicate = todayMistakes.some(function(m) {
    return m.sentence === mistakeData.sentence && m.correctAnswer === mistakeData.correctAnswer;
  });
  
  if (!isDuplicate) {
    mistakeData.timestamp = new Date().toLocaleTimeString('vi-VN', {hour: '2-digit', minute: '2-digit'});
    todayMistakes.push(mistakeData);
    saveStarData();
  }
}

// X√≥a m·ªôt c√¢u sai kh·ªèi danh s√°ch (khi ƒë√£ √¥n t·∫≠p ƒë√∫ng)
function removeMistake(index) {
  if (index >= 0 && index < todayMistakes.length) {
    todayMistakes.splice(index, 1);
    saveStarData();
  }
}

// Th√™m sao
function addStars(count) {
  stars += count;
  totalStars += count;
  todayStars += count;
  saveStarData();
}

// Matching game state
var matchCards = [];
var selectedCard = null;
var matchedPairs = [];

// Flashcard state
var flashcardIndex = 0;
var isFlipped = false;

// ============ LEVEL SELECT ============
function showLevelSelect(topic) {
  playSound('click');
  currentTopic = topic;
  
  var topicName = topic === 'daily' ? '‚òÄÔ∏è Every Day' : 
                  topic === 'yesterday' ? 'üåô Yesterday' : 'üìñ Mix Stories';
  
  var html = '<div class="level-content">' +
    '<div style="text-align:left;margin-bottom:10px"><button class="back-btn" onclick="goHome()">‚Üê Home</button></div>' +
    '<div style="font-size:60px;margin-bottom:15px">' + 
    (topic === 'daily' ? '‚òÄÔ∏è' : topic === 'yesterday' ? 'üåô' : 'üìñ') + '</div>' +
    '<div class="level-title">' + topicName + '</div>' +
    '<div class="level-subtitle">Ch·ªçn s·ªë c√¢u h·ªèi con mu·ªën l√†m:</div>' +
    
    '<div class="level-cards">' +
    '<div class="level-card easy" onclick="startWithLevel(5)">' +
    '<div class="level-icon">üå±</div>' +
    '<div class="level-info">' +
    '<div class="level-name">Nhanh</div>' +
    '<div class="level-desc">Luy·ªán t·∫≠p nh·∫π nh√†ng</div>' +
    '</div>' +
    '<div class="level-time">5 c√¢u ‚Ä¢ 3 ph√∫t</div>' +
    '</div>' +
    
    '<div class="level-card medium" onclick="startWithLevel(8)">' +
    '<div class="level-icon">üåø</div>' +
    '<div class="level-info">' +
    '<div class="level-name">V·ª´a ph·∫£i</div>' +
    '<div class="level-desc">√în t·∫≠p c∆° b·∫£n</div>' +
    '</div>' +
    '<div class="level-time">8 c√¢u ‚Ä¢ 5 ph√∫t</div>' +
    '</div>' +
    
    '<div class="level-card hard" onclick="startWithLevel(10)">' +
    '<div class="level-icon">üå≥</div>' +
    '<div class="level-info">' +
    '<div class="level-name">Th·ª≠ th√°ch</div>' +
    '<div class="level-desc">Ki·ªÉm tra ki·∫øn th·ª©c</div>' +
    '</div>' +
    '<div class="level-time">10 c√¢u ‚Ä¢ 8 ph√∫t</div>' +
    '</div>' +
    
    '<div class="level-card" onclick="startWithLevel(15)" style="border-color:#9C27B0">' +
    '<div class="level-icon">üèÜ</div>' +
    '<div class="level-info">' +
    '<div class="level-name" style="color:#7B1FA2">Si√™u sao</div>' +
    '<div class="level-desc">D√†nh cho cao th·ªß!</div>' +
    '</div>' +
    '<div class="level-time">15 c√¢u ‚Ä¢ 12 ph√∫t</div>' +
    '</div>' +
    
    '<div class="level-card" onclick="startWithLevel(20)" style="border-color:#FF6D00;background:linear-gradient(135deg,#FFF8E1,#FFECB3)">' +
    '<div class="level-icon">üî•</div>' +
    '<div class="level-info">' +
    '<div class="level-name" style="color:#E65100">Huy·ªÅn tho·∫°i</div>' +
    '<div class="level-desc">Boss cu·ªëi ƒë√¢y r·ªìi! üëæ</div>' +
    '</div>' +
    '<div class="level-time">20 c√¢u ‚Ä¢ 15 ph√∫t</div>' +
    '</div>' +
    '</div></div>';
  
  document.getElementById('levelScreen').innerHTML = html;
  showScreen('levelScreen');
}

function startWithLevel(numQuestions) {
  playSound('click');
  questionsPerRound = numQuestions;
  
  // Thu th·∫≠p t·∫•t c·∫£ c√¢u h·ªèi t·ª´ topic
  allQuestions = [];
  
  if (currentTopic === 'daily') {
    // Every Day: ch·ªâ d√πng c√¢u hi·ªán t·∫°i
    allQuestions = generateStoriesFromTemplates(numQuestions, false);
  } else if (currentTopic === 'yesterday') {
    // Yesterday: ch·ªâ d√πng c√¢u qu√° kh·ª©
    allQuestions = generateStoriesFromTemplates(numQuestions, true);
  } else if (currentTopic === 'stories') {
    // Mix Stories: mix c·∫£ hai
    allQuestions = generateMixStoryQuestions(numQuestions);
  }
  
  // ƒê·∫£m b·∫£o ch·ªâ l·∫•y ƒë√∫ng s·ªë c√¢u h·ªèi y√™u c·∫ßu
  allQuestions = allQuestions.slice(0, numQuestions);
  
  // Reset state
  currentQuestionIndex = 0;
  stars = 0;
  correctAnswers = 0;
  totalQuestions = numQuestions;
  
  // B·∫Øt ƒë·∫ßu hi·ªÉn th·ªã c√¢u h·ªèi
  showQuestion();
}

// Generate questions cho Daily ho·∫∑c Yesterday
function generateStoriesFromTemplates(count, isPastOnly) {
  var questions = [];
  var usedTemplates = [];
  
  var signalList = isPastOnly ? SIGNAL_WORDS.past : SIGNAL_WORDS.present;
  var bg = isPastOnly ? 'bg-night' : 'bg-sunny';
  
  for (var i = 0; i < count; i++) {
    var templateIndex;
    do {
      templateIndex = Math.floor(Math.random() * SENTENCE_TEMPLATES.length);
    } while (usedTemplates.indexOf(templateIndex) >= 0 && usedTemplates.length < SENTENCE_TEMPLATES.length);
    usedTemplates.push(templateIndex);
    
    var template = SENTENCE_TEMPLATES[templateIndex];
    var verbForms = getVerbForms(template.verb);
    var sentenceType = template.type || 'affirm';
    
    var signalObj = signalList[Math.floor(Math.random() * signalList.length)];
    
    var correctAnswer, wrongAnswer;
    var subject = template.subject.toLowerCase();
    var isThirdPerson = ['he', 'she', 'it', 'mom', 'dad', 'the baby', 'the bird', 'the tree', 'the class', 'the cat', 'the dog', 'the sun', 'the moon', 'the flower', 'the food', 'the milk', 'the phone', 'the doorbell', 'the alarm', 'the bell', 'the hen', 'the monkey', 'the thief', 'the hunter', 'the fire', 'the wind', 'water', 'the lake', 'the book', 'the trip', 'the movie', 'the show', 'the game', 'my finger', 'his nose', 'the wound', 'the earthquake', 'this word', 'someone', 'the temperature', 'the water level', 'the light', 'the plane'].indexOf(subject) >= 0;
    
    if (sentenceType === 'affirm') {
      correctAnswer = isPastOnly ? verbForms.past : getPresentForm(verbForms.base, template.subject);
      wrongAnswer = isPastOnly ? getPresentForm(verbForms.base, template.subject) : verbForms.past;
    } else if (sentenceType === 'negative') {
      if (isPastOnly) {
        correctAnswer = "didn't";
        wrongAnswer = isThirdPerson ? "doesn't" : "don't";
      } else {
        correctAnswer = isThirdPerson ? "doesn't" : "don't";
        wrongAnswer = "didn't";
      }
    } else if (sentenceType === 'question') {
      if (isPastOnly) {
        correctAnswer = "Did";
        wrongAnswer = isThirdPerson ? "Does" : "Do";
      } else {
        correctAnswer = isThirdPerson ? "Does" : "Do";
        wrongAnswer = "Did";
      }
    } else if (sentenceType === 'question_verb') {
      // C√¢u h·ªèi ƒë√£ c√≥ Do/Does/Did, c·∫ßn ƒëi·ªÅn ƒë·ªông t·ª´ g·ªëc
      correctAnswer = verbForms.base;
      // Wrong answer: d·∫°ng qu√° kh·ª© (V2) ho·∫∑c V-s/es
      wrongAnswer = verbForms.past;
    }
    
    // Hi·ªÉn th·ªã c√¢u v·ªõi ch·ªó tr·ªëng v√† g·∫°ch ch√¢n d·∫•u hi·ªáu
    var underlinedSignal = '<span style="text-decoration:underline;text-decoration-color:#FF9800;text-decoration-thickness:2px;font-weight:600">' + signalObj.signal + '</span>';
    var displayText = template.template
      .replace('{signal}', underlinedSignal)
      .replace('___', '<span style="color:#667eea;font-weight:700;border-bottom:2px solid #667eea;padding:0 8px">____</span>');
    
    var choices, correctIdx;
    
    // X·ª≠ l√Ω ƒë·∫∑c bi·ªát cho question_verb: 3 l·ª±a ch·ªçn
    if (sentenceType === 'question_verb') {
      var vBase = verbForms.base;
      var vPast = verbForms.past;
      var vPresent = getPresentForm(verbForms.base, 'She'); // V-s/es
      
      choices = [
        { text: vBase, correct: true },
        { text: vPast, correct: false },
        { text: vPresent, correct: false }
      ];
      
      // Lo·∫°i b·ªè ƒë√°p √°n tr√πng
      choices = choices.filter(function(c, idx, arr) {
        return arr.findIndex(function(x) { return x.text === c.text; }) === idx;
      });
      
      // Th√™m ƒë√°p √°n g√¢y nhi·ªÖu n·∫øu thi·∫øu
      var extraVerbs = ['went', 'goes', 'ate', 'eats', 'took', 'takes', 'saw', 'sees'];
      var ei = 0;
      while (choices.length < 3 && ei < extraVerbs.length) {
        if (choices.findIndex(function(c) { return c.text === extraVerbs[ei]; }) < 0) {
          choices.push({ text: extraVerbs[ei], correct: false });
        }
        ei++;
      }
      
      choices = shuffle(choices);
      correctIdx = choices.findIndex(function(c) { return c.correct; });
      choices = choices.map(function(c) { return c.text; });
    } else if (sentenceType === 'affirm') {
      // C√¢u kh·∫≥ng ƒë·ªãnh: 3 l·ª±a ch·ªçn - V g·ªëc, V-s/es, V2
      var vBase = verbForms.base;
      var vPast = verbForms.past;
      var vPresent = getPresentForm(verbForms.base, template.subject);
      var vPresentThird = getPresentForm(verbForms.base, 'She'); // V-s/es cho ng√¥i 3
      
      choices = [
        { text: correctAnswer, correct: true },
        { text: wrongAnswer, correct: false },
        { text: vBase, correct: false }
      ];
      
      // Th√™m c√°c d·∫°ng kh√°c n·∫øu ch∆∞a c√≥
      if (choices.findIndex(function(c) { return c.text === vPast; }) < 0) {
        choices.push({ text: vPast, correct: false });
      }
      if (choices.findIndex(function(c) { return c.text === vPresentThird; }) < 0) {
        choices.push({ text: vPresentThird, correct: false });
      }
      
      // Lo·∫°i b·ªè ƒë√°p √°n tr√πng
      choices = choices.filter(function(c, idx, arr) {
        return arr.findIndex(function(x) { return x.text === c.text; }) === idx;
      });
      
      // N·∫øu v·∫´n ch∆∞a ƒë·ªß 3, th√™m t·ª´ ƒë·ªông t·ª´ ph·ªï bi·∫øn kh√°c
      var extraVerbs = ['went', 'goes', 'go', 'ate', 'eats', 'eat', 'took', 'takes', 'take', 'saw', 'sees', 'see'];
      var ej = 0;
      while (choices.length < 3 && ej < extraVerbs.length) {
        var extra = extraVerbs[ej];
        if (choices.findIndex(function(c) { return c.text === extra; }) < 0 && extra !== correctAnswer) {
          choices.push({ text: extra, correct: false });
        }
        ej++;
      }
      
      // Ch·ªâ l·∫•y 3 ƒë√°p √°n (1 ƒë√∫ng + 2 sai)
      var correctChoice = choices.find(function(c) { return c.correct; });
      var wrongChoices = choices.filter(function(c) { return !c.correct; }).slice(0, 2);
      choices = [correctChoice].concat(wrongChoices);
      
      choices = shuffle(choices);
      correctIdx = choices.findIndex(function(c) { return c.correct; });
      choices = choices.map(function(c) { return c.text; });
    } else {
      // negative, question: 2 l·ª±a ch·ªçn (kh√¥ng c√≥ icon)
      choices = [correctAnswer, wrongAnswer];
      
      correctIdx = 0;
      if (Math.random() > 0.5) {
        choices = [choices[1], choices[0]];
        correctIdx = 1;
      }
    }
    
    var feedback = '';
    var tip = '';
    if (sentenceType === 'affirm') {
      feedback = 'ƒê√∫ng! ' + signalObj.signal + ' ‚Üí ' + correctAnswer;
      tip = isPastOnly ? 'üåô ' + signalObj.signal + ' ‚Üí qu√° kh·ª©' : '‚òÄÔ∏è ' + signalObj.signal + ' ‚Üí hi·ªán t·∫°i';
    } else if (sentenceType === 'negative') {
      feedback = isPastOnly ? 'ƒê√∫ng! Ph·ªß ƒë·ªãnh qu√° kh·ª© ‚Üí didn\'t' : 'ƒê√∫ng! Ph·ªß ƒë·ªãnh hi·ªán t·∫°i ‚Üí ' + correctAnswer;
      tip = isPastOnly ? 'üö´üåô didn\'t + ƒë·ªông t·ª´ g·ªëc' : 'üö´‚òÄÔ∏è ' + correctAnswer + ' + ƒë·ªông t·ª´ g·ªëc';
    } else if (sentenceType === 'question') {
      feedback = isPastOnly ? 'ƒê√∫ng! C√¢u h·ªèi qu√° kh·ª© ‚Üí Did' : 'ƒê√∫ng! C√¢u h·ªèi hi·ªán t·∫°i ‚Üí ' + correctAnswer;
      tip = isPastOnly ? '‚ùìüåô Did + S + V g·ªëc?' : '‚ùì‚òÄÔ∏è ' + correctAnswer + ' + S + V g·ªëc?';
    } else if (sentenceType === 'question_verb') {
      feedback = 'ƒê√∫ng! Sau Do/Does/Did d√πng V g·ªëc: ' + correctAnswer;
      tip = '‚ö†Ô∏è Do/Does/Did + V g·ªëc (kh√¥ng chia)';
    }
    
    // Th√™m th√¥ng tin cho feedback chi ti·∫øt
    var subjectInfo = '';
    var isThirdPerson = ['he', 'she', 'it', 'mom', 'dad', 'the baby', 'the bird', 'the tree', 'the class', 'the cat', 'the dog', 'the sun', 'the moon', 'the flower', 'the food', 'the milk', 'the phone', 'the doorbell', 'the alarm', 'the bell', 'the hen', 'the monkey', 'the thief', 'the hunter', 'the fire', 'the wind', 'water', 'the lake', 'the book', 'the trip', 'the movie', 'the show', 'the game', 'my finger', 'his nose', 'the wound', 'the earthquake', 'this word', 'someone', 'the temperature', 'the water level', 'the light', 'the plane'].indexOf(template.subject.toLowerCase()) >= 0;
    if (isThirdPerson) {
      subjectInfo = template.subject + ' (ng√¥i 3) ‚Üí th√™m s/es';
    } else {
      subjectInfo = template.subject + ' ‚Üí gi·ªØ nguy√™n V g·ªëc';
    }
    
    questions.push({
      bg: bg,
      image: template.emoji || '',
      text: displayText,
      question: '',
      choices: choices,
      correct: correctIdx,
      feedback: feedback,
      tip: tip,
      sentenceType: sentenceType,
      subject: template.subject,
      isThirdPerson: isThirdPerson,
      isPast: isPastOnly,
      signal: signalObj.signal,
      correctAnswer: correctAnswer,
      verb: verbForms.base
    });
  }
  
  return shuffle(questions);
}

// Generate questions for Mix Stories from SENTENCE_TEMPLATES
function generateMixStoryQuestions(count) {
  var questions = [];
  var usedTemplates = [];
  
  var allVerbs = [];
  IRREGULAR_VERBS.groups.forEach(function(group) {
    group.verbs.forEach(function(verb) {
      allVerbs.push(verb);
    });
  });
  
  for (var i = 0; i < count; i++) {
    var templateIndex;
    do {
      templateIndex = Math.floor(Math.random() * SENTENCE_TEMPLATES.length);
    } while (usedTemplates.indexOf(templateIndex) >= 0 && usedTemplates.length < SENTENCE_TEMPLATES.length);
    usedTemplates.push(templateIndex);
    
    var template = SENTENCE_TEMPLATES[templateIndex];
    var verbForms = getVerbForms(template.verb);
    var sentenceType = template.type || 'affirm';
    
    var isPast = Math.random() > 0.5;
    var signalList = isPast ? SIGNAL_WORDS.past : SIGNAL_WORDS.present;
    var signalObj = signalList[Math.floor(Math.random() * signalList.length)];
    
    var correctAnswer, wrongAnswer;
    var subject = template.subject.toLowerCase();
    var isThirdPerson = ['he', 'she', 'it', 'mom', 'dad', 'the baby', 'the bird', 'the tree', 'the class', 'the cat', 'the dog', 'the sun', 'the moon', 'the flower', 'the food', 'the milk', 'the phone', 'the doorbell', 'the alarm', 'the bell', 'the hen', 'the monkey', 'the thief', 'the hunter', 'the fire', 'the wind', 'water', 'the lake', 'the book', 'the trip', 'the movie', 'the show', 'the game', 'my finger', 'his nose', 'the wound', 'the earthquake', 'this word', 'someone', 'the temperature', 'the water level', 'the light', 'the plane'].indexOf(subject) >= 0;
    
    var bg = isPast ? 'bg-night' : 'bg-sunny';
    
    if (sentenceType === 'affirm') {
      correctAnswer = isPast ? verbForms.past : getPresentForm(verbForms.base, template.subject);
      wrongAnswer = isPast ? getPresentForm(verbForms.base, template.subject) : verbForms.past;
    } else if (sentenceType === 'negative') {
      if (isPast) {
        correctAnswer = "didn't";
        wrongAnswer = isThirdPerson ? "doesn't" : "don't";
      } else {
        correctAnswer = isThirdPerson ? "doesn't" : "don't";
        wrongAnswer = "didn't";
      }
    } else if (sentenceType === 'question') {
      if (isPast) {
        correctAnswer = "Did";
        wrongAnswer = isThirdPerson ? "Does" : "Do";
      } else {
        correctAnswer = isThirdPerson ? "Does" : "Do";
        wrongAnswer = "Did";
      }
    } else if (sentenceType === 'question_verb') {
      // ƒê√£ c√≥ Do/Does/Did, c·∫ßn ƒëi·ªÅn ƒë·ªông t·ª´ g·ªëc
      correctAnswer = verbForms.base;
      wrongAnswer = isPast ? verbForms.past : getPresentForm(verbForms.base, 'She');
    }
    
    var sentence = template.template.replace('{signal}', signalObj.signal);
    
    // Hi·ªÉn th·ªã c√¢u v·ªõi ch·ªó tr·ªëng v√† g·∫°ch ch√¢n d·∫•u hi·ªáu (KH√îNG hi·ªán ƒë√°p √°n)
    var underlinedSignal = '<span style="text-decoration:underline;text-decoration-color:#FF9800;text-decoration-thickness:2px;font-weight:600">' + signalObj.signal + '</span>';
    var displayText = template.template
      .replace('{signal}', underlinedSignal)
      .replace('___', '<span style="color:#667eea;font-weight:700;border-bottom:2px solid #667eea;padding:0 8px">____</span>');
    
    var questionText = sentence;
    var choices, correctIdx;
    
    // X·ª≠ l√Ω ƒë·∫∑c bi·ªát cho question_verb: 3 l·ª±a ch·ªçn
    if (sentenceType === 'question_verb') {
      var vBase = verbForms.base;
      var vPast = verbForms.past;
      var vPresent = getPresentForm(verbForms.base, 'She'); // V-s/es
      
      choices = [
        { text: vBase, correct: true },
        { text: vPast, correct: false },
        { text: vPresent, correct: false }
      ];
      // Lo·∫°i b·ªè tr√πng v√† th√™m ƒë√°p √°n n·∫øu c·∫ßn
      choices = choices.filter(function(c, idx, arr) {
        return arr.findIndex(function(x) { return x.text === c.text; }) === idx;
      });
      var extraVerbs = ['went', 'goes', 'go', 'ate', 'eats', 'eat'];
      var ei = 0;
      while (choices.length < 3 && ei < extraVerbs.length) {
        if (choices.findIndex(function(c) { return c.text === extraVerbs[ei]; }) < 0) {
          choices.push({ text: extraVerbs[ei], correct: false });
        }
        ei++;
      }
      choices = shuffle(choices).slice(0, 3);
      correctIdx = choices.findIndex(function(c) { return c.correct; });
      if (correctIdx < 0) { choices[0].correct = true; correctIdx = 0; }
      choices = choices.map(function(c) { return c.text; });
    } else if (sentenceType === 'affirm') {
      // C√¢u kh·∫≥ng ƒë·ªãnh: 3 l·ª±a ch·ªçn
      var vBase = verbForms.base;
      var vPast = verbForms.past;
      var vPresent = getPresentForm(verbForms.base, template.subject);
      var vPresentThird = getPresentForm(verbForms.base, 'She');
      
      choices = [
        { text: correctAnswer, correct: true },
        { text: wrongAnswer, correct: false },
        { text: vBase, correct: false }
      ];
      
      // Th√™m c√°c d·∫°ng kh√°c
      if (choices.findIndex(function(c) { return c.text === vPast; }) < 0) {
        choices.push({ text: vPast, correct: false });
      }
      if (choices.findIndex(function(c) { return c.text === vPresentThird; }) < 0) {
        choices.push({ text: vPresentThird, correct: false });
      }
      
      // Lo·∫°i b·ªè ƒë√°p √°n tr√πng
      choices = choices.filter(function(c, idx, arr) {
        return arr.findIndex(function(x) { return x.text === c.text; }) === idx;
      });
      
      // Th√™m t·ª´ ƒë·ªông t·ª´ kh√°c n·∫øu c·∫ßn
      var extraVerbs = ['went', 'goes', 'go', 'ate', 'eats', 'eat', 'took', 'takes', 'take'];
      var ej = 0;
      while (choices.length < 3 && ej < extraVerbs.length) {
        if (choices.findIndex(function(c) { return c.text === extraVerbs[ej]; }) < 0 && extraVerbs[ej] !== correctAnswer) {
          choices.push({ text: extraVerbs[ej], correct: false });
        }
        ej++;
      }
      
      // Ch·ªâ l·∫•y 3 ƒë√°p √°n
      var correctChoice = choices.find(function(c) { return c.correct; });
      var wrongChoices = choices.filter(function(c) { return !c.correct; }).slice(0, 2);
      choices = [correctChoice].concat(wrongChoices);
      
      choices = shuffle(choices);
      correctIdx = choices.findIndex(function(c) { return c.correct; });
      choices = choices.map(function(c) { return c.text; });
    } else {
      // negative, question: 2 l·ª±a ch·ªçn (kh√¥ng c√≥ icon)
      choices = [correctAnswer, wrongAnswer];
      
      correctIdx = 0;
      if (Math.random() > 0.5) {
        choices = [choices[1], choices[0]];
        correctIdx = 1;
      }
    }
    
    var feedback = '';
    var tip = '';
    if (sentenceType === 'affirm') {
      feedback = 'ƒê√∫ng! ' + signalObj.signal + ' ‚Üí ' + correctAnswer;
      tip = isPast ? 'üåô ' + signalObj.signal + ' ‚Üí qu√° kh·ª©' : '‚òÄÔ∏è ' + signalObj.signal + ' ‚Üí hi·ªán t·∫°i';
    } else if (sentenceType === 'negative') {
      feedback = isPast ? 'ƒê√∫ng! Ph·ªß ƒë·ªãnh qu√° kh·ª© ‚Üí didn\'t' : 'ƒê√∫ng! Ph·ªß ƒë·ªãnh hi·ªán t·∫°i ‚Üí ' + correctAnswer;
      tip = isPast ? 'üö´üåô didn\'t + ƒë·ªông t·ª´ g·ªëc' : 'üö´‚òÄÔ∏è ' + correctAnswer + ' + ƒë·ªông t·ª´ g·ªëc';
    } else if (sentenceType === 'question') {
      feedback = isPast ? 'ƒê√∫ng! C√¢u h·ªèi qu√° kh·ª© ‚Üí Did' : 'ƒê√∫ng! C√¢u h·ªèi hi·ªán t·∫°i ‚Üí ' + correctAnswer;
      tip = isPast ? '‚ùìüåô Did + S + V g·ªëc?' : '‚ùì‚òÄÔ∏è ' + correctAnswer + ' + S + V g·ªëc?';
    } else if (sentenceType === 'question_verb') {
      feedback = 'ƒê√∫ng! Sau Do/Does/Did ‚Üí ƒë·ªông t·ª´ G·ªêC';
      tip = '‚ö†Ô∏è Do/Does/Did + V g·ªëc';
    }
    
    // Th√™m th√¥ng tin chi ti·∫øt
    var isThirdPerson = ['he', 'she', 'it', 'mom', 'dad', 'the baby', 'the bird', 'the tree', 'the class', 'the cat', 'the dog', 'the sun', 'the moon', 'the flower', 'the food', 'the milk', 'the phone', 'the doorbell', 'the alarm', 'the bell', 'the hen', 'the monkey', 'the thief', 'the hunter', 'the fire', 'the wind', 'water', 'the lake', 'the book', 'the trip', 'the movie', 'the show', 'the game', 'my finger', 'his nose', 'the wound', 'the earthquake', 'this word', 'someone', 'the temperature', 'the water level', 'the light', 'the plane'].indexOf(template.subject.toLowerCase()) >= 0;
    
    questions.push({
      bg: bg,
      image: template.emoji || '',
      text: displayText,
      question: '',
      choices: choices,
      correct: correctIdx,
      feedback: feedback,
      tip: tip,
      sentenceVn: template.vn,
      sentenceType: sentenceType,
      subject: template.subject,
      isThirdPerson: isThirdPerson,
      isPast: isPast,
      signal: signalObj.signal,
      correctAnswer: correctAnswer,
      verb: verbForms.base
    });
  }
  
  return shuffle(questions);
}

function showQuestion() {
  if (currentQuestionIndex >= totalQuestions) {
    showResult();
    return;
  }
  
  var q = allQuestions[currentQuestionIndex];
  if (!q) {
    showResult();
    return;
  }
  
  document.getElementById('appContainer').className = 'app-container ' + q.bg;
  
  var dotsHtml = '';
  for (var i = 0; i < totalQuestions; i++) {
    var dotClass = 'dot';
    if (i < currentQuestionIndex) dotClass += ' done';
    else if (i === currentQuestionIndex) dotClass += ' active';
    dotsHtml += '<div class="' + dotClass + '"></div>';
  }
  
  var html = '<div class="progress-header">' +
    '<button class="back-btn" onclick="goHome()">‚Üê Home</button>' +
    '<div class="progress-dots">' + dotsHtml + '</div>' +
    '<div class="star-count">‚≠ê ' + stars + '</div>' +
    '</div>' +
    '<div class="story-scene">';
  
  // Ch·ªâ hi·ªán image n·∫øu c√≥
  if (q.image && q.image.length > 0) {
    html += '<div class="scene-image">' + q.image + '</div>';
  }
  
  html += '<div class="scene-text">' + q.text + '</div>';
  
  // Ch·ªâ hi·ªán question n·∫øu c√≥ n·ªôi dung
  if (q.question && q.question.length > 0) {
    html += '<div class="scene-question">' + q.question + '</div>';
  }
  
  html += '<div class="choice-buttons">';
  
  q.choices.forEach(function(choice, i) {
    html += '<button class="choice-btn" id="choice' + i + '" onclick="checkQuestionAnswer(' + i + ')">' + choice + '</button>';
  });
  
  html += '</div><div id="feedbackArea"></div></div>';
  
  document.getElementById('storyScreen').innerHTML = html;
  showScreen('storyScreen');
}

function checkQuestionAnswer(index) {
  var q = allQuestions[currentQuestionIndex];
  var correct = index === q.correct;
  
  // Disable all buttons
  document.querySelectorAll('.choice-btn').forEach(function(btn, i) {
    btn.disabled = true;
    if (i === q.correct) btn.classList.add('correct');
    if (i === index && !correct) btn.classList.add('wrong');
  });
  
  if (correct) {
    addStars(1);
    correctAnswers++;
    playSound('correct');
    showConfetti();
  } else {
    playSound('wrong');
  }
  
  // L·∫•y ƒë√°p √°n ƒë√∫ng (b·ªè emoji)
  var correctAnswerText = q.choices[q.correct].replace(/ ?[üåô‚òÄÔ∏è]/g, '').trim();
  
  var feedbackHtml = '<div class="feedback-box ' + (correct ? 'correct' : 'wrong') + '">' +
    '<div class="feedback-emoji">' + (correct ? 'üéâ' : 'üí™') + '</div>' +
    '<div class="feedback-text">' + (correct ? '‚úÖ Ch√≠nh x√°c!' : '‚ùå Ch∆∞a ƒë√∫ng!') + '</div>';
  
  // T·∫°o gi·∫£i th√≠ch chi ti·∫øt
  var explanation = '';
  
  if (q.sentenceType === 'affirm') {
    if (q.isPast) {
      explanation = 'üåô <strong>' + q.signal + '</strong> ‚Üí th√¨ QU√Å KH·ª®<br>' +
        'üëâ ' + q.subject + ' + <strong>V2</strong> (' + q.verb + ' ‚Üí ' + correctAnswerText + ')';
    } else {
      if (q.isThirdPerson) {
        explanation = '‚òÄÔ∏è <strong>' + q.signal + '</strong> ‚Üí th√¨ HI·ªÜN T·∫†I<br>' +
          'üëâ ' + q.subject + ' (ng√¥i 3) + <strong>V-s/es</strong> (' + q.verb + ' ‚Üí ' + correctAnswerText + ')';
      } else {
        explanation = '‚òÄÔ∏è <strong>' + q.signal + '</strong> ‚Üí th√¨ HI·ªÜN T·∫†I<br>' +
          'üëâ ' + q.subject + ' + <strong>V g·ªëc</strong> (' + q.verb + ' ‚Üí ' + correctAnswerText + ')';
      }
    }
  } else if (q.sentenceType === 'negative') {
    if (q.isPast) {
      explanation = 'üö´üåô Ph·ªß ƒë·ªãnh QU√Å KH·ª®<br>' +
        'üëâ ' + q.subject + ' + <strong>didn\'t</strong> + V g·ªëc';
    } else {
      var helper = q.isThirdPerson ? "doesn't" : "don't";
      explanation = 'üö´‚òÄÔ∏è Ph·ªß ƒë·ªãnh HI·ªÜN T·∫†I<br>' +
        'üëâ ' + q.subject + (q.isThirdPerson ? ' (ng√¥i 3)' : '') + ' + <strong>' + helper + '</strong> + V g·ªëc';
    }
  } else if (q.sentenceType === 'question') {
    if (q.isPast) {
      explanation = '‚ùìüåô C√¢u h·ªèi QU√Å KH·ª®<br>' +
        'üëâ <strong>Did</strong> + ' + q.subject + ' + V g·ªëc?';
    } else {
      var helper = q.isThirdPerson ? "Does" : "Do";
      explanation = '‚ùì‚òÄÔ∏è C√¢u h·ªèi HI·ªÜN T·∫†I<br>' +
        'üëâ <strong>' + helper + '</strong> + ' + q.subject + ' + V g·ªëc?';
    }
  } else if (q.sentenceType === 'question_verb') {
    explanation = '‚ö†Ô∏è Sau <strong>Do/Does/Did</strong> lu√¥n d√πng <strong>V g·ªëc</strong><br>' +
      'üëâ ' + q.verb + ' (kh√¥ng chia th√†nh ' + q.verb + 's hay V2)';
  } else {
    explanation = q.tip;
  }
  
  feedbackHtml += '<div class="feedback-tip" style="text-align:left;line-height:1.6">' + explanation + '</div>';
  
  if (!correct) {
    feedbackHtml += '<div style="margin-top:10px;padding:12px;background:#E8F5E9;border-radius:10px;color:#2E7D32;font-weight:600">' +
      '‚úÖ ƒê√°p √°n ƒë√∫ng: <strong>' + correctAnswerText + '</strong></div>';
  }
  
  feedbackHtml += '<button class="next-btn" onclick="nextQuestion()">' +
    (currentQuestionIndex < totalQuestions - 1 ? 'Ti·∫øp theo ‚Üí' : 'Xem k·∫øt qu·∫£ üèÜ') +
    '</button></div>';
  
  document.getElementById('feedbackArea').innerHTML = feedbackHtml;
}

function nextQuestion() {
  currentQuestionIndex++;
  showQuestion();
}

// ============ SOUND ============
function playSound(type) {
  if (!soundEnabled) return;
  try {
    var ctx = new (window.AudioContext || window.webkitAudioContext)();
    var osc = ctx.createOscillator();
    var gain = ctx.createGain();
    osc.connect(gain);
    gain.connect(ctx.destination);
    
    if (type === 'correct') {
      osc.frequency.setValueAtTime(523, ctx.currentTime);
      osc.frequency.setValueAtTime(659, ctx.currentTime + 0.1);
      osc.frequency.setValueAtTime(784, ctx.currentTime + 0.2);
      gain.gain.setValueAtTime(0.3, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.4);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.4);
    } else if (type === 'wrong') {
      osc.frequency.setValueAtTime(330, ctx.currentTime);
      osc.frequency.setValueAtTime(294, ctx.currentTime + 0.15);
      gain.gain.setValueAtTime(0.2, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.3);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.3);
    } else if (type === 'click') {
      osc.frequency.setValueAtTime(800, ctx.currentTime);
      gain.gain.setValueAtTime(0.1, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.05);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.05);
    } else if (type === 'complete') {
      [523, 659, 784, 1047].forEach(function(freq, i) {
        var o = ctx.createOscillator();
        var g = ctx.createGain();
        o.connect(g); g.connect(ctx.destination);
        o.frequency.setValueAtTime(freq, ctx.currentTime + i * 0.15);
        g.gain.setValueAtTime(0.2, ctx.currentTime + i * 0.15);
        g.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + i * 0.15 + 0.2);
        o.start(ctx.currentTime + i * 0.15);
        o.stop(ctx.currentTime + i * 0.15 + 0.2);
      });
    } else if (type === 'flip') {
      osc.frequency.setValueAtTime(600, ctx.currentTime);
      osc.frequency.setValueAtTime(900, ctx.currentTime + 0.05);
      gain.gain.setValueAtTime(0.15, ctx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.1);
      osc.start(ctx.currentTime);
      osc.stop(ctx.currentTime + 0.1);
    }
  } catch(e) {}
}

function toggleSound() {
  soundEnabled = !soundEnabled;
  document.getElementById('soundToggle').textContent = soundEnabled ? 'üîä' : 'üîá';
}

// ============ CONFETTI ============
function showConfetti() {
  var container = document.getElementById('confettiContainer');
  container.innerHTML = '';
  var colors = ['#FFD700','#FF6B6B','#4CAF50','#2196F3','#E91E63'];
  for (var i = 0; i < 30; i++) {
    var c = document.createElement('div');
    c.className = 'confetti';
    c.style.left = Math.random() * 100 + '%';
    c.style.background = colors[Math.floor(Math.random() * colors.length)];
    c.style.borderRadius = Math.random() > 0.5 ? '50%' : '0';
    c.style.animationDelay = Math.random() * 0.5 + 's';
    container.appendChild(c);
  }
  setTimeout(function() { container.innerHTML = ''; }, 3000);
}

// ============ NAVIGATION ============
function showScreen(id) {
  document.querySelectorAll('.screen').forEach(function(s) {
    s.classList.remove('active');
  });
  document.getElementById(id).classList.add('active');
}

function goHome() {
  document.getElementById('appContainer').className = 'app-container bg-fun';
  updateStarDisplay();
  showMotivationalMessage();
  showScreen('homeScreen');
}

// C·∫≠p nh·∫≠t hi·ªÉn th·ªã sao
function updateStarDisplay() {
  var totalEl = document.getElementById('totalStarsDisplay');
  var todayEl = document.getElementById('todayStarsDisplay');
  if (totalEl) totalEl.textContent = totalStars;
  if (todayEl) todayEl.textContent = todayStars;
  
  // C·∫≠p nh·∫≠t streak banner
  var streakText = document.getElementById('streakText');
  if (streakText) {
    if (todayStars === 0) {
      streakText.textContent = 'B·∫Øt ƒë·∫ßu h·ªçc n√†o!';
    } else if (todayStars < 10) {
      streakText.textContent = 'T·ªët l·∫Øm! C·ªë th√™m n√†o! üí™';
    } else if (todayStars < 30) {
      streakText.textContent = 'Gi·ªèi qu√°! ' + todayStars + ' sao h√¥m nay! ‚≠ê';
    } else if (todayStars < 50) {
      streakText.textContent = 'Xu·∫•t s·∫Øc! ' + todayStars + ' sao! üåü';
    } else {
      streakText.textContent = 'Si√™u sao! ' + todayStars + ' sao! üèÜüëë';
    }
  }
}

// Kh·ªüi t·∫°o khi load trang
var MOTIVATIONAL_MESSAGES = [
  "üå± Ki√™n tr√¨ m·ªói ng√†y ‚Äî con ƒëang ti·∫øn b·ªô t·ª´ng b∆∞·ªõc r·ªìi ƒë·∫•y!",
  "üí™ Sai kh√¥ng sao, quan tr·ªçng l√† con kh√¥ng b·ªè cu·ªôc!",
  "üöÄ H√¥m nay con h·ªçc th√™m m·ªôt ch√∫t, mai con s·∫Ω bay xa h∆°n!",
  "üß© M·ªói c√¢u con l√†m ƒë√∫ng l√† m·ªôt m·∫£nh gh√©p ho√†n th√†nh!",
  "‚è∞ 10 ph√∫t m·ªói ng√†y, m·ªôt nƒÉm sau con s·∫Ω b·∫•t ng·ªù v·ªõi ch√≠nh m√¨nh!",
  "üê¢ Ch·∫≠m m√† ch·∫Øc ‚Äî con r√πa lu√¥n v·ªÅ ƒë√≠ch!",
  "üåà Kh√≥ h√¥m nay, d·ªÖ ng√†y mai ‚Äî c·ª© ti·∫øp t·ª•c th√¥i!",
  "üî• M·ªói l·∫ßn luy·ªán t·∫≠p, n√£o con l·∫°i m·∫°nh th√™m m·ªôt ch√∫t!",
  "üéØ Kh√¥ng c·∫ßn ho√†n h·∫£o, ch·ªâ c·∫ßn m·ªói ng√†y t·ªët h∆°n m·ªôt x√≠u!",
  "üåü Con ƒë√£ d√°m b·∫Øt ƒë·∫ßu ‚Äî ƒë√≥ l√† ƒëi·ªÅu tuy·ªát v·ªùi nh·∫•t r·ªìi!",
  "üèÉ ƒê·ª´ng so v·ªõi ai, h√£y so v·ªõi con c·ªßa ng√†y h√¥m qua!",
  "üé∏ H·ªçc ti·∫øng Anh gi·ªëng nh∆∞ t·∫≠p ƒë√†n ‚Äî c√†ng ch∆°i c√†ng hay!",
  "üß† N√£o con ƒëang ghi nh·ªõ d√π con kh√¥ng bi·∫øt ƒë·∫•y ‚Äî c·ª© ti·∫øp t·ª•c nh√©!",
  "üåª H·∫°t gi·ªëng h√¥m nay, c√¢y l·ªõn ng√†y mai ‚Äî con ƒëang gieo tr·ªìng r·ªìi!",
  "üíé Ki·∫øn th·ª©c l√† kho b√°u kh√¥ng ai l·∫•y ƒë∆∞·ª£c c·ªßa con!",
  "üêù ChƒÉm ch·ªâ nh∆∞ ong ‚Äî t·ª´ng ch√∫t m·∫≠t ng·ªçt s·∫Ω th√†nh!",
  "üìà Nh√¨n l·∫°i tu·∫ßn tr∆∞·ªõc xem ‚Äî con ƒë√£ bi·∫øt th√™m bao nhi√™u t·ª´ r·ªìi!",
  "üéÆ H·ªçc m√† vui, vui m√† h·ªçc ‚Äî c·ª© th·∫ø th√¥i n√†o!",
  "ü¶ã H√¥m nay con l√† s√¢u chƒÉm ch·ªâ, mai con s·∫Ω l√† b∆∞·ªõm xinh!",
  "‚ú® M·ªói ng√†y h·ªçc l√† m·ªôt ng√†y con tr·ªü n√™n ƒë·∫∑c bi·ªát h∆°n!"
];

function showMotivationalMessage() {
  var el = document.getElementById('motivationalMsg');
  if (el) {
    el.textContent = MOTIVATIONAL_MESSAGES[Math.floor(Math.random() * MOTIVATIONAL_MESSAGES.length)];
  }
}

window.addEventListener('load', function() {
  loadStarData();
  updateStarDisplay();
  showMotivationalMessage();
});

// ============ SHUFFLE ============
function shuffle(arr) {
  var a = arr.slice();
  for (var i = a.length - 1; i > 0; i--) {
    var j = Math.floor(Math.random() * (i + 1));
    var t = a[i]; a[i] = a[j]; a[j] = t;
  }
  return a;
}

// ============ LEARN SCREEN ============
function showLearnScreen() {
  playSound('click');
  document.getElementById('appContainer').className = 'app-container bg-sunny';
  
  var html = '<div class="progress-header" style="margin-bottom:20px">' +
    '<button class="back-btn" onclick="goHome()">‚Üê Home</button>' +
    '<div style="color:white;font-weight:700;font-size:1.2rem">üìö H·ªçc ki·∫øn th·ª©c</div>' +
    '<div></div></div>' +
    
    // === D·∫§U HI·ªÜU NH·∫¨N BI·∫æT ===
    '<div class="pattern-card">' +
    '<div class="pattern-title"><span class="icon">üîç</span> D·∫•u hi·ªáu nh·∫≠n bi·∫øt</div>' +
    '<div class="compare-box">' +
    '<div class="compare-side now">' +
    '<div class="label">‚òÄÔ∏è HI·ªÜN T·∫†I</div>' +
    '<div class="time-words">' +
    '<span class="time-word">every day</span>' +
    '<span class="time-word">every morning</span>' +
    '<span class="time-word">every night</span>' +
    '<span class="time-word">every week</span>' +
    '<span class="time-word">always</span>' +
    '<span class="time-word">usually</span>' +
    '<span class="time-word">often</span>' +
    '<span class="time-word">sometimes</span>' +
    '</div>' +
    '</div>' +
    '<div class="compare-side past">' +
    '<div class="label">üåô QU√Å KH·ª®</div>' +
    '<div class="time-words">' +
    '<span class="time-word">yesterday</span>' +
    '<span class="time-word">last night</span>' +
    '<span class="time-word">last week</span>' +
    '<span class="time-word">last month</span>' +
    '<span class="time-word">last year</span>' +
    '<span class="time-word">...ago</span>' +
    '<span class="time-word">in 2023</span>' +
    '</div>' +
    '</div></div>' +
    '<div class="tip-bubble"><span class="bulb">üí°</span>' +
    '<span class="tip-text"><strong>M·∫πo nh·ªõ:</strong><br>' +
    'üëâ Th·∫•y <strong>"every"</strong> ‚Üí Hi·ªán t·∫°i<br>' +
    'üëâ Th·∫•y <strong>"yesterday/last/ago"</strong> ‚Üí Qu√° kh·ª©</span></div>' +
    '</div>' +
    
    // === C√ÇU KH·∫≤NG ƒê·ªäNH ===
    '<div class="pattern-card">' +
    '<div class="pattern-title"><span class="icon">‚úÖ</span> C√¢u kh·∫≥ng ƒë·ªãnh</div>' +
    '<div style="background:#E8F5E9;padding:15px;border-radius:12px;margin-bottom:15px">' +
    '<div style="font-weight:700;color:#2E7D32;margin-bottom:10px">‚òÄÔ∏è Hi·ªán t·∫°i:</div>' +
    '<div class="example-row"><span class="emoji">üëß</span><span class="sentence">She <strong>goes</strong> to school every day.</span></div>' +
    '<div class="example-row"><span class="emoji">üë¶</span><span class="sentence">He <strong>plays</strong> football every weekend.</span></div>' +
    '<div class="example-row"><span class="emoji">üë´</span><span class="sentence">They <strong>eat</strong> breakfast every morning.</span></div>' +
    '<div style="background:white;padding:10px;border-radius:8px;margin-top:10px;font-size:0.9rem">' +
    '‚ö†Ô∏è <strong>He/She/It</strong> ‚Üí th√™m <strong>s/es</strong> (goes, plays, watches)' +
    '</div></div>' +
    '<div style="background:#FFF3E0;padding:15px;border-radius:12px">' +
    '<div style="font-weight:700;color:#E65100;margin-bottom:10px">üåô Qu√° kh·ª©:</div>' +
    '<div class="example-row"><span class="emoji">üëß</span><span class="sentence">She <span class="past">went</span> to school yesterday.</span></div>' +
    '<div class="example-row"><span class="emoji">üë¶</span><span class="sentence">He <span class="past">played</span> football last week.</span></div>' +
    '<div class="example-row"><span class="emoji">üë´</span><span class="sentence">They <span class="past">ate</span> pizza last night.</span></div>' +
    '<div style="background:white;padding:10px;border-radius:8px;margin-top:10px;font-size:0.9rem">' +
    '‚ö†Ô∏è ƒê·ªông t·ª´ ƒë·ªïi sang d·∫°ng qu√° kh·ª© (went, played, ate...)' +
    '</div></div>' +
    '</div>' +
    
    // === C√ÇU PH·ª¶ ƒê·ªäNH ===
    '<div class="pattern-card">' +
    '<div class="pattern-title"><span class="icon">üö´</span> C√¢u ph·ªß ƒë·ªãnh (Kh√¥ng l√†m g√¨)</div>' +
    '<div style="background:#E8F5E9;padding:15px;border-radius:12px;margin-bottom:15px">' +
    '<div style="font-weight:700;color:#2E7D32;margin-bottom:10px">‚òÄÔ∏è Hi·ªán t·∫°i:</div>' +
    '<div class="example-row"><span class="emoji">üëß</span><span class="sentence">She <strong>doesn\'t go</strong> to school on Sunday.</span></div>' +
    '<div class="example-row"><span class="emoji">üë¶</span><span class="sentence">He <strong>doesn\'t like</strong> vegetables.</span></div>' +
    '<div class="example-row"><span class="emoji">üë´</span><span class="sentence">They <strong>don\'t eat</strong> meat.</span></div>' +
    '<div style="background:white;padding:10px;border-radius:8px;margin-top:10px">' +
    '<div style="font-size:0.9rem;margin-bottom:5px">üìå <strong>I/You/We/They</strong> ‚Üí <span style="background:#FFCDD2;padding:2px 6px;border-radius:4px">don\'t</span> + ƒë·ªông t·ª´ g·ªëc</div>' +
    '<div style="font-size:0.9rem">üìå <strong>He/She/It</strong> ‚Üí <span style="background:#FFCDD2;padding:2px 6px;border-radius:4px">doesn\'t</span> + ƒë·ªông t·ª´ g·ªëc</div>' +
    '</div></div>' +
    '<div style="background:#FFF3E0;padding:15px;border-radius:12px">' +
    '<div style="font-weight:700;color:#E65100;margin-bottom:10px">üåô Qu√° kh·ª©:</div>' +
    '<div class="example-row"><span class="emoji">üëß</span><span class="sentence">She <span class="past">didn\'t go</span> to school yesterday.</span></div>' +
    '<div class="example-row"><span class="emoji">üë¶</span><span class="sentence">He <span class="past">didn\'t watch</span> TV last night.</span></div>' +
    '<div class="example-row"><span class="emoji">üë´</span><span class="sentence">They <span class="past">didn\'t play</span> games yesterday.</span></div>' +
    '<div style="background:white;padding:10px;border-radius:8px;margin-top:10px">' +
    '<div style="font-size:0.9rem">üìå <strong>T·∫•t c·∫£</strong> ‚Üí <span style="background:#FFCC80;padding:2px 6px;border-radius:4px">didn\'t</span> + ƒë·ªông t·ª´ <strong>G·ªêC</strong></div>' +
    '</div></div>' +
    '<div class="tip-bubble" style="background:#FFEBEE"><span class="bulb">‚ö†Ô∏è</span>' +
    '<span class="tip-text"><strong>Quan tr·ªçng:</strong> Sau don\'t / doesn\'t / didn\'t ‚Üí ƒë·ªông t·ª´ gi·ªØ nguy√™n d·∫°ng G·ªêC!<br>' +
    '‚ùå She doesn\'t <s>goes</s> ‚Üí ‚úÖ She doesn\'t <strong>go</strong><br>' +
    '‚ùå He didn\'t <s>went</s> ‚Üí ‚úÖ He didn\'t <strong>go</strong></span></div>' +
    '</div>' +
    
    // === C√ÇU H·ªéI ===
    '<div class="pattern-card">' +
    '<div class="pattern-title"><span class="icon">‚ùì</span> C√¢u h·ªèi (C√≥ l√†m kh√¥ng?)</div>' +
    '<div style="background:#E8F5E9;padding:15px;border-radius:12px;margin-bottom:15px">' +
    '<div style="font-weight:700;color:#2E7D32;margin-bottom:10px">‚òÄÔ∏è Hi·ªán t·∫°i:</div>' +
    '<div class="example-row"><span class="emoji">‚ùì</span><span class="sentence"><strong>Do you</strong> like pizza? - Yes, I do!</span></div>' +
    '<div class="example-row"><span class="emoji">‚ùì</span><span class="sentence"><strong>Does she</strong> go to school? - Yes, she does!</span></div>' +
    '<div class="example-row"><span class="emoji">‚ùì</span><span class="sentence"><strong>Do they</strong> play games? - No, they don\'t.</span></div>' +
    '<div style="background:white;padding:10px;border-radius:8px;margin-top:10px">' +
    '<div style="font-size:0.9rem;margin-bottom:5px">üìå <span style="background:#BBDEFB;padding:2px 6px;border-radius:4px">Do</span> + I/you/we/they + ƒë·ªông t·ª´ g·ªëc?</div>' +
    '<div style="font-size:0.9rem">üìå <span style="background:#BBDEFB;padding:2px 6px;border-radius:4px">Does</span> + he/she/it + ƒë·ªông t·ª´ g·ªëc?</div>' +
    '</div></div>' +
    '<div style="background:#FFF3E0;padding:15px;border-radius:12px">' +
    '<div style="font-weight:700;color:#E65100;margin-bottom:10px">üåô Qu√° kh·ª©:</div>' +
    '<div class="example-row"><span class="emoji">‚ùì</span><span class="sentence"><span class="past">Did you</span> go to school yesterday? - Yes, I did!</span></div>' +
    '<div class="example-row"><span class="emoji">‚ùì</span><span class="sentence"><span class="past">Did she</span> eat pizza? - No, she didn\'t.</span></div>' +
    '<div class="example-row"><span class="emoji">‚ùì</span><span class="sentence"><span class="past">Did they</span> watch TV? - Yes, they did!</span></div>' +
    '<div style="background:white;padding:10px;border-radius:8px;margin-top:10px">' +
    '<div style="font-size:0.9rem">üìå <span style="background:#FFCC80;padding:2px 6px;border-radius:4px">Did</span> + t·∫•t c·∫£ + ƒë·ªông t·ª´ <strong>G·ªêC</strong>?</div>' +
    '</div></div>' +
    '<div class="tip-bubble" style="background:#E3F2FD"><span class="bulb">‚ö†Ô∏è</span>' +
    '<span class="tip-text"><strong>Quan tr·ªçng:</strong> Sau Do / Does / Did ‚Üí ƒë·ªông t·ª´ gi·ªØ nguy√™n d·∫°ng G·ªêC!<br>' +
    '‚ùå Does she <s>goes</s>? ‚Üí ‚úÖ Does she <strong>go</strong>?<br>' +
    '‚ùå Did you <s>went</s>? ‚Üí ‚úÖ Did you <strong>go</strong>?</span></div>' +
    '</div>' +
    
    // === B·∫¢NG T√ìM T·∫ÆT ===
    '<div class="pattern-card">' +
    '<div class="pattern-title"><span class="icon">üìã</span> B·∫£ng t√≥m t·∫Øt</div>' +
    '<table style="width:100%;border-collapse:collapse;font-size:0.9rem">' +
    '<tr style="background:#E3F2FD"><th style="padding:10px;border:1px solid #ddd"></th><th style="padding:10px;border:1px solid #ddd">‚òÄÔ∏è Hi·ªán t·∫°i</th><th style="padding:10px;border:1px solid #ddd">üåô Qu√° kh·ª©</th></tr>' +
    '<tr><td style="padding:10px;border:1px solid #ddd;font-weight:700">D·∫•u hi·ªáu</td><td style="padding:10px;border:1px solid #ddd">every day, always</td><td style="padding:10px;border:1px solid #ddd">yesterday, last...</td></tr>' +
    '<tr style="background:#E8F5E9"><td style="padding:10px;border:1px solid #ddd;font-weight:700">‚úÖ She</td><td style="padding:10px;border:1px solid #ddd">She <strong>goes</strong></td><td style="padding:10px;border:1px solid #ddd">She <strong>went</strong></td></tr>' +
    '<tr style="background:#FFEBEE"><td style="padding:10px;border:1px solid #ddd;font-weight:700">üö´ She</td><td style="padding:10px;border:1px solid #ddd">She <strong>doesn\'t go</strong></td><td style="padding:10px;border:1px solid #ddd">She <strong>didn\'t go</strong></td></tr>' +
    '<tr style="background:#E3F2FD"><td style="padding:10px;border:1px solid #ddd;font-weight:700">‚ùì She</td><td style="padding:10px;border:1px solid #ddd"><strong>Does</strong> she <strong>go</strong>?</td><td style="padding:10px;border:1px solid #ddd"><strong>Did</strong> she <strong>go</strong>?</td></tr>' +
    '<tr style="background:#E8F5E9"><td style="padding:10px;border:1px solid #ddd;font-weight:700">‚úÖ They</td><td style="padding:10px;border:1px solid #ddd">They <strong>go</strong></td><td style="padding:10px;border:1px solid #ddd">They <strong>went</strong></td></tr>' +
    '<tr style="background:#FFEBEE"><td style="padding:10px;border:1px solid #ddd;font-weight:700">üö´ They</td><td style="padding:10px;border:1px solid #ddd">They <strong>don\'t go</strong></td><td style="padding:10px;border:1px solid #ddd">They <strong>didn\'t go</strong></td></tr>' +
    '<tr style="background:#E3F2FD"><td style="padding:10px;border:1px solid #ddd;font-weight:700">‚ùì They</td><td style="padding:10px;border:1px solid #ddd"><strong>Do</strong> they <strong>go</strong>?</td><td style="padding:10px;border:1px solid #ddd"><strong>Did</strong> they <strong>go</strong>?</td></tr>' +
    '</table>' +
    '</div>' +
    
    // === QUY T·∫ÆC V√ÄNG ===
    '<div class="pattern-card" style="background:linear-gradient(135deg,#FFF9C4,#FFECB3)">' +
    '<div class="pattern-title"><span class="icon">‚≠ê</span> QUY T·∫ÆC V√ÄNG</div>' +
    '<div style="text-align:center;padding:15px">' +
    '<p style="font-size:1.2rem;font-weight:700;color:#F57F17;margin-bottom:15px">' +
    'Sau <span style="background:#FF8A65;color:white;padding:5px 12px;border-radius:8px">don\'t / doesn\'t / didn\'t</span></p>' +
    '<p style="font-size:1.2rem;font-weight:700;color:#F57F17;margin-bottom:15px">' +
    'Sau <span style="background:#64B5F6;color:white;padding:5px 12px;border-radius:8px">Do / Does / Did</span></p>' +
    '<p style="font-size:1.5rem;font-weight:800;color:#E65100">' +
    '‚Üí ƒê·ªông t·ª´ lu√¥n ·ªü <span style="background:#FFEB3B;padding:5px 15px;border-radius:8px">D·∫†NG G·ªêC</span>!</p>' +
    '</div></div>' +
    
    '<button class="next-btn" onclick="goHome()" style="margin-top:20px">üè† V·ªÅ trang ch·ªß</button>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

// ============ TOPIC START ============
function startTopic(topic) {
  playSound('click');
  currentTopic = topic;
  
  if (topic === 'games') {
    showGameMenu();
  } else if (STORIES[topic]) {
    currentStory = Math.floor(Math.random() * STORIES[topic].length);
    currentScene = 0;
    stars = 0;
    correctAnswers = 0;
    totalQuestions = STORIES[topic][currentStory].scenes.length;
    showStory();
  }
}

// ============ STORY ============
function showStory() {
  var story = STORIES[currentTopic][currentStory];
  var scene = story.scenes[currentScene];
  
  document.getElementById('appContainer').className = 'app-container ' + story.bg;
  
  var dotsHtml = '';
  for (var i = 0; i < story.scenes.length; i++) {
    var dotClass = 'dot';
    if (i < currentScene) dotClass += ' done';
    else if (i === currentScene) dotClass += ' active';
    dotsHtml += '<div class="' + dotClass + '"></div>';
  }
  
  var html = '<div class="progress-header">' +
    '<button class="back-btn" onclick="goHome()">‚Üê Home</button>' +
    '<div class="progress-dots">' + dotsHtml + '</div>' +
    '<div class="star-count">‚≠ê ' + stars + '</div>' +
    '</div>' +
    '<div class="story-scene">' +
    '<div class="scene-image">' + scene.image + '</div>' +
    '<div class="scene-text">' + scene.text + '</div>' +
    '<div class="scene-question">' + scene.question + '</div>' +
    '<div class="choice-buttons">';
  
  scene.choices.forEach(function(choice, i) {
    html += '<button class="choice-btn" id="choice' + i + '" onclick="checkAnswer(' + i + ')">' + choice + '</button>';
  });
  
  html += '</div><div id="feedbackArea"></div></div>';
  
  document.getElementById('storyScreen').innerHTML = html;
  showScreen('storyScreen');
}

function checkAnswer(index) {
  var story = STORIES[currentTopic][currentStory];
  var scene = story.scenes[currentScene];
  var correct = index === scene.correct;
  
  // Disable all buttons
  document.querySelectorAll('.choice-btn').forEach(function(btn, i) {
    btn.disabled = true;
    if (i === scene.correct) btn.classList.add('correct');
    if (i === index && !correct) btn.classList.add('wrong');
  });
  
  if (correct) {
    addStars(1);
    correctAnswers++;
    playSound('correct');
    showConfetti();
  } else {
    playSound('wrong');
  }
  
  var feedbackHtml = '<div class="feedback-box ' + (correct ? 'correct' : 'wrong') + '">' +
    '<div class="feedback-emoji">' + (correct ? 'üéâ' : 'üí™') + '</div>' +
    '<div class="feedback-text">' + scene.feedback + '</div>' +
    '<div class="feedback-tip">' + scene.tip + '</div>' +
    '<button class="next-btn" onclick="nextScene()">' +
    (currentScene < story.scenes.length - 1 ? 'Next ‚Üí' : 'Finish! üèÜ') +
    '</button></div>';
  
  document.getElementById('feedbackArea').innerHTML = feedbackHtml;
}

function nextScene() {
  var story = STORIES[currentTopic][currentStory];
  
  if (currentScene < story.scenes.length - 1) {
    currentScene++;
    showStory();
  } else {
    showResult();
  }
}

// ============ RESULT ============
function showResult() {
  playSound('complete');
  showConfetti();
  
  var percentage = Math.round((correctAnswers / totalQuestions) * 100);
  var starCount = Math.min(3, Math.floor(percentage / 33) + (percentage > 0 ? 1 : 0));
  var starsHtml = '';
  for (var i = 0; i < 3; i++) {
    starsHtml += i < starCount ? '‚≠ê' : '‚òÜ';
  }
  
  // Bonus sao khi ho√†n th√†nh
  var bonusStars = 0;
  if (percentage >= 80) bonusStars = 5;
  else if (percentage >= 60) bonusStars = 3;
  else if (percentage >= 40) bonusStars = 2;
  else bonusStars = 1;
  addStars(bonusStars);
  
  var emoji = percentage >= 80 ? 'üèÜ' : percentage >= 50 ? 'üåü' : 'üí™';
  var title = percentage >= 80 ? 'Xu·∫•t s·∫Øc!' : percentage >= 50 ? 'T·ªët l·∫Øm!' : 'C·ªë g·∫Øng th√™m!';
  var message = percentage >= 80 ? 'Con ƒë√£ r·∫•t chƒÉm ch·ªâ! üéâ' : 
                percentage >= 50 ? 'Con ƒëang ti·∫øn b·ªô r√µ r·ªát! üëç' : 
                'Luy·ªán t·∫≠p th√™m con s·∫Ω ti·∫øn b·ªô h∆°n! üí™';
  
  document.getElementById('appContainer').className = 'app-container bg-fun';
  
  var html = '<div class="result-content"><div class="result-card">' +
    '<div class="result-emoji">' + emoji + '</div>' +
    '<div class="result-title">' + title + '</div>' +
    '<div class="result-stars">' + starsHtml + '</div>' +
    '<div style="background:linear-gradient(135deg,#FFD700,#FFA000);padding:12px;border-radius:12px;margin:10px 0;color:white;font-weight:700;text-align:center">' +
    'üéÅ Bonus: +' + bonusStars + ' sao! (T·ªïng: ' + totalStars + ' ‚≠ê)' +
    '</div>' +
    '<div style="background:#f5f5f5;padding:15px;border-radius:12px;margin:15px 0">' +
    '<div style="display:flex;justify-content:space-around;text-align:center">' +
    '<div><div style="font-size:1.5rem;font-weight:700;color:#4CAF50">' + correctAnswers + '</div><div style="font-size:0.85rem;color:#666">ƒê√∫ng ‚úì</div></div>' +
    '<div><div style="font-size:1.5rem;font-weight:700;color:#F44336">' + (totalQuestions - correctAnswers) + '</div><div style="font-size:0.85rem;color:#666">Sai ‚úó</div></div>' +
    '<div><div style="font-size:1.5rem;font-weight:700;color:#2196F3">' + percentage + '%</div><div style="font-size:0.85rem;color:#666">T·ª∑ l·ªá</div></div>' +
    '</div></div>' +
    '<div class="result-message">' + message + '</div>' +
    '<div class="result-buttons">' +
    '<button class="result-btn primary" onclick="showLevelSelect(\'' + currentTopic + '\')">Ch∆°i l·∫°i üîÑ</button>' +
    '<button class="result-btn secondary" onclick="goHome()">V·ªÅ nh√† üè†</button>' +
    '</div></div></div>';
  
  document.getElementById('resultScreen').innerHTML = html;
  showScreen('resultScreen');
}

// ============ GAME MENU ============
function showGameMenu() {
  document.getElementById('appContainer').className = 'app-container bg-fun';
  
  var html = '<div class="progress-header" style="margin-bottom:20px">' +
    '<button class="back-btn" onclick="goHome()">‚Üê Home</button>' +
    '<div style="color:white;font-weight:700;font-size:1.2rem">üéÆ Word Games</div>' +
    '<div></div></div>' +
    
    '<div class="topic-grid">' +
    '<div class="topic-card" onclick="startMatchingGame()" style="border-color:#9C27B0">' +
    '<div class="topic-icon">üéØ</div>' +
    '<div class="topic-name">Matching</div>' +
    '</div>' +
    '<div class="topic-card" onclick="startFlashcards()" style="border-color:#FF9800">' +
    '<div class="topic-icon">üé¥</div>' +
    '<div class="topic-name">Flashcards</div>' +
    '</div>' +
    '<div class="topic-card" onclick="showLearnScreen()" style="border-color:#4CAF50">' +
    '<div class="topic-icon">üìñ</div>' +
    '<div class="topic-name">Horrible List</div>' +
    '</div>' +
    '</div>' +
    
    // Visual learning section
    '<div class="pattern-card" style="margin-top:20px">' +
    '<div class="pattern-title"><span class="icon">üí°</span> Nh·ªõ nhanh!</div>' +
    '<div class="compare-box">' +
    '<div class="compare-side now">' +
    '<div class="label">‚òÄÔ∏è Hi·ªán t·∫°i</div>' +
    '<div class="time-words"><span class="time-word">every day</span><span class="time-word">always</span></div>' +
    '<div class="example">I <strong>go</strong> to school.</div>' +
    '</div>' +
    '<div class="compare-side past">' +
    '<div class="label">üåô Qu√° kh·ª©</div>' +
    '<div class="time-words"><span class="time-word">yesterday</span><span class="time-word">last week</span></div>' +
    '<div class="example">I <strong style="color:#E65100">went</strong> to school.</div>' +
    '</div></div>' +
    '<div class="tip-bubble"><span class="bulb">üí°</span>' +
    '<span class="tip-text">Th·∫•y <strong>every</strong> ‚Üí d√πng t·ª´ hi·ªán t·∫°i<br>' +
    'Th·∫•y <strong>yesterday/last</strong> ‚Üí d√πng t·ª´ qu√° kh·ª©!</span></div>' +
    '</div>';
  
  document.getElementById('gameScreen').innerHTML = html;
  showScreen('gameScreen');
}

// ============ MATCHING GAME ============
function startMatchingGame() {
  playSound('click');
  
  var words = shuffle(WORD_GAMES.matching).slice(0, 6);
  matchCards = [];
  selectedCard = null;
  matchedPairs = [];
  
  words.forEach(function(w, i) {
    matchCards.push({ id: 'now-' + i, text: w.now, type: 'now', pairId: i });
    matchCards.push({ id: 'past-' + i, text: w.past, type: 'past', pairId: i });
  });
  matchCards = shuffle(matchCards);
  
  renderMatchingGame();
}

function renderMatchingGame() {
  var html = '<div class="progress-header" style="margin-bottom:20px">' +
    '<button class="back-btn" onclick="showGameMenu()">‚Üê Back</button>' +
    '<div style="color:white;font-weight:700">üéØ Match the pairs!</div>' +
    '<div></div></div>' +
    
    '<div class="match-instruction">üü¢ Ch·ªçn t·ª´ hi·ªán t·∫°i ‚Üí üü† Ch·ªçn t·ª´ qu√° kh·ª© c·ªßa n√≥!</div>' +
    
    '<div class="match-grid">';
  
  matchCards.forEach(function(card) {
    var isSelected = selectedCard && selectedCard.id === card.id;
    var isMatched = matchedPairs.indexOf(card.pairId) >= 0;
    html += '<button class="match-card type-' + card.type + 
      (isSelected ? ' selected' : '') + 
      (isMatched ? ' matched' : '') + '" ' +
      (isMatched ? 'disabled' : 'onclick="selectMatchCard(\'' + card.id + '\')"') + '>' +
      card.text + '</button>';
  });
  
  html += '</div>' +
    '<div class="match-score">‚úÖ ' + matchedPairs.length + ' / 6</div>';
  
  if (matchedPairs.length >= 6) {
    html += '<div style="text-align:center;margin-top:20px">' +
      '<div style="font-size:50px;margin-bottom:10px">üéâ</div>' +
      '<div style="color:white;font-size:1.3rem;font-weight:700;margin-bottom:15px">Excellent!</div>' +
      '<button class="next-btn" onclick="startMatchingGame()">Play Again üîÑ</button></div>';
  }
  
  document.getElementById('gameScreen').innerHTML = html;
  showScreen('gameScreen');
}

function selectMatchCard(cardId) {
  playSound('click');
  
  var card = matchCards.find(function(c) { return c.id === cardId; });
  
  if (!selectedCard) {
    selectedCard = card;
    renderMatchingGame();
  } else {
    if (selectedCard.id === card.id) {
      selectedCard = null;
      renderMatchingGame();
      return;
    }
    
    if (selectedCard.pairId === card.pairId && selectedCard.type !== card.type) {
      matchedPairs.push(card.pairId);
      playSound('correct');
      if (matchedPairs.length >= 6) {
        playSound('complete');
        showConfetti();
      }
    } else {
      playSound('wrong');
    }
    selectedCard = null;
    renderMatchingGame();
  }
}

// ============ FLASHCARDS ============
function startFlashcards() {
  playSound('click');
  flashcardIndex = 0;
  isFlipped = false;
  renderFlashcards();
}

function renderFlashcards() {
  var words = WORD_GAMES.matching;
  var word = words[flashcardIndex];
  
  var html = '<div class="progress-header" style="margin-bottom:20px">' +
    '<button class="back-btn" onclick="showGameMenu()">‚Üê Back</button>' +
    '<div style="color:white;font-weight:700">üé¥ ' + (flashcardIndex + 1) + ' / ' + words.length + '</div>' +
    '<div></div></div>' +
    
    '<div style="color:white;text-align:center;margin-bottom:8px;font-size:1.1rem">' +
    'üëÜ Ch·∫°m th·∫ª ƒë·ªÉ l·∫≠t!</div>' +
    
    '<div style="background:rgba(255,255,255,0.2);padding:10px 15px;border-radius:12px;margin-bottom:15px;text-align:center">' +
    '<span style="font-size:1.1rem">üîä <strong style="color:#FFEB3B">ƒê·ªçc TO</strong> ƒë·ªÉ nh·ªõ l√¢u nh√© con!</span>' +
    '</div>' +
    
    '<div class="flashcard-container">' +
    '<div class="flashcard' + (isFlipped ? ' flipped' : '') + '" onclick="flipCard()">' +
    '<div class="flashcard-face flashcard-front">' +
    '<div class="flashcard-label">‚òÄÔ∏è Hi·ªán t·∫°i</div>' +
    '<div class="flashcard-word">' + word.now + '</div>' +
    '<div class="flashcard-meaning">(' + word.meaning + ')</div>' +
    '<div class="flashcard-hint" style="margin-top:10px;padding:8px 12px;background:#E8F5E9;border-radius:8px;color:#2E7D32">' +
    'üó£Ô∏è ƒê·ªçc to: "<strong>' + word.now + '</strong>"</div>' +
    '</div>' +
    '<div class="flashcard-face flashcard-back">' +
    '<div class="flashcard-label">üåô Qu√° kh·ª©</div>' +
    '<div class="flashcard-word">' + word.past + '</div>' +
    '<div class="flashcard-meaning">' + word.now + ' ‚Üí ' + word.past + '</div>' +
    '<div class="flashcard-hint" style="margin-top:10px;padding:8px 12px;background:#FFF3E0;border-radius:8px;color:#E65100">' +
    'üó£Ô∏è ƒê·ªçc to: "<strong>' + word.now + '</strong> ‚Üí <strong>' + word.past + '</strong>"</div>' +
    '</div></div></div>' +
    
    '<div class="flashcard-nav">' +
    '<button class="flashcard-btn" onclick="prevFlashcard()">‚Üê Tr∆∞·ªõc</button>' +
    '<button class="flashcard-btn" onclick="shuffleFlashcards()">üîÄ Tr·ªôn</button>' +
    '<button class="flashcard-btn" onclick="nextFlashcard()">Sau ‚Üí</button>' +
    '</div>' +
    
    '<div class="pattern-card" style="margin-top:20px">' +
    '<div style="text-align:center;margin-bottom:10px;color:#666;font-size:0.9rem">üó£Ô∏è ƒê·ªçc to c√¢u n√†y nha:</div>' +
    '<div class="example-row">' +
    '<span class="emoji">‚òÄÔ∏è</span>' +
    '<span class="sentence">I <strong>' + word.now + '</strong> every day.</span>' +
    '</div>' +
    '<div class="example-row">' +
    '<span class="emoji">üåô</span>' +
    '<span class="sentence">I <span class="past">' + word.past + '</span> yesterday.</span>' +
    '</div></div>';
  
  document.getElementById('gameScreen').innerHTML = html;
  showScreen('gameScreen');
}

function flipCard() {
  playSound('flip');
  isFlipped = !isFlipped;
  renderFlashcards();
}

function prevFlashcard() {
  isFlipped = false;
  flashcardIndex = flashcardIndex > 0 ? flashcardIndex - 1 : WORD_GAMES.matching.length - 1;
  renderFlashcards();
}

function nextFlashcard() {
  isFlipped = false;
  flashcardIndex = flashcardIndex < WORD_GAMES.matching.length - 1 ? flashcardIndex + 1 : 0;
  renderFlashcards();
}

function shuffleFlashcards() {
  WORD_GAMES.matching = shuffle(WORD_GAMES.matching);
  flashcardIndex = 0;
  isFlipped = false;
  renderFlashcards();
}

// ============ IRREGULAR VERBS DATA (t·ª´ h√¨nh ·∫£nh) ============
var IRREGULAR_VERBS = {
  groups: [
    {
      id: 'important',
      name: '1. ƒê·ªông t·ª´ quan tr·ªçng',
      pattern: 'IMPORTANT VERBS',
      color: 'pattern-important',
      tip: 'üåü ƒê√¢y l√† nh·ªØng ƒë·ªông t·ª´ d√πng NHI·ªÄU NH·∫§T! H·ªçc thu·ªôc nh√≥m n√†y tr∆∞·ªõc nh√©!',
      verbs: [
        { base: 'be', past: 'was/were', pp: 'been', vn: 'th√¨, l√†, ·ªü' },
        { base: 'do', past: 'did', pp: 'done', vn: 'l√†m' },
        { base: 'have', past: 'had', pp: 'had', vn: 'c√≥' },
        { base: 'come', past: 'came', pp: 'come', vn: 'ƒë·∫øn' },
        { base: 'get', past: 'got', pp: 'got', vn: 'ƒë∆∞·ª£c, l·∫•y' },
        { base: 'go', past: 'went', pp: 'gone', vn: 'ƒëi' },
        { base: 'make', past: 'made', pp: 'made', vn: 'l√†m, ch·∫ø t·∫°o' },
        { base: 'say', past: 'said', pp: 'said', vn: 'n√≥i' },
        { base: 'tell', past: 'told', pp: 'told', vn: 'k·ªÉ, b·∫£o' }
      ]
    },
    {
      id: 'perception',
      name: '2. Gi√°c quan',
      pattern: 'PERCEPTION VERBS',
      color: 'pattern-perception',
      tip: 'üëÄüëÇüëÉ Nh√≥m n√†y li√™n quan ƒë·∫øn c√°c gi√°c quan: nh√¨n, nghe, ng·ª≠i',
      verbs: [
        { base: 'hear', past: 'heard', pp: 'heard', vn: 'nghe' },
        { base: 'see', past: 'saw', pp: 'seen', vn: 'th·∫•y, nh√¨n' },
        { base: 'smell', past: 'smelt', pp: 'smelt', vn: 'ng·ª≠i' }
      ]
    },
    {
      id: 'nochange',
      name: '3. Kh√¥ng ƒë·ªïi',
      pattern: 'NO CHANGE',
      color: 'pattern-no-change',
      tip: 'üòé EASY! C·∫£ 3 d·∫°ng gi·ªëng h·ªát nhau - kh√¥ng c·∫ßn nh·ªõ g√¨ c·∫£!',
      verbs: [
        { base: 'cost', past: 'cost', pp: 'cost', vn: 't·ªën (ti·ªÅn)' },
        { base: 'cut', past: 'cut', pp: 'cut', vn: 'c·∫Øt' },
        { base: 'hit', past: 'hit', pp: 'hit', vn: 'ƒë√°nh, ƒë·∫≠p' },
        { base: 'hurt', past: 'hurt', pp: 'hurt', vn: 'ƒëau, l√†m ƒëau' },
        { base: 'let', past: 'let', pp: 'let', vn: 'ƒë·ªÉ, cho ph√©p' },
        { base: 'put', past: 'put', pp: 'put', vn: 'ƒë·∫∑t, ƒë·ªÉ' },
        { base: 'read', past: 'read', pp: 'read', vn: 'ƒë·ªçc (ph√°t √¢m kh√°c)' },
        { base: 'shut', past: 'shut', pp: 'shut', vn: 'ƒë√≥ng' }
      ]
    },
    {
      id: 'vowel',
      name: '4. I ‚Üí O ‚Üí E/EN',
      pattern: 'I - E / O - E / I - EN',
      color: 'pattern-vowel',
      tip: 'üî§ Quy lu·∫≠t nguy√™n √¢m: i ‚Üí o ‚Üí e/en. V√≠ d·ª•: drIve ‚Üí drOve ‚Üí drivEN',
      verbs: [
        { base: 'bite', past: 'bit', pp: 'bitten', vn: 'c·∫Øn' },
        { base: 'break', past: 'broke', pp: 'broken', vn: 'v·ª°, b·∫ª g√£y' },
        { base: 'choose', past: 'chose', pp: 'chosen', vn: 'ch·ªçn' },
        { base: 'drive', past: 'drove', pp: 'driven', vn: 'l√°i xe' },
        { base: 'eat', past: 'ate', pp: 'eaten', vn: 'ƒÉn' },
        { base: 'fall', past: 'fell', pp: 'fallen', vn: 'ng√£, r∆°i' },
        { base: 'give', past: 'gave', pp: 'given', vn: 'cho, t·∫∑ng' },
        { base: 'forget', past: 'forgot', pp: 'forgotten', vn: 'qu√™n' },
        { base: 'forgive', past: 'forgave', pp: 'forgiven', vn: 'tha th·ª©' },
        { base: 'freeze', past: 'froze', pp: 'frozen', vn: 'ƒë√¥ng ƒë√°' },
        { base: 'hide', past: 'hid', pp: 'hidden', vn: 'gi·∫•u, tr·ªën' },
        { base: 'ride', past: 'rode', pp: 'ridden', vn: 'c∆∞·ª°i, ƒëi (xe)' },
        { base: 'rise', past: 'rose', pp: 'risen', vn: 'm·ªçc, n·ªïi l√™n' },
        { base: 'shake', past: 'shook', pp: 'shaken', vn: 'l·∫Øc' },
        { base: 'speak', past: 'spoke', pp: 'spoken', vn: 'n√≥i' },
        { base: 'steal', past: 'stole', pp: 'stolen', vn: 'ƒÉn c·∫Øp' },
        { base: 'take', past: 'took', pp: 'taken', vn: 'l·∫•y, mang' },
        { base: 'wake', past: 'woke', pp: 'woken', vn: 'th·ª©c d·∫≠y' },
        { base: 'write', past: 'wrote', pp: 'written', vn: 'vi·∫øt' }
      ]
    },
    {
      id: 'drink',
      name: '5. I ‚Üí U*-A ‚Üí U',
      pattern: 'I / U* - A / U',
      color: 'pattern-drink',
      tip: 'üéµ Nh·ªõ theo nh·ªãp: drINK ‚Üí drANK ‚Üí drUNK. V·∫ßn nh∆∞ b√†i h√°t!',
      verbs: [
        { base: 'begin', past: 'began', pp: 'begun', vn: 'b·∫Øt ƒë·∫ßu' },
        { base: 'drink', past: 'drank', pp: 'drunk', vn: 'u·ªëng' },
        { base: 'ring', past: 'rang', pp: 'rung', vn: 'reo, rung chu√¥ng' },
        { base: 'sing', past: 'sang', pp: 'sung', vn: 'h√°t' },
        { base: 'swim', past: 'swam', pp: 'swum', vn: 'b∆°i' },
        { base: 'swing', past: 'swung', pp: 'swung', vn: 'ƒëung ƒë∆∞a' }
      ]
    },
    {
      id: 'owewown',
      name: '6. OW ‚Üí EW ‚Üí OWN',
      pattern: 'AW - OW / EW / OWN',
      color: 'pattern-ow-ew',
      tip: 'üí® Quy lu·∫≠t: OW ‚Üí EW ‚Üí OWN. V√≠ d·ª•: blOW ‚Üí blEW ‚Üí blOWN',
      verbs: [
        { base: 'blow', past: 'blew', pp: 'blown', vn: 'th·ªïi' },
        { base: 'draw', past: 'drew', pp: 'drawn', vn: 'v·∫Ω' },
        { base: 'fly', past: 'flew', pp: 'flown', vn: 'bay' },
        { base: 'grow', past: 'grew', pp: 'grown', vn: 'l·ªõn l√™n, tr·ªìng' },
        { base: 'know', past: 'knew', pp: 'known', vn: 'bi·∫øt' },
        { base: 'throw', past: 'threw', pp: 'thrown', vn: 'n√©m' }
      ]
    },
    {
      id: 'ought',
      name: '7. -AUGHT / -OUGHT',
      pattern: '-AUGHT / -OUGHT',
      color: 'pattern-ought',
      tip: 'üéØ K·∫øt th√∫c b·∫±ng -OUGHT ho·∫∑c -AUGHT. Ph√°t √¢m: /…îÀêt/',
      verbs: [
        { base: 'bring', past: 'brought', pp: 'brought', vn: 'mang ƒë·∫øn' },
        { base: 'buy', past: 'bought', pp: 'bought', vn: 'mua' },
        { base: 'catch', past: 'caught', pp: 'caught', vn: 'b·∫Øt' },
        { base: 'fight', past: 'fought', pp: 'fought', vn: 'chi·∫øn ƒë·∫•u' },
        { base: 'teach', past: 'taught', pp: 'taught', vn: 'd·∫°y' },
        { base: 'think', past: 'thought', pp: 'thought', vn: 'nghƒ©' }
      ]
    },
    {
      id: 'stand',
      name: '8. -STAND ‚Üí -STOOD',
      pattern: '-STAND / -STOOD / -STOOD',
      color: 'pattern-stand',
      tip: 'üßç Li√™n quan ƒë·∫øn ƒê·ª®NG: stand ‚Üí stood ‚Üí stood',
      verbs: [
        { base: 'stand', past: 'stood', pp: 'stood', vn: 'ƒë·ª©ng' },
        { base: 'understand', past: 'understood', pp: 'understood', vn: 'hi·ªÉu' }
      ]
    },
    {
      id: 'ee',
      name: '9. -EE- ‚Üí -E- ‚Üí -E-',
      pattern: '-EE- / -E- / -E-',
      color: 'pattern-ee',
      tip: 'üìñ Nguy√™n √¢m EE r√∫t ng·∫Øn th√†nh E. V√≠ d·ª•: fEEd ‚Üí fEd ‚Üí fEd',
      verbs: [
        { base: 'bleed', past: 'bled', pp: 'bled', vn: 'ch·∫£y m√°u' },
        { base: 'feed', past: 'fed', pp: 'fed', vn: 'cho ƒÉn' },
        { base: 'feel', past: 'felt', pp: 'felt', vn: 'c·∫£m th·∫•y' },
        { base: 'keep', past: 'kept', pp: 'kept', vn: 'gi·ªØ' },
        { base: 'meet', past: 'met', pp: 'met', vn: 'g·∫∑p' },
        { base: 'sleep', past: 'slept', pp: 'slept', vn: 'ng·ªß' },
        { base: 'sweep', past: 'swept', pp: 'swept', vn: 'qu√©t' }
      ]
    },
    {
      id: 'dt',
      name: '10. -D ‚Üí -T ‚Üí -T',
      pattern: '-D / -T / -T',
      color: 'pattern-d-t',
      tip: 'üîÑ ƒê·ªïi D th√†nh T. V√≠ d·ª•: senD ‚Üí senT ‚Üí senT',
      verbs: [
        { base: 'build', past: 'built', pp: 'built', vn: 'x√¢y d·ª±ng' },
        { base: 'lend', past: 'lent', pp: 'lent', vn: 'cho m∆∞·ª£n' },
        { base: 'send', past: 'sent', pp: 'sent', vn: 'g·ª≠i' },
        { base: 'spend', past: 'spent', pp: 'spent', vn: 'ti√™u (ti·ªÅn/th·ªùi gian)' }
      ]
    },
    {
      id: 't',
      name: '11. K·∫øt th√∫c -T',
      pattern: '-T / -T',
      color: 'pattern-t',
      tip: '‚ú® Past v√† PP ƒë·ªÅu k·∫øt th√∫c b·∫±ng -T',
      verbs: [
        { base: 'burn', past: 'burnt', pp: 'burnt', vn: 'ch√°y, ƒë·ªët' },
        { base: 'dream', past: 'dreamt', pp: 'dreamt', vn: 'm∆°' },
        { base: 'learn', past: 'learnt', pp: 'learnt', vn: 'h·ªçc' },
        { base: 'leave', past: 'left', pp: 'left', vn: 'r·ªùi ƒëi' },
        { base: 'light', past: 'lit', pp: 'lit', vn: 'th·∫Øp s√°ng' },
        { base: 'lose', past: 'lost', pp: 'lost', vn: 'm·∫•t, thua' },
        { base: 'mean', past: 'meant', pp: 'meant', vn: 'c√≥ nghƒ©a' },
        { base: 'shoot', past: 'shot', pp: 'shot', vn: 'b·∫Øn' },
        { base: 'sit', past: 'sat', pp: 'sat', vn: 'ng·ªìi' },
        { base: 'spell', past: 'spelt', pp: 'spelt', vn: 'ƒë√°nh v·∫ßn' }
      ]
    },
    {
      id: 'misc',
      name: '12. H·ªón h·ª£p',
      pattern: 'MISCELLANEOUS',
      color: 'pattern-misc',
      tip: 'üé≤ Nh√≥m ƒë·∫∑c bi·ªát - c·∫ßn nh·ªõ ri√™ng t·ª´ng t·ª´!',
      verbs: [
        { base: 'become', past: 'became', pp: 'become', vn: 'tr·ªü th√†nh' },
        { base: 'find', past: 'found', pp: 'found', vn: 't√¨m th·∫•y' },
        { base: 'hang', past: 'hung', pp: 'hung', vn: 'treo' },
        { base: 'hold', past: 'held', pp: 'held', vn: 'c·∫ßm, gi·ªØ' },
        { base: 'lay', past: 'laid', pp: 'laid', vn: 'ƒë·∫∑t, ƒë·ªÉ' },
        { base: 'lie', past: 'lay', pp: 'lain', vn: 'n·∫±m' },
        { base: 'pay', past: 'paid', pp: 'paid', vn: 'tr·∫£ ti·ªÅn' },
        { base: 'run', past: 'ran', pp: 'run', vn: 'ch·∫°y' },
        { base: 'sell', past: 'sold', pp: 'sold', vn: 'b√°n' },
        { base: 'shine', past: 'shone', pp: 'shone', vn: 'chi·∫øu s√°ng' },
        { base: 'show', past: 'showed', pp: 'shown', vn: 'cho xem' },
        { base: 'wear', past: 'wore', pp: 'worn', vn: 'm·∫∑c' },
        { base: 'win', past: 'won', pp: 'won', vn: 'th·∫Øng' }
      ]
    }
  ]
};

// Study state
var currentStudyGroup = 'all';
var expandedGroups = ['important'];
var studyQuizState = {
  active: false,
  verbs: [],
  currentIndex: 0,
  score: 0,
  answers: [],
  mode: 'past' // 'past' or 'pp'
};
var speedGameState = {
  active: false,
  timer: 30,
  score: 0,
  currentVerb: null,
  intervalId: null
};

// ============ STUDY SCREEN ============
function showLearnScreen() {
  playSound('click');
  
  // Hi·ªÉn th·ªã s·ªë c√¢u sai h√¥m nay
  var mistakeCount = todayMistakes.length;
  var mistakeBadge = mistakeCount > 0 ? 
    '<span style="background:#F44336;color:white;border-radius:50%;padding:2px 8px;font-size:0.8rem;margin-left:5px">' + mistakeCount + '</span>' : '';
  
  var html = '<div class="progress-header" style="margin-bottom:10px">' +
    '<button class="back-btn" onclick="goHome()">‚Üê Home</button>' +
    '<div style="color:white;font-weight:700;font-size:1.1rem">üìö H·ªçc T·∫≠p</div>' +
    '<div></div></div>' +
    
    '<div class="study-header">' +
    '<div class="study-title">üìñ Horrible List</div>' +
    '<div class="study-subtitle">Danh s√°ch ƒë·ªông t·ª´ b·∫•t quy t·∫Øc</div>' +
    '</div>' +
    
    '<div class="study-tip-box">' +
    '<div class="study-tip-icon">üí°</div>' +
    '<div class="study-tip-text">' +
    '<strong>M·∫πo h·ªçc nhanh:</strong> H·ªçc theo nh√≥m c√≥ quy lu·∫≠t gi·ªëng nhau s·∫Ω d·ªÖ nh·ªõ h∆°n! ' +
    'B·∫Øt ƒë·∫ßu v·ªõi nh√≥m <strong>"Kh√¥ng ƒë·ªïi"</strong> v√¨ c·∫£ 3 d·∫°ng gi·ªëng nhau.' +
    '</div></div>' +
    
    // Study modes - TH√äM N√öT √îN T·∫¨P C√ÇU SAI
    '<div class="study-modes">' +
    '<button class="study-mode-btn" onclick="showTodayMistakes()" style="background:' + (mistakeCount > 0 ? '#FFEBEE' : '#F5F5F5') + ';color:' + (mistakeCount > 0 ? '#C62828' : '#999') + '">' +
    '<span class="icon">üîÑ</span>' +
    '<span>√în c√¢u sai' + mistakeBadge + '</span>' +
    '</button>' +
    '<button class="study-mode-btn" onclick="showContextLearn()" style="background:#FCE4EC;color:#C2185B">' +
    '<span class="icon">üìö</span>' +
    '<span>Ng·ªØ c·∫£nh</span>' +
    '</button>' +
    '<button class="study-mode-btn" onclick="startEasyMatch()" style="background:#E8F5E9;color:#2E7D32">' +
    '<span class="icon">üéØ</span>' +
    '<span>Easy Match</span>' +
    '</button>' +
    '<button class="study-mode-btn" onclick="startTripleMatch()" style="background:#E3F2FD;color:#1565C0">' +
    '<span class="icon">üîó</span>' +
    '<span>Triple Match</span>' +
    '</button>' +
    '</div>' +
    
    // Group selector
    '<div class="group-selector">' +
    '<button class="group-btn' + (currentStudyGroup === 'all' ? ' active' : '') + '" onclick="filterStudyGroup(\'all\')">T·∫•t c·∫£</button>';
  
  IRREGULAR_VERBS.groups.forEach(function(group) {
    html += '<button class="group-btn' + (currentStudyGroup === group.id ? ' active' : '') + '" onclick="filterStudyGroup(\'' + group.id + '\')">' + 
      group.name.split('.')[0] + '.' + group.pattern.substring(0, 8) + '</button>';
  });
  
  html += '</div>';
  
  // Verb groups
  var groupsToShow = currentStudyGroup === 'all' ? IRREGULAR_VERBS.groups : 
    IRREGULAR_VERBS.groups.filter(function(g) { return g.id === currentStudyGroup; });
  
  groupsToShow.forEach(function(group) {
    var isExpanded = expandedGroups.indexOf(group.id) >= 0;
    html += '<div class="verb-group-card">' +
      '<div class="verb-group-header ' + group.color + (isExpanded ? ' expanded' : '') + '" onclick="toggleVerbGroup(\'' + group.id + '\')">' +
      '<div class="verb-group-title">' +
      '<span>' + group.name + '</span>' +
      '<span class="verb-group-count">' + group.verbs.length + ' t·ª´</span>' +
      '</div>' +
      '<span class="verb-group-arrow' + (isExpanded ? ' rotated' : '') + '">‚ñº</span>' +
      '</div>' +
      '<div class="verb-group-content' + (isExpanded ? ' expanded' : '') + '">' +
      '<div class="study-tip-box" style="margin:15px;background:linear-gradient(135deg,#E3F2FD,#BBDEFB)">' +
      '<div class="study-tip-icon">üí°</div>' +
      '<div class="study-tip-text">' + group.tip + '</div>' +
      '</div>' +
      '<table class="verb-table">' +
      '<tr><th>Infinitive</th><th>Simple Past</th><th>Past Participle</th><th>Nghƒ©a üáªüá≥</th></tr>';
    
    group.verbs.forEach(function(verb) {
      html += '<tr>' +
        '<td>' + verb.base + '</td>' +
        '<td>' + verb.past + '</td>' +
        '<td>' + verb.pp + '</td>' +
        '<td>' + verb.vn + '</td>' +
        '</tr>';
    });
    
    html += '</table></div></div>';
  });
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function toggleVerbGroup(groupId) {
  playSound('click');
  var index = expandedGroups.indexOf(groupId);
  if (index >= 0) {
    expandedGroups.splice(index, 1);
  } else {
    expandedGroups.push(groupId);
  }
  showLearnScreen();
}

function filterStudyGroup(groupId) {
  playSound('click');
  currentStudyGroup = groupId;
  if (groupId !== 'all') {
    expandedGroups = [groupId];
  }
  showLearnScreen();
}

// ============ STUDY QUIZ ============
function startStudyQuiz(mode) {
  playSound('click');
  
  // Collect all verbs
  var allVerbs = [];
  IRREGULAR_VERBS.groups.forEach(function(group) {
    group.verbs.forEach(function(verb) {
      allVerbs.push(verb);
    });
  });
  
  studyQuizState = {
    active: true,
    verbs: shuffle(allVerbs).slice(0, 10),
    currentIndex: 0,
    score: 0,
    answers: [],
    mode: mode
  };
  
  renderStudyQuiz();
}

function renderStudyQuiz() {
  var state = studyQuizState;
  if (state.currentIndex >= state.verbs.length) {
    showStudyQuizResult();
    return;
  }
  
  var verb = state.verbs[state.currentIndex];
  var questionText = state.mode === 'past' ? 'D·∫°ng QU√Å KH·ª® c·ªßa:' : 'D·∫°ng PAST PARTICIPLE c·ªßa:';
  var answer = state.mode === 'past' ? verb.past : verb.pp;
  
  var dotsHtml = '';
  for (var i = 0; i < state.verbs.length; i++) {
    var dotClass = 'quiz-dot';
    if (i < state.currentIndex) {
      dotClass += state.answers[i] ? ' done' : ' wrong-dot';
    } else if (i === state.currentIndex) {
      dotClass += ' current';
    }
    dotsHtml += '<div class="' + dotClass + '"></div>';
  }
  
  var html = '<div class="quiz-overlay" onclick="closeStudyQuiz(event)">' +
    '<div class="quiz-modal" onclick="event.stopPropagation()">' +
    '<div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:15px">' +
    '<button class="back-btn" onclick="closeStudyQuiz()" style="padding:8px 15px">‚úï</button>' +
    '<div style="font-weight:700;color:#666">' + (state.currentIndex + 1) + ' / ' + state.verbs.length + '</div>' +
    '<div style="font-weight:700;color:#4CAF50">‚≠ê ' + state.score + '</div>' +
    '</div>' +
    '<div class="quiz-question">' + questionText + '</div>' +
    '<div class="quiz-verb">' + verb.base + '</div>' +
    '<div style="color:#666;margin-bottom:15px">(' + verb.vn + ')</div>' +
    '<input type="text" class="quiz-input" id="quizInput" placeholder="Nh·∫≠p c√¢u tr·∫£ l·ªùi..." autocomplete="off" onkeypress="if(event.key===\'Enter\')checkStudyQuizAnswer()">' +
    '<div class="quiz-hint">üí° G√µ v√† nh·∫•n Enter</div>' +
    '<div id="quizFeedback"></div>' +
    '<div class="quiz-progress">' + dotsHtml + '</div>' +
    '</div></div>';
  
  document.getElementById('learnScreen').innerHTML += '<div id="quizOverlay">' + html + '</div>';
  setTimeout(function() {
    var input = document.getElementById('quizInput');
    if (input) input.focus();
  }, 100);
}

function checkStudyQuizAnswer() {
  var input = document.getElementById('quizInput');
  var userAnswer = input.value.trim().toLowerCase();
  var verb = studyQuizState.verbs[studyQuizState.currentIndex];
  var correctAnswer = studyQuizState.mode === 'past' ? verb.past : verb.pp;
  
  // Handle multiple correct answers (e.g., "was/were")
  var correctAnswers = correctAnswer.toLowerCase().split('/').map(function(a) { return a.trim(); });
  var isCorrect = correctAnswers.indexOf(userAnswer) >= 0;
  
  studyQuizState.answers.push(isCorrect);
  
  if (isCorrect) {
    studyQuizState.score++;
    input.classList.add('correct');
    playSound('correct');
  } else {
    input.classList.add('wrong');
    playSound('wrong');
    // TRACK C√ÇU SAI
    addMistake({
      verb: verb.base,
      verbVn: verb.vn,
      correctAnswer: correctAnswer,
      userAnswer: userAnswer,
      quizType: 'verb_form',
      mode: studyQuizState.mode // past ho·∫∑c pp
    });
  }
  
  var feedback = '<div style="margin-top:15px;padding:15px;border-radius:12px;' + 
    (isCorrect ? 'background:#E8F5E9' : 'background:#FFEBEE') + '">' +
    '<div style="font-size:2rem;margin-bottom:8px">' + (isCorrect ? 'üéâ' : 'üí™') + '</div>' +
    '<div style="font-weight:700;color:' + (isCorrect ? '#2E7D32' : '#C62828') + '">' +
    (isCorrect ? 'Ch√≠nh x√°c!' : 'ƒê√°p √°n: ' + correctAnswer) + '</div>' +
    '</div>';
  
  document.getElementById('quizFeedback').innerHTML = feedback;
  input.disabled = true;
  
  setTimeout(function() {
    studyQuizState.currentIndex++;
    document.getElementById('quizOverlay').remove();
    if (studyQuizState.currentIndex < studyQuizState.verbs.length) {
      renderStudyQuiz();
    } else {
      showStudyQuizResult();
    }
  }, 1500);
}

function showStudyQuizResult() {
  var state = studyQuizState;
  var percentage = Math.round((state.score / state.verbs.length) * 100);
  var emoji = percentage >= 80 ? 'üèÜ' : percentage >= 60 ? '‚≠ê' : percentage >= 40 ? 'üí™' : 'üìö';
  var message = percentage >= 80 ? 'Tuy·ªát v·ªùi! Con ƒë√£ r·∫•t c·ªë g·∫Øng!' : 
                percentage >= 60 ? 'T·ªët l·∫Øm! Con ƒëang ti·∫øn b·ªô!' :
                percentage >= 40 ? 'C·ªë l√™n! √în th√™m nh√© con!' : 'C·∫ßn √¥n l·∫°i nhi·ªÅu h∆°n nha!';
  
  playSound('complete');
  showConfetti();
  
  var html = '<div class="quiz-overlay">' +
    '<div class="quiz-modal">' +
    '<div style="font-size:80px;margin-bottom:15px">' + emoji + '</div>' +
    '<div style="font-size:1.5rem;font-weight:800;color:#333;margin-bottom:10px">' + message + '</div>' +
    '<div style="font-size:3rem;font-weight:800;color:#667eea;margin:20px 0">' + state.score + '/' + state.verbs.length + '</div>' +
    '<div style="font-size:1.1rem;color:#666;margin-bottom:25px">' + percentage + '% ch√≠nh x√°c</div>' +
    '<button class="next-btn" onclick="closeStudyQuiz();startStudyQuiz(\'' + state.mode + '\')">Ch∆°i l·∫°i üîÑ</button>' +
    '<button class="next-btn" style="margin-top:10px;background:#F5F5F5;color:#333" onclick="closeStudyQuiz();showLearnScreen()">V·ªÅ h·ªçc t·∫≠p üìö</button>' +
    '</div></div>';
  
  document.getElementById('learnScreen').innerHTML += '<div id="quizOverlay">' + html + '</div>';
}

function closeStudyQuiz(event) {
  if (event && event.target.className !== 'quiz-overlay') return;
  var overlay = document.getElementById('quizOverlay');
  if (overlay) overlay.remove();
  studyQuizState.active = false;
}

// ============ SPEED CHALLENGE ============
function startSpeedChallenge() {
  playSound('click');
  
  var allVerbs = [];
  IRREGULAR_VERBS.groups.forEach(function(group) {
    group.verbs.forEach(function(verb) {
      allVerbs.push(verb);
    });
  });
  
  speedGameState = {
    active: true,
    timer: 30,
    score: 0,
    verbs: shuffle(allVerbs),
    currentIndex: 0
  };
  
  renderSpeedGame();
  
  speedGameState.intervalId = setInterval(function() {
    speedGameState.timer--;
    updateSpeedTimer();
    if (speedGameState.timer <= 0) {
      endSpeedGame();
    }
  }, 1000);
}

function renderSpeedGame() {
  var state = speedGameState;
  var verb = state.verbs[state.currentIndex % state.verbs.length];
  
  var timerClass = 'speed-timer';
  if (state.timer <= 10) timerClass += ' warning';
  if (state.timer <= 5) timerClass += ' danger';
  
  var html = '<div class="progress-header" style="margin-bottom:10px">' +
    '<button class="back-btn" onclick="endSpeedGame()">‚Üê Tho√°t</button>' +
    '<div style="color:white;font-weight:700">‚ö° Th·ª≠ th√°ch t·ªëc ƒë·ªô</div>' +
    '<div></div></div>' +
    
    '<div class="' + timerClass + '" id="speedTimer">' + state.timer + '</div>' +
    '<div class="speed-score">üåü ƒêi·ªÉm: ' + state.score + '</div>' +
    
    '<div class="quiz-modal" style="margin:0 auto">' +
    '<div class="quiz-question">D·∫°ng QU√Å KH·ª® c·ªßa:</div>' +
    '<div class="quiz-verb">' + verb.base + '</div>' +
    '<div style="color:#666;margin-bottom:15px">(' + verb.vn + ')</div>' +
    '<input type="text" class="quiz-input" id="speedInput" placeholder="G√µ nhanh!" autocomplete="off" onkeypress="if(event.key===\'Enter\')checkSpeedAnswer()">' +
    '<div id="speedFeedback"></div>' +
    '</div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  setTimeout(function() {
    var input = document.getElementById('speedInput');
    if (input) input.focus();
  }, 50);
}

function updateSpeedTimer() {
  var timerEl = document.getElementById('speedTimer');
  if (timerEl) {
    timerEl.textContent = speedGameState.timer;
    timerEl.className = 'speed-timer';
    if (speedGameState.timer <= 10) timerEl.className += ' warning';
    if (speedGameState.timer <= 5) timerEl.className += ' danger';
  }
}

function checkSpeedAnswer() {
  var input = document.getElementById('speedInput');
  var userAnswer = input.value.trim().toLowerCase();
  var verb = speedGameState.verbs[speedGameState.currentIndex % speedGameState.verbs.length];
  var correctAnswers = verb.past.toLowerCase().split('/').map(function(a) { return a.trim(); });
  
  if (correctAnswers.indexOf(userAnswer) >= 0) {
    speedGameState.score++;
    playSound('correct');
  } else {
    playSound('wrong');
  }
  
  speedGameState.currentIndex++;
  renderSpeedGame();
}

function endSpeedGame() {
  if (speedGameState.intervalId) {
    clearInterval(speedGameState.intervalId);
  }
  
  var score = speedGameState.score;
  var emoji = score >= 15 ? 'üèÜ' : score >= 10 ? '‚≠ê' : score >= 5 ? 'üí™' : 'üìö';
  var message = score >= 15 ? 'Si√™u t·ªëc ƒë·ªô!' : score >= 10 ? 'T·ªët l·∫Øm!' : score >= 5 ? 'C·ªë l√™n!' : 'Luy·ªán th√™m nh√©!';
  
  playSound('complete');
  if (score >= 10) showConfetti();
  
  var html = '<div class="result-content">' +
    '<div class="result-card">' +
    '<div class="result-emoji">' + emoji + '</div>' +
    '<div class="result-title">' + message + '</div>' +
    '<div style="font-size:3rem;font-weight:800;color:#667eea;margin:20px 0">üåü ' + score + '</div>' +
    '<div class="result-message">trong 30 gi√¢y</div>' +
    '<div class="result-buttons">' +
    '<button class="result-btn primary" onclick="startSpeedChallenge()">Ch∆°i l·∫°i ‚ö°</button>' +
    '<button class="result-btn secondary" onclick="showLearnScreen()">V·ªÅ h·ªçc t·∫≠p üìö</button>' +
    '</div></div></div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
  speedGameState.active = false;
}

// ============ MEMORY GAME ============
var memoryGameState = {
  cards: [],
  flipped: [],
  matched: [],
  moves: 0
};

function startVerbMemory() {
  playSound('click');
  
  var allVerbs = [];
  IRREGULAR_VERBS.groups.forEach(function(group) {
    group.verbs.forEach(function(verb) {
      allVerbs.push(verb);
    });
  });
  
  var selectedVerbs = shuffle(allVerbs).slice(0, 6);
  var cards = [];
  
  selectedVerbs.forEach(function(verb, i) {
    cards.push({ id: 'base-' + i, text: verb.base, pairId: i, type: 'base' });
    cards.push({ id: 'past-' + i, text: verb.past, pairId: i, type: 'past' });
  });
  
  memoryGameState = {
    cards: shuffle(cards),
    flipped: [],
    matched: [],
    moves: 0
  };
  
  renderMemoryGame();
}

function renderMemoryGame() {
  var state = memoryGameState;
  
  var html = '<div class="progress-header" style="margin-bottom:15px">' +
    '<button class="back-btn" onclick="showLearnScreen()">‚Üê Back</button>' +
    '<div style="color:white;font-weight:700">üß† Memory Game</div>' +
    '<div style="color:white;font-weight:700">L∆∞·ª£t: ' + state.moves + '</div>' +
    '</div>' +
    
    '<div style="text-align:center;color:white;margin-bottom:15px">' +
    'üü¢ Gh√©p t·ª´ g·ªëc v·ªõi d·∫°ng qu√° kh·ª©!' +
    '</div>' +
    
    '<div class="memory-grid">';
  
  state.cards.forEach(function(card, index) {
    var isFlipped = state.flipped.indexOf(index) >= 0;
    var isMatched = state.matched.indexOf(card.pairId) >= 0;
    
    var cardClass = 'memory-card';
    if (isFlipped || isMatched) cardClass += ' flipped';
    if (isMatched) cardClass += ' matched';
    
    html += '<button class="' + cardClass + '" ' +
      (isMatched ? 'disabled' : 'onclick="flipMemoryCard(' + index + ')"') + '>' +
      (isFlipped || isMatched ? card.text : '‚ùì') +
      '</button>';
  });
  
  html += '</div>';
  
  if (state.matched.length >= 6) {
    html += '<div style="text-align:center;margin-top:25px">' +
      '<div style="font-size:60px;margin-bottom:15px">üéâ</div>' +
      '<div style="color:white;font-size:1.5rem;font-weight:700;margin-bottom:10px">Ho√†n th√†nh!</div>' +
      '<div style="color:rgba(255,255,255,0.8);margin-bottom:20px">S·ªë l∆∞·ª£t: ' + state.moves + '</div>' +
      '<button class="next-btn" onclick="startVerbMemory()">Ch∆°i l·∫°i üîÑ</button>' +
      '</div>';
  }
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function flipMemoryCard(index) {
  var state = memoryGameState;
  
  if (state.flipped.length >= 2) return;
  if (state.flipped.indexOf(index) >= 0) return;
  if (state.matched.indexOf(state.cards[index].pairId) >= 0) return;
  
  playSound('flip');
  state.flipped.push(index);
  renderMemoryGame();
  
  if (state.flipped.length === 2) {
    state.moves++;
    var card1 = state.cards[state.flipped[0]];
    var card2 = state.cards[state.flipped[1]];
    
    if (card1.pairId === card2.pairId && card1.type !== card2.type) {
      // Match!
      setTimeout(function() {
        playSound('correct');
        state.matched.push(card1.pairId);
        state.flipped = [];
        renderMemoryGame();
        if (state.matched.length >= 6) {
          playSound('complete');
          showConfetti();
        }
      }, 500);
    } else {
      // No match
      setTimeout(function() {
        playSound('wrong');
        state.flipped = [];
        renderMemoryGame();
      }, 1000);
    }
  }
}

// ============ EASY MATCH GAME ============
var easyMatchState = {
  verbs: [],
  baseCards: [],
  pastCards: [],
  selectedBase: null,
  matched: [],
  level: 4
};

function startEasyMatch() {
  playSound('click');
  
  // Show level selection
  var html = '<div class="progress-header" style="margin-bottom:15px">' +
    '<button class="back-btn" onclick="showLearnScreen()">‚Üê Back</button>' +
    '<div style="color:white;font-weight:700;font-size:1.1rem">üéØ Easy Match</div>' +
    '<div></div></div>' +
    
    '<div class="easy-match-container">' +
    '<div class="easy-match-header">' +
    '<div style="font-size:50px;margin-bottom:10px">üéØ</div>' +
    '<div class="easy-match-title">Easy Match</div>' +
    '<div class="easy-match-hint">Gh√©p t·ª´ g·ªëc v·ªõi t·ª´ qu√° kh·ª©</div>' +
    '</div>' +
    
    '<div class="easy-match-level-select">' +
    '<div class="easy-match-level easy" onclick="startEasyMatchGame(5)">' +
    '<div class="level-icon">üå±</div>' +
    '<div class="level-info">' +
    '<div class="level-name">5 t·ª´</div>' +
    '<div class="level-desc">Kh·ªüi ƒë·ªông</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level" style="border-color:#8BC34A" onclick="startEasyMatchGame(10)">' +
    '<div class="level-icon">üåø</div>' +
    '<div class="level-info">' +
    '<div class="level-name">10 t·ª´</div>' +
    '<div class="level-desc">C∆° b·∫£n</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level medium" onclick="startEasyMatchGame(15)">' +
    '<div class="level-icon">üå≥</div>' +
    '<div class="level-info">' +
    '<div class="level-name">15 t·ª´</div>' +
    '<div class="level-desc">Trung b√¨nh</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level" style="border-color:#FF9800" onclick="startEasyMatchGame(20)">' +
    '<div class="level-icon">üî•</div>' +
    '<div class="level-info">' +
    '<div class="level-name">20 t·ª´</div>' +
    '<div class="level-desc">N√¢ng cao</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level hard" onclick="startEasyMatchGame(25)">' +
    '<div class="level-icon">üí™</div>' +
    '<div class="level-info">' +
    '<div class="level-name">25 t·ª´</div>' +
    '<div class="level-desc">Th·ª≠ th√°ch</div>' +
    '</div></div>' +
    '</div></div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function startEasyMatchGame(level) {
  playSound('click');
  
  // Collect all verbs
  var allVerbs = [];
  IRREGULAR_VERBS.groups.forEach(function(group) {
    group.verbs.forEach(function(verb) {
      // Only use verbs where past is different from base
      if (verb.base !== verb.past) {
        allVerbs.push(verb);
      }
    });
  });
  
  var selectedVerbs = shuffle(allVerbs).slice(0, level);
  
  easyMatchState = {
    verbs: selectedVerbs,
    baseCards: shuffle(selectedVerbs.map(function(v, i) { return { verb: v, index: i }; })),
    pastCards: shuffle(selectedVerbs.map(function(v, i) { return { verb: v, index: i }; })),
    selectedBase: null,
    matched: [],
    level: level,
    showMeaning: level <= 6
  };
  
  renderEasyMatch();
}

function renderEasyMatch() {
  var state = easyMatchState;
  
  var html = '<div class="progress-header" style="margin-bottom:15px">' +
    '<button class="back-btn" onclick="startEasyMatch()">‚Üê Back</button>' +
    '<div style="color:white;font-weight:700">üéØ Easy Match</div>' +
    '<div style="color:white;font-weight:700">‚úì ' + state.matched.length + '/' + state.level + '</div>' +
    '</div>' +
    
    '<div style="text-align:center;color:white;margin-bottom:10px;padding:10px 15px;background:rgba(255,255,255,0.15);border-radius:12px">' +
    '<span style="font-size:1.1rem">' +
    (state.selectedBase === null ? 'üëÜ Ch·ªçn t·ª´ <strong style="color:#A5D6A7">G·ªêC</strong> (b√™n tr√°i)' : 
    'üëâ Ch·ªçn t·ª´ <strong style="color:#FFCC80">QU√Å KH·ª®</strong> t∆∞∆°ng ·ª©ng') +
    '</span></div>' +
    
    '<div class="easy-match-container">' +
    '<div class="easy-match-columns">' +
    
    // Base column
    '<div class="easy-match-column">' +
    '<div class="easy-match-label base">‚òÄÔ∏è T·ª´ g·ªëc</div>';
  
  state.baseCards.forEach(function(card) {
    var isMatched = state.matched.indexOf(card.index) >= 0;
    var isSelected = state.selectedBase === card.index;
    var cardClass = 'easy-match-card base-card';
    if (isMatched) cardClass += ' matched';
    if (isSelected) cardClass += ' selected';
    
    html += '<div class="' + cardClass + '" ' +
      'id="base-' + card.index + '" ' +
      (isMatched ? '' : 'onclick="selectEasyMatchBase(' + card.index + ')"') + '>' +
      '<div class="verb-text">' + card.verb.base + '</div>' +
      (state.showMeaning ? '<div class="verb-meaning">' + card.verb.vn + '</div>' : '') +
      '</div>';
  });
  
  html += '</div>' +
    
    // Past column
    '<div class="easy-match-column">' +
    '<div class="easy-match-label past">üåô Qu√° kh·ª©</div>';
  
  state.pastCards.forEach(function(card) {
    var isMatched = state.matched.indexOf(card.index) >= 0;
    var cardClass = 'easy-match-card past-card';
    if (isMatched) cardClass += ' matched';
    
    html += '<div class="' + cardClass + '" ' +
      'id="past-' + card.index + '" ' +
      (isMatched ? '' : 'onclick="selectEasyMatchPast(' + card.index + ')"') + '>' +
      '<div class="verb-text">' + card.verb.past + '</div>' +
      '</div>';
  });
  
  html += '</div></div>' +
    
    // Score section
    '<div class="easy-match-score">' +
    '<div class="easy-match-progress">';
  
  for (var i = 0; i < state.level; i++) {
    html += '<div class="easy-match-dot' + (i < state.matched.length ? ' done' : '') + '">' +
      (i < state.matched.length ? '‚úì' : (i + 1)) + '</div>';
  }
  
  html += '</div>' +
    '<div style="color:#2E7D32;font-weight:700">' +
    (state.matched.length === state.level ? 'üéâ Con ƒë√£ ho√†n th√†nh r·∫•t t·ªët!' : 
    'ƒê√£ gh√©p: ' + state.matched.length + ' / ' + state.level) +
    '</div></div></div>';
  
  // Complete screen
  if (state.matched.length === state.level) {
    playSound('complete');
    showConfetti();
    
    html += '<div style="text-align:center;margin-top:20px">' +
      '<button class="next-btn" onclick="startEasyMatchGame(' + state.level + ')" style="margin-bottom:10px">Ch∆°i l·∫°i üîÑ</button>' +
      '<button class="next-btn" style="background:#F5F5F5;color:#333" onclick="startEasyMatch()">ƒê·ªïi m·ª©c ƒë·ªô üìä</button>' +
      '</div>';
  }
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function selectEasyMatchBase(index) {
  if (easyMatchState.matched.indexOf(index) >= 0) return;
  
  playSound('click');
  easyMatchState.selectedBase = index;
  renderEasyMatch();
}

function selectEasyMatchPast(index) {
  if (easyMatchState.selectedBase === null) {
    // Hint to select base first
    playSound('wrong');
    return;
  }
  
  if (easyMatchState.matched.indexOf(index) >= 0) return;
  
  var baseIndex = easyMatchState.selectedBase;
  
  if (baseIndex === index) {
    // Correct match!
    playSound('correct');
    
    // Flash animation
    var baseEl = document.getElementById('base-' + baseIndex);
    var pastEl = document.getElementById('past-' + index);
    if (baseEl) baseEl.classList.add('correct-flash');
    if (pastEl) pastEl.classList.add('correct-flash');
    
    setTimeout(function() {
      easyMatchState.matched.push(index);
      easyMatchState.selectedBase = null;
      renderEasyMatch();
    }, 500);
  } else {
    // Wrong match
    playSound('wrong');
    
    var pastEl = document.getElementById('past-' + index);
    if (pastEl) pastEl.classList.add('wrong-flash');
    
    setTimeout(function() {
      if (pastEl) pastEl.classList.remove('wrong-flash');
    }, 500);
  }
}

// ============ TRIPLE MATCH GAME ============
var tripleMatchState = {
  verbs: [],
  infCards: [],
  pastCards: [],
  ppCards: [],
  selectedInf: null,
  selectedPast: null,
  matched: [],
  level: 4,
  showMeaning: true
};

function startTripleMatch() {
  playSound('click');
  
  var html = '<div class="progress-header" style="margin-bottom:15px">' +
    '<button class="back-btn" onclick="showLearnScreen()">‚Üê Back</button>' +
    '<div style="color:white;font-weight:700;font-size:1.1rem">üîó Triple Match</div>' +
    '<div></div></div>' +
    
    '<div class="easy-match-container">' +
    '<div class="easy-match-header">' +
    '<div style="font-size:50px;margin-bottom:10px">üîó</div>' +
    '<div class="easy-match-title">Triple Match</div>' +
    '<div class="easy-match-hint">Gh√©p c·∫£ 3 d·∫°ng: G·ªëc ‚Üí Qu√° kh·ª© ‚Üí PP</div>' +
    '</div>' +
    
    '<div class="easy-match-level-select">' +
    '<div class="easy-match-level easy" onclick="startTripleMatchGame(5)">' +
    '<div class="level-icon">üå±</div>' +
    '<div class="level-info">' +
    '<div class="level-name">5 t·ª´</div>' +
    '<div class="level-desc">Kh·ªüi ƒë·ªông</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level" style="border-color:#8BC34A" onclick="startTripleMatchGame(10)">' +
    '<div class="level-icon">üåø</div>' +
    '<div class="level-info">' +
    '<div class="level-name">10 t·ª´</div>' +
    '<div class="level-desc">C∆° b·∫£n</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level medium" onclick="startTripleMatchGame(15)">' +
    '<div class="level-icon">üå≥</div>' +
    '<div class="level-info">' +
    '<div class="level-name">15 t·ª´</div>' +
    '<div class="level-desc">Trung b√¨nh</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level" style="border-color:#FF9800" onclick="startTripleMatchGame(20)">' +
    '<div class="level-icon">üî•</div>' +
    '<div class="level-info">' +
    '<div class="level-name">20 t·ª´</div>' +
    '<div class="level-desc">N√¢ng cao</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level hard" onclick="startTripleMatchGame(25)">' +
    '<div class="level-icon">üí™</div>' +
    '<div class="level-info">' +
    '<div class="level-name">25 t·ª´</div>' +
    '<div class="level-desc">Th·ª≠ th√°ch</div>' +
    '</div></div>' +
    '</div></div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function startTripleMatchGame(level) {
  playSound('click');
  
  var allVerbs = [];
  IRREGULAR_VERBS.groups.forEach(function(group) {
    group.verbs.forEach(function(verb) {
      // Use verbs where all 3 forms are different for better learning
      if (verb.base !== verb.past || verb.past !== verb.pp) {
        allVerbs.push(verb);
      }
    });
  });
  
  var selectedVerbs = shuffle(allVerbs).slice(0, level);
  
  tripleMatchState = {
    verbs: selectedVerbs,
    infCards: shuffle(selectedVerbs.map(function(v, i) { return { verb: v, index: i }; })),
    pastCards: shuffle(selectedVerbs.map(function(v, i) { return { verb: v, index: i }; })),
    ppCards: shuffle(selectedVerbs.map(function(v, i) { return { verb: v, index: i }; })),
    selectedInf: null,
    selectedPast: null,
    matched: [],
    level: level,
    showMeaning: level <= 5
  };
  
  renderTripleMatch();
}

function renderTripleMatch() {
  var state = tripleMatchState;
  
  // Determine current step
  var step = 1;
  if (state.selectedInf !== null && state.selectedPast === null) step = 2;
  if (state.selectedInf !== null && state.selectedPast !== null) step = 3;
  
  var stepText = '';
  if (step === 1) stepText = '1Ô∏è‚É£ Ch·ªçn t·ª´ <strong>G·ªêC (Infinitive)</strong>';
  if (step === 2) stepText = '2Ô∏è‚É£ Ch·ªçn t·ª´ <strong>SIMPLE PAST</strong>';
  if (step === 3) stepText = '3Ô∏è‚É£ Ch·ªçn t·ª´ <strong>PAST PARTICIPLE</strong>';
  
  var html = '<div class="progress-header" style="margin-bottom:10px">' +
    '<button class="back-btn" onclick="startTripleMatch()">‚Üê Back</button>' +
    '<div style="color:white;font-weight:700">üîó Triple Match</div>' +
    '<div style="color:white;font-weight:700">‚úì ' + state.matched.length + '/' + state.level + '</div>' +
    '</div>' +
    
    '<div class="triple-hint-bar">' +
    '<span class="step ' + (step === 1 ? 'active' : (step > 1 ? 'done' : 'waiting')) + '">1. G·ªëc</span>' +
    ' ‚Üí ' +
    '<span class="step ' + (step === 2 ? 'active' : (step > 2 ? 'done' : 'waiting')) + '">2. Simple Past</span>' +
    ' ‚Üí ' +
    '<span class="step ' + (step === 3 ? 'active' : 'waiting') + '">3. Past Participle</span>' +
    '</div>' +
    
    '<div class="triple-match-container">' +
    '<div class="triple-columns">' +
    
    // Infinitive column
    '<div class="triple-column">' +
    '<div class="triple-label inf">‚òÄÔ∏è G·ªëc</div>';
  
  state.infCards.forEach(function(card) {
    var isMatched = state.matched.indexOf(card.index) >= 0;
    var isSelected = state.selectedInf === card.index;
    var cardClass = 'triple-card inf-card';
    if (isMatched) cardClass += ' matched';
    if (isSelected) cardClass += ' locked';
    
    html += '<div class="' + cardClass + '" id="inf-' + card.index + '" ' +
      (isMatched || isSelected ? '' : 'onclick="selectTripleInf(' + card.index + ')"') + '>' +
      '<div>' + card.verb.base + '</div>' +
      (state.showMeaning ? '<div class="card-meaning">' + card.verb.vn + '</div>' : '') +
      '</div>';
  });
  
  html += '</div>' +
    
    // Past column
    '<div class="triple-column">' +
    '<div class="triple-label past">üåô Simple Past</div>';
  
  state.pastCards.forEach(function(card) {
    var isMatched = state.matched.indexOf(card.index) >= 0;
    var isSelected = state.selectedPast === card.index;
    var cardClass = 'triple-card past-card';
    if (isMatched) cardClass += ' matched';
    if (isSelected) cardClass += ' locked';
    
    html += '<div class="' + cardClass + '" id="past-' + card.index + '" ' +
      (isMatched || isSelected ? '' : 'onclick="selectTriplePast(' + card.index + ')"') + '>' +
      '<div>' + card.verb.past + '</div>' +
      '</div>';
  });
  
  html += '</div>' +
    
    // Past Participle column
    '<div class="triple-column">' +
    '<div class="triple-label pp">‚ú® Past Participle</div>';
  
  state.ppCards.forEach(function(card) {
    var isMatched = state.matched.indexOf(card.index) >= 0;
    var cardClass = 'triple-card pp-card';
    if (isMatched) cardClass += ' matched';
    
    html += '<div class="' + cardClass + '" id="pp-' + card.index + '" ' +
      (isMatched ? '' : 'onclick="selectTriplePP(' + card.index + ')"') + '>' +
      '<div>' + card.verb.pp + '</div>' +
      '</div>';
  });
  
  html += '</div></div>' +
    
    // Score section
    '<div class="triple-score-bar">' +
    '<div class="triple-progress-dots">';
  
  for (var i = 0; i < state.level; i++) {
    html += '<div class="triple-dot' + (i < state.matched.length ? ' done' : '') + '">' +
      (i < state.matched.length ? '‚úì' : '') + '</div>';
  }
  
  html += '</div>' +
    '<div style="font-weight:700;color:#333">' + state.matched.length + ' / ' + state.level + '</div>' +
    '</div></div>';
  
  // Complete screen
  if (state.matched.length === state.level) {
    playSound('complete');
    showConfetti();
    
    html += '<div style="text-align:center;margin-top:20px">' +
      '<div style="font-size:50px;margin-bottom:10px">üèÜ</div>' +
      '<div style="color:white;font-size:1.3rem;font-weight:700;margin-bottom:15px">Xu·∫•t s·∫Øc! Con ƒë√£ gh√©p ƒë√∫ng h·∫øt!</div>' +
      '<button class="next-btn" onclick="startTripleMatchGame(' + state.level + ')" style="margin-bottom:10px">Ch∆°i l·∫°i üîÑ</button>' +
      '<button class="next-btn" style="background:#F5F5F5;color:#333" onclick="startTripleMatch()">ƒê·ªïi m·ª©c ƒë·ªô üìä</button>' +
      '</div>';
  }
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function selectTripleInf(index) {
  if (tripleMatchState.matched.indexOf(index) >= 0) return;
  if (tripleMatchState.selectedInf !== null) return; // Already selected
  
  playSound('click');
  tripleMatchState.selectedInf = index;
  renderTripleMatch();
}

function selectTriplePast(index) {
  if (tripleMatchState.selectedInf === null) {
    playSound('wrong');
    return; // Must select Inf first
  }
  if (tripleMatchState.matched.indexOf(index) >= 0) return;
  if (tripleMatchState.selectedPast !== null) return;
  
  // Check if correct
  if (index === tripleMatchState.selectedInf) {
    playSound('click');
    tripleMatchState.selectedPast = index;
    renderTripleMatch();
  } else {
    // Wrong - reset
    playSound('wrong');
    var el = document.getElementById('past-' + index);
    if (el) el.classList.add('wrong-flash');
    
    setTimeout(function() {
      tripleMatchState.selectedInf = null;
      tripleMatchState.selectedPast = null;
      renderTripleMatch();
    }, 600);
  }
}

function selectTriplePP(index) {
  if (tripleMatchState.selectedInf === null || tripleMatchState.selectedPast === null) {
    playSound('wrong');
    return;
  }
  if (tripleMatchState.matched.indexOf(index) >= 0) return;
  
  // Check if all 3 match
  if (index === tripleMatchState.selectedInf) {
    // Correct!
    playSound('correct');
    
    var infEl = document.getElementById('inf-' + tripleMatchState.selectedInf);
    var pastEl = document.getElementById('past-' + tripleMatchState.selectedPast);
    var ppEl = document.getElementById('pp-' + index);
    
    if (infEl) infEl.classList.add('correct-flash');
    if (pastEl) pastEl.classList.add('correct-flash');
    if (ppEl) ppEl.classList.add('correct-flash');
    
    setTimeout(function() {
      tripleMatchState.matched.push(index);
      tripleMatchState.selectedInf = null;
      tripleMatchState.selectedPast = null;
      renderTripleMatch();
    }, 600);
  } else {
    // Wrong - reset all
    playSound('wrong');
    var el = document.getElementById('pp-' + index);
    if (el) el.classList.add('wrong-flash');
    
    setTimeout(function() {
      tripleMatchState.selectedInf = null;
      tripleMatchState.selectedPast = null;
      renderTripleMatch();
    }, 600);
  }
}

// ============ VERB SENTENCE QUIZ ============
var sentenceQuizState = {
  questions: [],
  currentIndex: 0,
  score: 0,
  answered: false,
  level: 10,
  step: 1, // 1 = ch·ªçn Do/Does/Did, 2 = ch·ªçn ƒë·ªông t·ª´
  firstAnswer: null,
  mode: 'normal' // 'normal' ho·∫∑c 'twostep'
};

// Signal words for generating questions
var SIGNAL_WORDS = {
  present: [
    { signal: 'every day', vn: 'm·ªói ng√†y' },
    { signal: 'every morning', vn: 'm·ªói s√°ng' },
    { signal: 'every week', vn: 'm·ªói tu·∫ßn' },
    { signal: 'always', vn: 'lu√¥n lu√¥n' },
    { signal: 'usually', vn: 'th∆∞·ªùng' },
    { signal: 'often', vn: 'th∆∞·ªùng xuy√™n' },
    { signal: 'sometimes', vn: 'ƒë√¥i khi' }
  ],
  past: [
    { signal: 'yesterday', vn: 'h√¥m qua' },
    { signal: 'last night', vn: 't·ªëi qua' },
    { signal: 'last week', vn: 'tu·∫ßn tr∆∞·ªõc' },
    { signal: 'last month', vn: 'th√°ng tr∆∞·ªõc' },
    { signal: 'last year', vn: 'nƒÉm ngo√°i' },
    { signal: '2 days ago', vn: '2 ng√†y tr∆∞·ªõc' },
    { signal: 'this morning', vn: 's√°ng nay' }
  ]
};

var SENTENCE_TEMPLATES = [
  // =============== AFFIRMATIVE (C√¢u kh·∫≥ng ƒë·ªãnh) ===============
  // GO
  { template: 'I ___ to school {signal}.', subject: 'I', verb: 'go', vn: 'T√¥i ƒëi h·ªçc', type: 'affirm', emoji: 'üè´üö∂' },
  { template: 'She ___ to the park {signal}.', subject: 'She', verb: 'go', vn: 'C√¥ ·∫•y ƒëi c√¥ng vi√™n', type: 'affirm', emoji: 'üëßüå≥' },
  { template: 'They ___ shopping {signal}.', subject: 'They', verb: 'go', vn: 'H·ªç ƒëi mua s·∫Øm', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëßüõí' },
  { template: 'We ___ to church {signal}.', subject: 'We', verb: 'go', vn: 'Ch√∫ng t√¥i ƒëi nh√† th·ªù', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëß‚õ™' },
  
  // EAT
  { template: 'She ___ breakfast {signal}.', subject: 'She', verb: 'eat', vn: 'C√¥ ·∫•y ƒÉn s√°ng', type: 'affirm', emoji: 'üëßüç≥' },
  { template: 'I ___ lunch at school {signal}.', subject: 'I', verb: 'eat', vn: 'T√¥i ƒÉn tr∆∞a ·ªü tr∆∞·ªùng', type: 'affirm', emoji: 'üßëüç±' },
  { template: 'He ___ dinner with family {signal}.', subject: 'He', verb: 'eat', vn: 'Anh ·∫•y ƒÉn t·ªëi v·ªõi gia ƒë√¨nh', type: 'affirm', emoji: 'üë¶üçΩÔ∏è' },
  { template: 'They ___ pizza {signal}.', subject: 'They', verb: 'eat', vn: 'H·ªç ƒÉn pizza', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëßüçï' },
  
  // READ
  { template: 'He ___ a book {signal}.', subject: 'He', verb: 'read', vn: 'Anh ·∫•y ƒë·ªçc s√°ch', type: 'affirm', emoji: 'üë¶üìñ' },
  { template: 'She ___ the newspaper {signal}.', subject: 'She', verb: 'read', vn: 'C√¥ ·∫•y ƒë·ªçc b√°o', type: 'affirm', emoji: 'üë©üì∞' },
  { template: 'I ___ comics {signal}.', subject: 'I', verb: 'read', vn: 'T√¥i ƒë·ªçc truy·ªán tranh', type: 'affirm', emoji: 'üßëüìö' },
  
  // MAKE
  { template: 'Mom ___ dinner {signal}.', subject: 'Mom', verb: 'make', vn: 'M·∫π n·∫•u b·ªØa t·ªëi', type: 'affirm', emoji: 'üë©‚Äçüç≥üç≤' },
  { template: 'She ___ a cake {signal}.', subject: 'She', verb: 'make', vn: 'C√¥ ·∫•y l√†m b√°nh', type: 'affirm', emoji: 'üëßüéÇ' },
  { template: 'I ___ my bed {signal}.', subject: 'I', verb: 'make', vn: 'T√¥i d·ªçn gi∆∞·ªùng', type: 'affirm', emoji: 'üßëüõèÔ∏è' },
  
  // DRINK
  { template: 'I ___ milk {signal}.', subject: 'I', verb: 'drink', vn: 'T√¥i u·ªëng s·ªØa', type: 'affirm', emoji: 'üßëü•õ' },
  { template: 'He ___ coffee {signal}.', subject: 'He', verb: 'drink', vn: 'Anh ·∫•y u·ªëng c√† ph√™', type: 'affirm', emoji: 'üë®‚òï' },
  { template: 'She ___ orange juice {signal}.', subject: 'She', verb: 'drink', vn: 'C√¥ ·∫•y u·ªëng n∆∞·ªõc cam', type: 'affirm', emoji: 'üëßüßÉ' },
  
  // SING
  { template: 'He ___ a song {signal}.', subject: 'He', verb: 'sing', vn: 'Anh ·∫•y h√°t m·ªôt b√†i', type: 'affirm', emoji: 'üë¶üé§' },
  { template: 'She ___ beautifully {signal}.', subject: 'She', verb: 'sing', vn: 'C√¥ ·∫•y h√°t hay', type: 'affirm', emoji: 'üëßüéµ' },
  { template: 'They ___ together {signal}.', subject: 'They', verb: 'sing', vn: 'H·ªç h√°t c√πng nhau', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëßüé∂' },
  
  // SWIM
  { template: 'They ___ in the pool {signal}.', subject: 'They', verb: 'swim', vn: 'H·ªç b∆°i trong h·ªì', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëßüèä' },
  { template: 'I ___ at the beach {signal}.', subject: 'I', verb: 'swim', vn: 'T√¥i b∆°i ·ªü bi·ªÉn', type: 'affirm', emoji: 'üßëüèñÔ∏è' },
  { template: 'He ___ very fast {signal}.', subject: 'He', verb: 'swim', vn: 'Anh ·∫•y b∆°i r·∫•t nhanh', type: 'affirm', emoji: 'üë¶üí®' },
  
  // DO
  { template: 'I ___ my homework {signal}.', subject: 'I', verb: 'do', vn: 'T√¥i l√†m b√†i t·∫≠p', type: 'affirm', emoji: 'üßëüìù' },
  { template: 'She ___ the dishes {signal}.', subject: 'She', verb: 'do', vn: 'C√¥ ·∫•y r·ª≠a b√°t', type: 'affirm', emoji: 'üëßüçΩÔ∏è' },
  { template: 'They ___ exercise {signal}.', subject: 'They', verb: 'do', vn: 'H·ªç t·∫≠p th·ªÉ d·ª•c', type: 'affirm', emoji: 'üë®‚Äçüë©‚ÄçüëßüèÉ' },
  
  // BUY
  { template: 'She ___ a new dress {signal}.', subject: 'She', verb: 'buy', vn: 'C√¥ ·∫•y mua v√°y m·ªõi', type: 'affirm', emoji: 'üëßüëó' },
  { template: 'I ___ some books {signal}.', subject: 'I', verb: 'buy', vn: 'T√¥i mua v√†i quy·ªÉn s√°ch', type: 'affirm', emoji: 'üßëüìö' },
  { template: 'He ___ a gift {signal}.', subject: 'He', verb: 'buy', vn: 'Anh ·∫•y mua qu√†', type: 'affirm', emoji: 'üë¶üéÅ' },
  
  // WRITE
  { template: 'We ___ a letter {signal}.', subject: 'We', verb: 'write', vn: 'Ch√∫ng t√¥i vi·∫øt th∆∞', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëß‚úâÔ∏è' },
  { template: 'She ___ in her diary {signal}.', subject: 'She', verb: 'write', vn: 'C√¥ ·∫•y vi·∫øt nh·∫≠t k√Ω', type: 'affirm', emoji: 'üëßüìî' },
  { template: 'I ___ an email {signal}.', subject: 'I', verb: 'write', vn: 'T√¥i vi·∫øt email', type: 'affirm', emoji: 'üßëüíª' },
  
  // MEET
  { template: 'I ___ my friend {signal}.', subject: 'I', verb: 'meet', vn: 'T√¥i g·∫∑p b·∫°n', type: 'affirm', emoji: 'üßëü§ù' },
  { template: 'She ___ her teacher {signal}.', subject: 'She', verb: 'meet', vn: 'C√¥ ·∫•y g·∫∑p c√¥ gi√°o', type: 'affirm', emoji: 'üëßüë©‚Äçüè´' },
  { template: 'They ___ at the cafe {signal}.', subject: 'They', verb: 'meet', vn: 'H·ªç g·∫∑p nhau ·ªü qu√°n', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëß‚òï' },
  
  // RUN
  { template: 'He ___ fast {signal}.', subject: 'He', verb: 'run', vn: 'Anh ·∫•y ch·∫°y nhanh', type: 'affirm', emoji: 'üë¶üèÉ' },
  { template: 'I ___ in the morning {signal}.', subject: 'I', verb: 'run', vn: 'T√¥i ch·∫°y bu·ªïi s√°ng', type: 'affirm', emoji: 'üßëüåÖ' },
  { template: 'They ___ in the park {signal}.', subject: 'They', verb: 'run', vn: 'H·ªç ch·∫°y trong c√¥ng vi√™n', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëßüå≥' },
  
  // GIVE
  { template: 'I ___ a gift to mom {signal}.', subject: 'I', verb: 'give', vn: 'T√¥i t·∫∑ng qu√† cho m·∫π', type: 'affirm', emoji: 'üßëüéÅ' },
  { template: 'She ___ me a book {signal}.', subject: 'She', verb: 'give', vn: 'C√¥ ·∫•y cho t√¥i s√°ch', type: 'affirm', emoji: 'üëßüìñ' },
  { template: 'He ___ flowers to her {signal}.', subject: 'He', verb: 'give', vn: 'Anh ·∫•y t·∫∑ng hoa cho c√¥ ·∫•y', type: 'affirm', emoji: 'üë¶üíê' },
  
  // TAKE
  { template: 'She ___ the bus {signal}.', subject: 'She', verb: 'take', vn: 'C√¥ ·∫•y ƒëi xe bu√Ωt', type: 'affirm', emoji: 'üëßüöå' },
  { template: 'I ___ a shower {signal}.', subject: 'I', verb: 'take', vn: 'T√¥i t·∫Øm', type: 'affirm', emoji: 'üßëüöø' },
  { template: 'He ___ photos {signal}.', subject: 'He', verb: 'take', vn: 'Anh ·∫•y ch·ª•p ·∫£nh', type: 'affirm', emoji: 'üë¶üì∑' },
  
  // COME
  { template: 'We ___ home late {signal}.', subject: 'We', verb: 'come', vn: 'Ch√∫ng t√¥i v·ªÅ nh√† mu·ªôn', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëßüè†' },
  { template: 'She ___ to my house {signal}.', subject: 'She', verb: 'come', vn: 'C√¥ ·∫•y ƒë·∫øn nh√† t√¥i', type: 'affirm', emoji: 'üëßüè°' },
  { template: 'They ___ to the party {signal}.', subject: 'They', verb: 'come', vn: 'H·ªç ƒë·∫øn b·ªØa ti·ªác', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëßüéâ' },
  
  // SEE
  { template: 'They ___ a movie {signal}.', subject: 'They', verb: 'see', vn: 'H·ªç xem phim', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëßüé¨' },
  { template: 'I ___ my grandma {signal}.', subject: 'I', verb: 'see', vn: 'T√¥i g·∫∑p b√†', type: 'affirm', emoji: 'üßëüëµ' },
  { template: 'She ___ a bird {signal}.', subject: 'She', verb: 'see', vn: 'C√¥ ·∫•y nh√¨n th·∫•y con chim', type: 'affirm', emoji: 'üëßüê¶' },
  
  // SLEEP
  { template: 'I ___ early {signal}.', subject: 'I', verb: 'sleep', vn: 'T√¥i ng·ªß s·ªõm', type: 'affirm', emoji: 'üßíüò¥' },
  { template: 'She ___ late {signal}.', subject: 'She', verb: 'sleep', vn: 'C√¥ ·∫•y ng·ªß mu·ªôn', type: 'affirm', emoji: 'üëßüåô' },
  { template: 'The baby ___ well {signal}.', subject: 'The baby', verb: 'sleep', vn: 'Em b√© ng·ªß ngon', type: 'affirm', emoji: 'üë∂üí§' },
  
  // HAVE
  { template: 'I ___ breakfast {signal}.', subject: 'I', verb: 'have', vn: 'T√¥i ƒÉn s√°ng', type: 'affirm', emoji: 'üßëüç≥' },
  { template: 'She ___ a dog {signal}.', subject: 'She', verb: 'have', vn: 'C√¥ ·∫•y c√≥ con ch√≥', type: 'affirm', emoji: 'üëßüêï' },
  { template: 'We ___ a party {signal}.', subject: 'We', verb: 'have', vn: 'Ch√∫ng t√¥i c√≥ b·ªØa ti·ªác', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëßüéä' },
  
  // GET
  { template: 'I ___ a present {signal}.', subject: 'I', verb: 'get', vn: 'T√¥i ƒë∆∞·ª£c qu√†', type: 'affirm', emoji: 'üßëüéÅ' },
  { template: 'She ___ good grades {signal}.', subject: 'She', verb: 'get', vn: 'C√¥ ·∫•y ƒë∆∞·ª£c ƒëi·ªÉm cao', type: 'affirm', emoji: 'üëßüíØ' },
  { template: 'He ___ up early {signal}.', subject: 'He', verb: 'get', vn: 'Anh ·∫•y d·∫≠y s·ªõm', type: 'affirm', emoji: 'üë¶‚è∞' },
  
  // FEEL
  { template: 'I ___ happy {signal}.', subject: 'I', verb: 'feel', vn: 'T√¥i c·∫£m th·∫•y vui', type: 'affirm', emoji: 'üßëüòä' },
  { template: 'She ___ tired {signal}.', subject: 'She', verb: 'feel', vn: 'C√¥ ·∫•y c·∫£m th·∫•y m·ªát', type: 'affirm', emoji: 'üëßüò´' },
  { template: 'He ___ sick {signal}.', subject: 'He', verb: 'feel', vn: 'Anh ·∫•y c·∫£m th·∫•y ·ªëm', type: 'affirm', emoji: 'üë¶ü§í' },
  
  // FIND
  { template: 'I ___ my keys {signal}.', subject: 'I', verb: 'find', vn: 'T√¥i t√¨m th·∫•y ch√¨a kh√≥a', type: 'affirm', emoji: 'üßëüîë' },
  { template: 'She ___ a new job {signal}.', subject: 'She', verb: 'find', vn: 'C√¥ ·∫•y t√¨m ƒë∆∞·ª£c vi·ªác m·ªõi', type: 'affirm', emoji: 'üë©üíº' },
  { template: 'He ___ the answer {signal}.', subject: 'He', verb: 'find', vn: 'Anh ·∫•y t√¨m ra ƒë√°p √°n', type: 'affirm', emoji: 'üë¶üí°' },
  
  // LOSE
  { template: 'He ___ his phone {signal}.', subject: 'He', verb: 'lose', vn: 'Anh ·∫•y m·∫•t ƒëi·ªán tho·∫°i', type: 'affirm', emoji: 'üë¶üì±' },
  { template: 'I ___ my wallet {signal}.', subject: 'I', verb: 'lose', vn: 'T√¥i m·∫•t v√≠', type: 'affirm', emoji: 'üßëüëõ' },
  { template: 'She ___ her keys {signal}.', subject: 'She', verb: 'lose', vn: 'C√¥ ·∫•y m·∫•t ch√¨a kh√≥a', type: 'affirm', emoji: 'üëßüîë' },
  
  // TEACH
  { template: 'She ___ English {signal}.', subject: 'She', verb: 'teach', vn: 'C√¥ ·∫•y d·∫°y ti·∫øng Anh', type: 'affirm', emoji: 'üë©‚Äçüè´üìö' },
  { template: 'He ___ me math {signal}.', subject: 'He', verb: 'teach', vn: 'Anh ·∫•y d·∫°y t√¥i to√°n', type: 'affirm', emoji: 'üë®‚Äçüè´üî¢' },
  
  // THINK
  { template: 'I ___ about you {signal}.', subject: 'I', verb: 'think', vn: 'T√¥i nghƒ© v·ªÅ b·∫°n', type: 'affirm', emoji: 'üßëüí≠' },
  { template: 'She ___ hard {signal}.', subject: 'She', verb: 'think', vn: 'C√¥ ·∫•y suy nghƒ© nhi·ªÅu', type: 'affirm', emoji: 'üëßü§î' },
  
  // BRING
  { template: 'I ___ my book {signal}.', subject: 'I', verb: 'bring', vn: 'T√¥i mang s√°ch', type: 'affirm', emoji: 'üßëüìñ' },
  { template: 'She ___ food {signal}.', subject: 'She', verb: 'bring', vn: 'C√¥ ·∫•y mang ƒë·ªì ƒÉn', type: 'affirm', emoji: 'üëßüç±' },
  
  // WIN
  { template: 'He ___ the game {signal}.', subject: 'He', verb: 'win', vn: 'Anh ·∫•y th·∫Øng tr·∫≠n', type: 'affirm', emoji: 'üë¶üèÜ' },
  { template: 'She ___ a prize {signal}.', subject: 'She', verb: 'win', vn: 'C√¥ ·∫•y th·∫Øng gi·∫£i', type: 'affirm', emoji: 'üëßü•á' },
  
  // WEAR
  { template: 'She ___ a dress {signal}.', subject: 'She', verb: 'wear', vn: 'C√¥ ·∫•y m·∫∑c v√°y', type: 'affirm', emoji: 'üëßüëó' },
  { template: 'He ___ a hat {signal}.', subject: 'He', verb: 'wear', vn: 'Anh ·∫•y ƒë·ªôi m≈©', type: 'affirm', emoji: 'üë¶üé©' },
  
  // =============== NEGATIVE (C√¢u ph·ªß ƒë·ªãnh) ===============
  // GO
  { template: 'I ___ go to school {signal}.', subject: 'I', verb: 'go', vn: 'T√¥i kh√¥ng ƒëi h·ªçc', type: 'negative', emoji: 'üßëüö´üè´' },
  { template: 'She ___ go to the park {signal}.', subject: 'She', verb: 'go', vn: 'C√¥ ·∫•y kh√¥ng ƒëi c√¥ng vi√™n', type: 'negative', emoji: 'üëßüö´üå≥' },
  { template: 'They ___ go shopping {signal}.', subject: 'They', verb: 'go', vn: 'H·ªç kh√¥ng ƒëi mua s·∫Øm', type: 'negative', emoji: 'üë®‚Äçüë©‚Äçüëßüö´üõí' },
  { template: 'He ___ go to work {signal}.', subject: 'He', verb: 'go', vn: 'Anh ·∫•y kh√¥ng ƒëi l√†m', type: 'negative', emoji: 'üë®üö´üíº' },
  
  // EAT
  { template: 'She ___ eat breakfast {signal}.', subject: 'She', verb: 'eat', vn: 'C√¥ ·∫•y kh√¥ng ƒÉn s√°ng', type: 'negative', emoji: 'üëßüö´üç≥' },
  { template: 'I ___ eat meat {signal}.', subject: 'I', verb: 'eat', vn: 'T√¥i kh√¥ng ƒÉn th·ªãt', type: 'negative', emoji: 'üßëüö´ü•©' },
  { template: 'He ___ eat vegetables {signal}.', subject: 'He', verb: 'eat', vn: 'Anh ·∫•y kh√¥ng ƒÉn rau', type: 'negative', emoji: 'üë¶üö´ü•¨' },
  { template: 'They ___ eat fast food {signal}.', subject: 'They', verb: 'eat', vn: 'H·ªç kh√¥ng ƒÉn ƒë·ªì ƒÉn nhanh', type: 'negative', emoji: 'üë®‚Äçüë©‚Äçüëßüö´üçî' },
  
  // DRINK
  { template: 'I ___ drink coffee {signal}.', subject: 'I', verb: 'drink', vn: 'T√¥i kh√¥ng u·ªëng c√† ph√™', type: 'negative', emoji: 'üßëüö´‚òï' },
  { template: 'She ___ drink soda {signal}.', subject: 'She', verb: 'drink', vn: 'C√¥ ·∫•y kh√¥ng u·ªëng n∆∞·ªõc ng·ªçt', type: 'negative', emoji: 'üëßüö´ü•§' },
  { template: 'He ___ drink alcohol {signal}.', subject: 'He', verb: 'drink', vn: 'Anh ·∫•y kh√¥ng u·ªëng r∆∞·ª£u', type: 'negative', emoji: 'üë®üö´üç∫' },
  
  // DO
  { template: 'I ___ do my homework {signal}.', subject: 'I', verb: 'do', vn: 'T√¥i kh√¥ng l√†m b√†i t·∫≠p', type: 'negative', emoji: 'üßëüö´üìù' },
  { template: 'She ___ do the dishes {signal}.', subject: 'She', verb: 'do', vn: 'C√¥ ·∫•y kh√¥ng r·ª≠a b√°t', type: 'negative', emoji: 'üëßüö´üçΩÔ∏è' },
  { template: 'They ___ do exercise {signal}.', subject: 'They', verb: 'do', vn: 'H·ªç kh√¥ng t·∫≠p th·ªÉ d·ª•c', type: 'negative', emoji: 'üë®‚Äçüë©‚Äçüëßüö´üèÉ' },
  
  // HAVE
  { template: 'I ___ have breakfast {signal}.', subject: 'I', verb: 'have', vn: 'T√¥i kh√¥ng ƒÉn s√°ng', type: 'negative', emoji: 'üßëüö´üç≥' },
  { template: 'She ___ have time {signal}.', subject: 'She', verb: 'have', vn: 'C√¥ ·∫•y kh√¥ng c√≥ th·ªùi gian', type: 'negative', emoji: 'üëßüö´‚è∞' },
  { template: 'We ___ have money {signal}.', subject: 'We', verb: 'have', vn: 'Ch√∫ng t√¥i kh√¥ng c√≥ ti·ªÅn', type: 'negative', emoji: 'üë®‚Äçüë©‚Äçüëßüö´üí∞' },
  
  // SLEEP
  { template: 'I ___ sleep well {signal}.', subject: 'I', verb: 'sleep', vn: 'T√¥i kh√¥ng ng·ªß ngon', type: 'negative', emoji: 'üßëüö´üò¥' },
  { template: 'She ___ sleep late {signal}.', subject: 'She', verb: 'sleep', vn: 'C√¥ ·∫•y kh√¥ng ng·ªß mu·ªôn', type: 'negative', emoji: 'üëßüö´üåô' },
  { template: 'He ___ sleep enough {signal}.', subject: 'He', verb: 'sleep', vn: 'Anh ·∫•y kh√¥ng ng·ªß ƒë·ªß', type: 'negative', emoji: 'üë¶üö´üí§' },
  
  // COME
  { template: 'She ___ come to the party {signal}.', subject: 'She', verb: 'come', vn: 'C√¥ ·∫•y kh√¥ng ƒë·∫øn ti·ªác', type: 'negative', emoji: 'üëßüö´üéâ' },
  { template: 'He ___ come home early {signal}.', subject: 'He', verb: 'come', vn: 'Anh ·∫•y kh√¥ng v·ªÅ nh√† s·ªõm', type: 'negative', emoji: 'üë¶üö´üè†' },
  { template: 'They ___ come to school {signal}.', subject: 'They', verb: 'come', vn: 'H·ªç kh√¥ng ƒë·∫øn tr∆∞·ªùng', type: 'negative', emoji: 'üë®‚Äçüë©‚Äçüëßüö´üè´' },
  
  // SEE
  { template: 'I ___ see the movie {signal}.', subject: 'I', verb: 'see', vn: 'T√¥i kh√¥ng xem phim', type: 'negative', emoji: 'üßëüö´üé¨' },
  { template: 'She ___ see him {signal}.', subject: 'She', verb: 'see', vn: 'C√¥ ·∫•y kh√¥ng g·∫∑p anh ·∫•y', type: 'negative', emoji: 'üëßüö´üë¶' },
  { template: 'They ___ see anything {signal}.', subject: 'They', verb: 'see', vn: 'H·ªç kh√¥ng th·∫•y g√¨', type: 'negative', emoji: 'üë®‚Äçüë©‚Äçüëßüö´üëÄ' },
  
  // KNOW
  { template: 'I ___ know the answer {signal}.', subject: 'I', verb: 'know', vn: 'T√¥i kh√¥ng bi·∫øt c√¢u tr·∫£ l·ªùi', type: 'negative', emoji: 'üßëüö´‚ùì' },
  { template: 'She ___ know him {signal}.', subject: 'She', verb: 'know', vn: 'C√¥ ·∫•y kh√¥ng bi·∫øt anh ·∫•y', type: 'negative', emoji: 'üëßüö´üë¶' },
  { template: 'They ___ know the way {signal}.', subject: 'They', verb: 'know', vn: 'H·ªç kh√¥ng bi·∫øt ƒë∆∞·ªùng', type: 'negative', emoji: 'üë®‚Äçüë©‚Äçüëßüö´üó∫Ô∏è' },
  
  // WIN
  { template: 'We ___ win the game {signal}.', subject: 'We', verb: 'win', vn: 'Ch√∫ng t√¥i kh√¥ng th·∫Øng', type: 'negative', emoji: 'üë®‚Äçüë©‚Äçüëßüö´üèÜ' },
  { template: 'He ___ win the match {signal}.', subject: 'He', verb: 'win', vn: 'Anh ·∫•y kh√¥ng th·∫Øng tr·∫≠n', type: 'negative', emoji: 'üë¶üö´ü•á' },
  
  // =============== QUESTION (C√¢u h·ªèi) - Y√™u c·∫ßu ch·ªçn chia ƒë·ªông t·ª´ ===============
  // GO
  { template: 'Does she ___ to the park {signal}?', subject: 'she', verb: 'go', vn: 'C√¥ ·∫•y c√≥ ƒëi c√¥ng vi√™n kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüå≥' },
  { template: 'Do they ___ shopping {signal}?', subject: 'they', verb: 'go', vn: 'H·ªç c√≥ ƒëi mua s·∫Øm kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®‚Äçüë©‚Äçüëßüõí' },
  { template: 'Did he ___ to work {signal}?', subject: 'he', verb: 'go', vn: 'Anh ·∫•y c√≥ ƒëi l√†m kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®üíº' },
  { template: 'Did you ___ to school {signal}?', subject: 'you', verb: 'go', vn: 'B·∫°n c√≥ ƒëi h·ªçc kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüè´' },
  
  // EAT
  { template: 'Does she ___ breakfast {signal}?', subject: 'she', verb: 'eat', vn: 'C√¥ ·∫•y c√≥ ƒÉn s√°ng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüç≥' },
  { template: 'Do you ___ lunch {signal}?', subject: 'you', verb: 'eat', vn: 'B·∫°n c√≥ ƒÉn tr∆∞a kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüç±' },
  { template: 'Did he ___ dinner {signal}?', subject: 'he', verb: 'eat', vn: 'Anh ·∫•y c√≥ ƒÉn t·ªëi kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üçΩÔ∏è' },
  { template: 'Did they ___ pizza {signal}?', subject: 'they', verb: 'eat', vn: 'H·ªç c√≥ ƒÉn pizza kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®‚Äçüë©‚Äçüëßüçï' },
  
  // DRINK
  { template: 'Do you ___ milk {signal}?', subject: 'you', verb: 'drink', vn: 'B·∫°n c√≥ u·ªëng s·ªØa kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëü•õ' },
  { template: 'Does she ___ coffee {signal}?', subject: 'she', verb: 'drink', vn: 'C√¥ ·∫•y c√≥ u·ªëng c√† ph√™ kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëß‚òï' },
  { template: 'Did he ___ tea {signal}?', subject: 'he', verb: 'drink', vn: 'Anh ·∫•y c√≥ u·ªëng tr√† kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üçµ' },
  
  // DO
  { template: 'Do you ___ homework {signal}?', subject: 'you', verb: 'do', vn: 'B·∫°n c√≥ l√†m b√†i t·∫≠p kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüìù' },
  { template: 'Does she ___ exercise {signal}?', subject: 'she', verb: 'do', vn: 'C√¥ ·∫•y c√≥ t·∫≠p th·ªÉ d·ª•c kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüèÉ' },
  { template: 'Did they ___ the dishes {signal}?', subject: 'they', verb: 'do', vn: 'H·ªç c√≥ r·ª≠a b√°t kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®‚Äçüë©‚ÄçüëßüçΩÔ∏è' },
  
  // HAVE
  { template: 'Do you ___ breakfast {signal}?', subject: 'you', verb: 'have', vn: 'B·∫°n c√≥ ƒÉn s√°ng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüç≥' },
  { template: 'Does she ___ a car {signal}?', subject: 'she', verb: 'have', vn: 'C√¥ ·∫•y c√≥ xe h∆°i kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüöó' },
  { template: 'Did they ___ fun {signal}?', subject: 'they', verb: 'have', vn: 'H·ªç c√≥ vui kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®‚Äçüë©‚ÄçüëßüòÑ' },
  
  // SLEEP
  { template: 'Do you ___ well {signal}?', subject: 'you', verb: 'sleep', vn: 'B·∫°n c√≥ ng·ªß ngon kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüò¥' },
  { template: 'Does she ___ early {signal}?', subject: 'she', verb: 'sleep', vn: 'C√¥ ·∫•y c√≥ ng·ªß s·ªõm kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüåô' },
  { template: 'Did he ___ late {signal}?', subject: 'he', verb: 'sleep', vn: 'Anh ·∫•y c√≥ ng·ªß mu·ªôn kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üí§' },
  
  // SEE
  { template: 'Do you ___ the movie {signal}?', subject: 'you', verb: 'see', vn: 'B·∫°n c√≥ xem phim kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüé¨' },
  { template: 'Does she ___ him {signal}?', subject: 'she', verb: 'see', vn: 'C√¥ ·∫•y c√≥ g·∫∑p anh ·∫•y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüë¶' },
  { template: 'Did they ___ the show {signal}?', subject: 'they', verb: 'see', vn: 'H·ªç c√≥ xem show kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®‚Äçüë©‚Äçüëßüì∫' },
  
  // BUY
  { template: 'Do you ___ a gift {signal}?', subject: 'you', verb: 'buy', vn: 'B·∫°n c√≥ mua qu√† kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüéÅ' },
  { template: 'Does she ___ clothes {signal}?', subject: 'she', verb: 'buy', vn: 'C√¥ ·∫•y c√≥ mua qu·∫ßn √°o kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüëó' },
  { template: 'Did he ___ a book {signal}?', subject: 'he', verb: 'buy', vn: 'Anh ·∫•y c√≥ mua s√°ch kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üìñ' },
  
  // MEET
  { template: 'Do you ___ her {signal}?', subject: 'you', verb: 'meet', vn: 'B·∫°n c√≥ g·∫∑p c√¥ ·∫•y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëü§ù' },
  { template: 'Did they ___ at school {signal}?', subject: 'they', verb: 'meet', vn: 'H·ªç c√≥ g·∫∑p nhau ·ªü tr∆∞·ªùng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®‚Äçüë©‚Äçüëßüè´' },
  
  // RUN
  { template: 'Do you ___ in the morning {signal}?', subject: 'you', verb: 'run', vn: 'B·∫°n c√≥ ch·∫°y bu·ªïi s√°ng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüèÉ' },
  { template: 'Does he ___ fast {signal}?', subject: 'he', verb: 'run', vn: 'Anh ·∫•y c√≥ ch·∫°y nhanh kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üí®' },
  
  // SWIM
  { template: 'Do you ___ {signal}?', subject: 'you', verb: 'swim', vn: 'B·∫°n c√≥ b∆°i kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüèä' },
  { template: 'Does she ___ well {signal}?', subject: 'she', verb: 'swim', vn: 'C√¥ ·∫•y c√≥ b∆°i gi·ªèi kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüèä‚Äç‚ôÄÔ∏è' },
  
  // SING
  { template: 'Do you ___ songs {signal}?', subject: 'you', verb: 'sing', vn: 'B·∫°n c√≥ h√°t kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüé§' },
  { template: 'Does she ___ well {signal}?', subject: 'she', verb: 'sing', vn: 'C√¥ ·∫•y c√≥ h√°t hay kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüéµ' },
  
  // WIN
  { template: 'Did you ___ the game {signal}?', subject: 'you', verb: 'win', vn: 'B·∫°n c√≥ th·∫Øng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüèÜ' },
  { template: 'Did they ___ the match {signal}?', subject: 'they', verb: 'win', vn: 'H·ªç c√≥ th·∫Øng tr·∫≠n kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®‚Äçüë©‚Äçüëßü•á' },
  
  // WRITE
  { template: 'Do you ___ a letter {signal}?', subject: 'you', verb: 'write', vn: 'B·∫°n c√≥ vi·∫øt th∆∞ kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßë‚úâÔ∏è' },
  { template: 'Does she ___ emails {signal}?', subject: 'she', verb: 'write', vn: 'C√¥ ·∫•y c√≥ vi·∫øt email kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüíª' },
  
  // READ
  { template: 'Do you ___ books {signal}?', subject: 'you', verb: 'read', vn: 'B·∫°n c√≥ ƒë·ªçc s√°ch kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüìö' },
  { template: 'Does he ___ newspapers {signal}?', subject: 'he', verb: 'read', vn: 'Anh ·∫•y c√≥ ƒë·ªçc b√°o kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®üì∞' },
  
  // SPEAK
  { template: 'Do you ___ English {signal}?', subject: 'you', verb: 'speak', vn: 'B·∫°n c√≥ n√≥i ti·∫øng Anh kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüó£Ô∏è' },
  { template: 'Does she ___ French {signal}?', subject: 'she', verb: 'speak', vn: 'C√¥ ·∫•y c√≥ n√≥i ti·∫øng Ph√°p kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüá´üá∑' },
  
  // GIVE
  { template: 'Did you ___ him money {signal}?', subject: 'you', verb: 'give', vn: 'B·∫°n c√≥ cho anh ·∫•y ti·ªÅn kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüí∞' },
  { template: 'Did she ___ a present {signal}?', subject: 'she', verb: 'give', vn: 'C√¥ ·∫•y c√≥ t·∫∑ng qu√† kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüéÅ' },
  
  // TAKE
  { template: 'Did you ___ the bus {signal}?', subject: 'you', verb: 'take', vn: 'B·∫°n c√≥ ƒëi xe bu√Ωt kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüöå' },
  { template: 'Did she ___ photos {signal}?', subject: 'she', verb: 'take', vn: 'C√¥ ·∫•y c√≥ ch·ª•p ·∫£nh kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüì∑' },
  
  // BRING
  { template: 'Did you ___ your book {signal}?', subject: 'you', verb: 'bring', vn: 'B·∫°n c√≥ mang s√°ch kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüìñ' },
  { template: 'Did she ___ food {signal}?', subject: 'she', verb: 'bring', vn: 'C√¥ ·∫•y c√≥ mang ƒë·ªì ƒÉn kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüç±' },

  // =============== B·ªî SUNG ƒê·ªòNG T·ª™ PH·ªî BI·∫æN (theo th·ª© t·ª± t·ª´ ph·ªï bi·∫øn ‚Üí √≠t ph·ªï bi·∫øn) ===============
  
  // === NH√ìM 1: C·ª∞C K·ª≤ PH·ªî BI·∫æN ===
  
  // SAY (n√≥i)
  { template: 'He ___ hello {signal}.', subject: 'He', verb: 'say', vn: 'Anh ·∫•y n√≥i xin ch√†o', type: 'affirm', emoji: 'üë¶üëã' },
  { template: 'She ___ goodbye {signal}.', subject: 'She', verb: 'say', vn: 'C√¥ ·∫•y n√≥i t·∫°m bi·ªát', type: 'affirm', emoji: 'üëßüëã' },
  { template: 'I ___ thank you {signal}.', subject: 'I', verb: 'say', vn: 'T√¥i n√≥i c·∫£m ∆°n', type: 'affirm', emoji: 'üßëüôè' },
  { template: 'She ___ say sorry {signal}.', subject: 'She', verb: 'say', vn: 'C√¥ ·∫•y kh√¥ng n√≥i xin l·ªói', type: 'negative', emoji: 'üëßüö´' },
  { template: 'Did he ___ anything {signal}?', subject: 'he', verb: 'say', vn: 'Anh ·∫•y c√≥ n√≥i g√¨ kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üí¨' },

  // TELL (k·ªÉ, n√≥i v·ªõi)
  { template: 'Mom ___ me a story {signal}.', subject: 'Mom', verb: 'tell', vn: 'M·∫π k·ªÉ t√¥i m·ªôt c√¢u chuy·ªán', type: 'affirm', emoji: 'üë©üìñ' },
  { template: 'He ___ the truth {signal}.', subject: 'He', verb: 'tell', vn: 'Anh ·∫•y n√≥i s·ª± th·∫≠t', type: 'affirm', emoji: 'üë¶‚úì' },
  { template: 'She ___ tell lies {signal}.', subject: 'She', verb: 'tell', vn: 'C√¥ ·∫•y kh√¥ng n√≥i d·ªëi', type: 'negative', emoji: 'üëßüö´ü§•' },
  { template: 'Did you ___ her {signal}?', subject: 'you', verb: 'tell', vn: 'B·∫°n c√≥ n√≥i v·ªõi c√¥ ·∫•y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüëß' },

  // PUT (ƒë·∫∑t, ƒë·ªÉ)
  { template: 'I ___ my bag on the chair {signal}.', subject: 'I', verb: 'put', vn: 'T√¥i ƒë·∫∑t c·∫∑p l√™n gh·∫ø', type: 'affirm', emoji: 'üßëüéíü™ë' },
  { template: 'She ___ the book on the table {signal}.', subject: 'She', verb: 'put', vn: 'C√¥ ·∫•y ƒë·∫∑t s√°ch l√™n b√†n', type: 'affirm', emoji: 'üëßüìöü™ë' },
  { template: 'He ___ put his toys away {signal}.', subject: 'He', verb: 'put', vn: 'Anh ·∫•y kh√¥ng c·∫•t ƒë·ªì ch∆°i', type: 'negative', emoji: 'üë¶üö´üß∏' },
  { template: 'Did you ___ it here {signal}?', subject: 'you', verb: 'put', vn: 'B·∫°n c√≥ ƒë·ªÉ n√≥ ·ªü ƒë√¢y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüìç' },

  // SEND (g·ª≠i)
  { template: 'I ___ an email {signal}.', subject: 'I', verb: 'send', vn: 'T√¥i g·ª≠i email', type: 'affirm', emoji: 'üßëüìß' },
  { template: 'She ___ a letter {signal}.', subject: 'She', verb: 'send', vn: 'C√¥ ·∫•y g·ª≠i th∆∞', type: 'affirm', emoji: 'üëß‚úâÔ∏è' },
  { template: 'He ___ send a message {signal}.', subject: 'He', verb: 'send', vn: 'Anh ·∫•y kh√¥ng g·ª≠i tin nh·∫Øn', type: 'negative', emoji: 'üë¶üö´üí¨' },
  { template: 'Did you ___ the package {signal}?', subject: 'you', verb: 'send', vn: 'B·∫°n c√≥ g·ª≠i g√≥i h√†ng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüì¶' },

  // LEAVE (r·ªùi ƒëi, ƒë·ªÉ l·∫°i)
  { template: 'I ___ home at 7 AM {signal}.', subject: 'I', verb: 'leave', vn: 'T√¥i r·ªùi nh√† l√∫c 7 gi·ªù', type: 'affirm', emoji: 'üßëüè†‚è∞' },
  { template: 'She ___ her bag at school {signal}.', subject: 'She', verb: 'leave', vn: 'C√¥ ·∫•y ƒë·ªÉ c·∫∑p ·ªü tr∆∞·ªùng', type: 'affirm', emoji: 'üëßüéíüè´' },
  { template: 'He ___ leave early {signal}.', subject: 'He', verb: 'leave', vn: 'Anh ·∫•y kh√¥ng r·ªùi ƒëi s·ªõm', type: 'negative', emoji: 'üë¶üö´üö™' },
  { template: 'Did you ___ the door open {signal}?', subject: 'you', verb: 'leave', vn: 'B·∫°n c√≥ ƒë·ªÉ c·ª≠a m·ªü kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüö™' },

  // === NH√ìM 2: R·∫§T PH·ªî BI·∫æN ===

  // STAND (ƒë·ª©ng)
  { template: 'I ___ in line {signal}.', subject: 'I', verb: 'stand', vn: 'T√¥i ƒë·ª©ng x·∫øp h√†ng', type: 'affirm', emoji: 'üßëüßç' },
  { template: 'She ___ near the window {signal}.', subject: 'She', verb: 'stand', vn: 'C√¥ ·∫•y ƒë·ª©ng g·∫ßn c·ª≠a s·ªï', type: 'affirm', emoji: 'üëßü™ü' },
  { template: 'He ___ stand up {signal}.', subject: 'He', verb: 'stand', vn: 'Anh ·∫•y kh√¥ng ƒë·ª©ng d·∫≠y', type: 'negative', emoji: 'üë¶üö´üßç' },
  { template: 'Did she ___ there {signal}?', subject: 'she', verb: 'stand', vn: 'C√¥ ·∫•y c√≥ ƒë·ª©ng ·ªü ƒë√≥ kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüìç' },

  // SIT (ng·ªìi)
  { template: 'I ___ on the sofa {signal}.', subject: 'I', verb: 'sit', vn: 'T√¥i ng·ªìi tr√™n gh·∫ø sofa', type: 'affirm', emoji: 'üßëüõãÔ∏è' },
  { template: 'She ___ next to me {signal}.', subject: 'She', verb: 'sit', vn: 'C√¥ ·∫•y ng·ªìi c·∫°nh t√¥i', type: 'affirm', emoji: 'üëßüßë' },
  { template: 'The cat ___ on the chair {signal}.', subject: 'The cat', verb: 'sit', vn: 'Con m√®o ng·ªìi tr√™n gh·∫ø', type: 'affirm', emoji: 'üê±ü™ë' },
  { template: 'He ___ sit down {signal}.', subject: 'He', verb: 'sit', vn: 'Anh ·∫•y kh√¥ng ng·ªìi xu·ªëng', type: 'negative', emoji: 'üë¶üö´ü™ë' },
  { template: 'Did you ___ here {signal}?', subject: 'you', verb: 'sit', vn: 'B·∫°n c√≥ ng·ªìi ·ªü ƒë√¢y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëü™ë' },

  // FALL (ng√£, r∆°i)
  { template: 'I ___ down {signal}.', subject: 'I', verb: 'fall', vn: 'T√¥i b·ªã ng√£', type: 'affirm', emoji: 'üßëüí•' },
  { template: 'The leaves ___ from the tree {signal}.', subject: 'The leaves', verb: 'fall', vn: 'L√° r∆°i t·ª´ c√¢y', type: 'affirm', emoji: 'üçÇüå≥' },
  { template: 'She ___ fall asleep {signal}.', subject: 'She', verb: 'fall', vn: 'C√¥ ·∫•y kh√¥ng ng·ªß thi·∫øp ƒëi', type: 'negative', emoji: 'üëßüö´üò¥' },
  { template: 'Did he ___ off the bike {signal}?', subject: 'he', verb: 'fall', vn: 'Anh ·∫•y c√≥ ng√£ xe kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üö≤' },

  // CATCH (b·∫Øt)
  { template: 'I ___ the ball {signal}.', subject: 'I', verb: 'catch', vn: 'T√¥i b·∫Øt b√≥ng', type: 'affirm', emoji: 'üßë‚öΩ' },
  { template: 'The cat ___ a mouse {signal}.', subject: 'The cat', verb: 'catch', vn: 'Con m√®o b·∫Øt chu·ªôt', type: 'affirm', emoji: 'üê±üê≠' },
  { template: 'He ___ catch the bus {signal}.', subject: 'He', verb: 'catch', vn: 'Anh ·∫•y kh√¥ng b·∫Øt k·ªãp xe bu√Ωt', type: 'negative', emoji: 'üë¶üö´üöå' },
  { template: 'Did you ___ a cold {signal}?', subject: 'you', verb: 'catch', vn: 'B·∫°n c√≥ b·ªã c·∫£m kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëü§ß' },

  // BREAK (l√†m v·ª°)
  { template: 'I ___ the glass {signal}.', subject: 'I', verb: 'break', vn: 'T√¥i l√†m v·ª° ly', type: 'affirm', emoji: 'üßëü•õüíî' },
  { template: 'He ___ his toy {signal}.', subject: 'He', verb: 'break', vn: 'Anh ·∫•y l√†m h·ªèng ƒë·ªì ch∆°i', type: 'affirm', emoji: 'üë¶üß∏üíî' },
  { template: 'She ___ break the rules {signal}.', subject: 'She', verb: 'break', vn: 'C√¥ ·∫•y kh√¥ng ph√° lu·∫≠t', type: 'negative', emoji: 'üëßüö´üìú' },
  { template: 'Did you ___ it {signal}?', subject: 'you', verb: 'break', vn: 'B·∫°n c√≥ l√†m v·ª° n√≥ kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüíî' },

  // === NH√ìM 3: PH·ªî BI·∫æN ===

  // HOLD (c·∫ßm, gi·ªØ)
  { template: 'I ___ the baby {signal}.', subject: 'I', verb: 'hold', vn: 'T√¥i b·∫ø em b√©', type: 'affirm', emoji: 'üßëüë∂' },
  { template: 'She ___ my hand {signal}.', subject: 'She', verb: 'hold', vn: 'C√¥ ·∫•y n·∫Øm tay t√¥i', type: 'affirm', emoji: 'üëßü§ù' },
  { template: 'He ___ hold the door {signal}.', subject: 'He', verb: 'hold', vn: 'Anh ·∫•y kh√¥ng gi·ªØ c·ª≠a', type: 'negative', emoji: 'üë¶üö´üö™' },
  { template: 'Did you ___ it tight {signal}?', subject: 'you', verb: 'hold', vn: 'B·∫°n c√≥ gi·ªØ ch·∫∑t n√≥ kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßë‚úä' },

  // DRAW (v·∫Ω)
  { template: 'I ___ a picture {signal}.', subject: 'I', verb: 'draw', vn: 'T√¥i v·∫Ω m·ªôt b·ª©c tranh', type: 'affirm', emoji: 'üßëüé®' },
  { template: 'She ___ a cat {signal}.', subject: 'She', verb: 'draw', vn: 'C√¥ ·∫•y v·∫Ω con m√®o', type: 'affirm', emoji: 'üëßüê±' },
  { template: 'He ___ draw well {signal}.', subject: 'He', verb: 'draw', vn: 'Anh ·∫•y kh√¥ng v·∫Ω gi·ªèi', type: 'negative', emoji: 'üë¶üö´üé®' },
  { template: 'Did you ___ this {signal}?', subject: 'you', verb: 'draw', vn: 'B·∫°n c√≥ v·∫Ω c√°i n√†y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüñºÔ∏è' },

  // THROW (n√©m)
  { template: 'I ___ the ball {signal}.', subject: 'I', verb: 'throw', vn: 'T√¥i n√©m b√≥ng', type: 'affirm', emoji: 'üßë‚öæ' },
  { template: 'He ___ the trash away {signal}.', subject: 'He', verb: 'throw', vn: 'Anh ·∫•y v·ª©t r√°c', type: 'affirm', emoji: 'üë¶üóëÔ∏è' },
  { template: 'She ___ throw things {signal}.', subject: 'She', verb: 'throw', vn: 'C√¥ ·∫•y kh√¥ng n√©m ƒë·ªì', type: 'negative', emoji: 'üëßüö´' },
  { template: 'Did you ___ it away {signal}?', subject: 'you', verb: 'throw', vn: 'B·∫°n c√≥ v·ª©t n√≥ ƒëi kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüóëÔ∏è' },

  // FLY (bay)
  { template: 'Birds ___ in the sky {signal}.', subject: 'Birds', verb: 'fly', vn: 'Chim bay tr√™n tr·ªùi', type: 'affirm', emoji: 'üê¶‚òÅÔ∏è' },
  { template: 'The plane ___ to Paris {signal}.', subject: 'The plane', verb: 'fly', vn: 'M√°y bay bay t·ªõi Paris', type: 'affirm', emoji: '‚úàÔ∏èüóº' },
  { template: 'Penguins ___ fly {signal}.', subject: 'Penguins', verb: 'fly', vn: 'Chim c√°nh c·ª•t kh√¥ng bay', type: 'negative', emoji: 'üêßüö´' },
  { template: 'Did the bird ___ away {signal}?', subject: 'the bird', verb: 'fly', vn: 'Con chim c√≥ bay ƒëi kh√¥ng?', type: 'question_verb', emoji: '‚ùìüê¶' },

  // GROW (l·ªõn l√™n, tr·ªìng)
  { template: 'The tree ___ fast {signal}.', subject: 'The tree', verb: 'grow', vn: 'C√¢y m·ªçc nhanh', type: 'affirm', emoji: 'üå≥üìà' },
  { template: 'I ___ vegetables {signal}.', subject: 'I', verb: 'grow', vn: 'T√¥i tr·ªìng rau', type: 'affirm', emoji: 'üßëü•¨' },
  { template: 'The flower ___ grow in winter {signal}.', subject: 'The flower', verb: 'grow', vn: 'Hoa kh√¥ng m·ªçc v√†o m√πa ƒë√¥ng', type: 'negative', emoji: 'üå∏üö´‚ùÑÔ∏è' },
  { template: 'Did the plant ___ well {signal}?', subject: 'the plant', verb: 'grow', vn: 'C√¢y c√≥ m·ªçc t·ªët kh√¥ng?', type: 'question_verb', emoji: '‚ùìüå±' },

  // SPEND (ti√™u, d√†nh th·ªùi gian)
  { template: 'I ___ money on books {signal}.', subject: 'I', verb: 'spend', vn: 'T√¥i ti√™u ti·ªÅn mua s√°ch', type: 'affirm', emoji: 'üßëüí∞üìö' },
  { template: 'She ___ time with her family {signal}.', subject: 'She', verb: 'spend', vn: 'C√¥ ·∫•y d√†nh th·ªùi gian v·ªõi gia ƒë√¨nh', type: 'affirm', emoji: 'üëßüë®‚Äçüë©‚Äçüëß' },
  { template: 'He ___ spend too much {signal}.', subject: 'He', verb: 'spend', vn: 'Anh ·∫•y kh√¥ng ti√™u qu√° nhi·ªÅu', type: 'negative', emoji: 'üë¶üö´üí∏' },
  { template: 'Did you ___ all your money {signal}?', subject: 'you', verb: 'spend', vn: 'B·∫°n c√≥ ti√™u h·∫øt ti·ªÅn kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüí∞' },

  // PAY (tr·∫£ ti·ªÅn)
  { template: 'I ___ for the ticket {signal}.', subject: 'I', verb: 'pay', vn: 'T√¥i tr·∫£ ti·ªÅn v√©', type: 'affirm', emoji: 'üßëüé´üíµ' },
  { template: 'She ___ the bill {signal}.', subject: 'She', verb: 'pay', vn: 'C√¥ ·∫•y tr·∫£ h√≥a ƒë∆°n', type: 'affirm', emoji: 'üëßüßæ' },
  { template: 'He ___ pay attention {signal}.', subject: 'He', verb: 'pay', vn: 'Anh ·∫•y kh√¥ng ch√∫ √Ω', type: 'negative', emoji: 'üë¶üö´üëÄ' },
  { template: 'Did you ___ him {signal}?', subject: 'you', verb: 'pay', vn: 'B·∫°n c√≥ tr·∫£ ti·ªÅn cho anh ·∫•y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüíµ' },

  // SELL (b√°n)
  { template: 'I ___ my old phone {signal}.', subject: 'I', verb: 'sell', vn: 'T√¥i b√°n ƒëi·ªán tho·∫°i c≈©', type: 'affirm', emoji: 'üßëüì±üíµ' },
  { template: 'She ___ cookies {signal}.', subject: 'She', verb: 'sell', vn: 'C√¥ ·∫•y b√°n b√°nh quy', type: 'affirm', emoji: 'üëßüç™' },
  { template: 'He ___ sell his car {signal}.', subject: 'He', verb: 'sell', vn: 'Anh ·∫•y kh√¥ng b√°n xe', type: 'negative', emoji: 'üë¶üö´üöó' },
  { template: 'Did they ___ everything {signal}?', subject: 'they', verb: 'sell', vn: 'H·ªç c√≥ b√°n h·∫øt kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®‚Äçüë©‚ÄçüëßüíØ' },

  // BUILD (x√¢y)
  { template: 'I ___ a house {signal}.', subject: 'I', verb: 'build', vn: 'T√¥i x√¢y nh√†', type: 'affirm', emoji: 'üßëüè†' },
  { template: 'He ___ a robot {signal}.', subject: 'He', verb: 'build', vn: 'Anh ·∫•y l·∫Øp robot', type: 'affirm', emoji: 'üë¶ü§ñ' },
  { template: 'They ___ build a bridge {signal}.', subject: 'They', verb: 'build', vn: 'H·ªç kh√¥ng x√¢y c·∫ßu', type: 'negative', emoji: 'üë®‚Äçüë©‚Äçüëßüö´üåâ' },
  { template: 'Did you ___ it yourself {signal}?', subject: 'you', verb: 'build', vn: 'B·∫°n c√≥ t·ª± x√¢y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüîß' },

  // CUT (c·∫Øt)
  { template: 'I ___ the paper {signal}.', subject: 'I', verb: 'cut', vn: 'T√¥i c·∫Øt gi·∫•y', type: 'affirm', emoji: 'üßëüìÑ‚úÇÔ∏è' },
  { template: 'She ___ her hair {signal}.', subject: 'She', verb: 'cut', vn: 'C√¥ ·∫•y c·∫Øt t√≥c', type: 'affirm', emoji: 'üëßüíá' },
  { template: 'He ___ cut the cake {signal}.', subject: 'He', verb: 'cut', vn: 'Anh ·∫•y kh√¥ng c·∫Øt b√°nh', type: 'negative', emoji: 'üë¶üö´üéÇ' },
  { template: 'Did you ___ it {signal}?', subject: 'you', verb: 'cut', vn: 'B·∫°n c√≥ c·∫Øt n√≥ kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßë‚úÇÔ∏è' },

  // FORGET (qu√™n)
  { template: 'I ___ my homework {signal}.', subject: 'I', verb: 'forget', vn: 'T√¥i qu√™n b√†i t·∫≠p', type: 'affirm', emoji: 'üßëüìù‚ùì' },
  { template: 'She ___ her keys {signal}.', subject: 'She', verb: 'forget', vn: 'C√¥ ·∫•y qu√™n ch√¨a kh√≥a', type: 'affirm', emoji: 'üëßüîë‚ùì' },
  { template: 'He ___ forget her birthday {signal}.', subject: 'He', verb: 'forget', vn: 'Anh ·∫•y kh√¥ng qu√™n sinh nh·∫≠t c√¥ ·∫•y', type: 'negative', emoji: 'üë¶üö´üéÇ' },
  { template: 'Did you ___ to call {signal}?', subject: 'you', verb: 'forget', vn: 'B·∫°n c√≥ qu√™n g·ªçi kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüìû' },

  // CHOOSE (ch·ªçn)
  { template: 'I ___ the red one {signal}.', subject: 'I', verb: 'choose', vn: 'T√¥i ch·ªçn c√°i m√†u ƒë·ªè', type: 'affirm', emoji: 'üßëüî¥' },
  { template: 'She ___ a new dress {signal}.', subject: 'She', verb: 'choose', vn: 'C√¥ ·∫•y ch·ªçn v√°y m·ªõi', type: 'affirm', emoji: 'üëßüëó' },
  { template: 'He ___ choose wisely {signal}.', subject: 'He', verb: 'choose', vn: 'Anh ·∫•y kh√¥ng ch·ªçn kh√¥n ngoan', type: 'negative', emoji: 'üë¶üö´ü§î' },
  { template: 'Did you ___ already {signal}?', subject: 'you', verb: 'choose', vn: 'B·∫°n c√≥ ch·ªçn r·ªìi kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßë‚úì' },

  // DRIVE (l√°i xe)
  { template: 'Dad ___ to work {signal}.', subject: 'Dad', verb: 'drive', vn: 'B·ªë l√°i xe ƒëi l√†m', type: 'affirm', emoji: 'üë®üöóüíº' },
  { template: 'She ___ a bus {signal}.', subject: 'She', verb: 'drive', vn: 'C√¥ ·∫•y l√°i xe bu√Ωt', type: 'affirm', emoji: 'üë©üöå' },
  { template: 'I ___ drive fast {signal}.', subject: 'I', verb: 'drive', vn: 'T√¥i kh√¥ng l√°i nhanh', type: 'negative', emoji: 'üßëüö´üèéÔ∏è' },
  { template: 'Did he ___ you home {signal}?', subject: 'he', verb: 'drive', vn: 'Anh ·∫•y c√≥ ch·ªü b·∫°n v·ªÅ kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üöóüè†' },

  // KEEP (gi·ªØ)
  { template: 'I ___ my promise {signal}.', subject: 'I', verb: 'keep', vn: 'T√¥i gi·ªØ l·ªùi h·ª©a', type: 'affirm', emoji: 'üßëü§ù' },
  { template: 'She ___ a diary {signal}.', subject: 'She', verb: 'keep', vn: 'C√¥ ·∫•y vi·∫øt nh·∫≠t k√Ω', type: 'affirm', emoji: 'üëßüìî' },
  { template: 'He ___ keep secrets {signal}.', subject: 'He', verb: 'keep', vn: 'Anh ·∫•y kh√¥ng gi·ªØ b√≠ m·∫≠t', type: 'negative', emoji: 'üë¶üö´ü§´' },
  { template: 'Did you ___ it safe {signal}?', subject: 'you', verb: 'keep', vn: 'B·∫°n c√≥ gi·ªØ n√≥ an to√†n kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüîí' },

  // WAKE (th·ª©c d·∫≠y)
  { template: 'I ___ up early {signal}.', subject: 'I', verb: 'wake', vn: 'T√¥i th·ª©c d·∫≠y s·ªõm', type: 'affirm', emoji: 'üßë‚è∞‚òÄÔ∏è' },
  { template: 'She ___ up at 6 AM {signal}.', subject: 'She', verb: 'wake', vn: 'C√¥ ·∫•y th·ª©c d·∫≠y l√∫c 6 gi·ªù', type: 'affirm', emoji: 'üëßüåÖ' },
  { template: 'He ___ wake up late {signal}.', subject: 'He', verb: 'wake', vn: 'Anh ·∫•y kh√¥ng d·∫≠y mu·ªôn', type: 'negative', emoji: 'üë¶üö´üò¥' },
  { template: 'Did the alarm ___ you up {signal}?', subject: 'the alarm', verb: 'wake', vn: 'ƒê·ªìng h·ªì b√°o c√≥ ƒë√°nh th·ª©c b·∫°n kh√¥ng?', type: 'question_verb', emoji: '‚ùì‚è∞üßë' },

  // UNDERSTAND (hi·ªÉu)
  { template: 'I ___ the lesson {signal}.', subject: 'I', verb: 'understand', vn: 'T√¥i hi·ªÉu b√†i', type: 'affirm', emoji: 'üßëüí°' },
  { template: 'She ___ English {signal}.', subject: 'She', verb: 'understand', vn: 'C√¥ ·∫•y hi·ªÉu ti·∫øng Anh', type: 'affirm', emoji: 'üëßüá¨üáß' },
  { template: 'He ___ understand math {signal}.', subject: 'He', verb: 'understand', vn: 'Anh ·∫•y kh√¥ng hi·ªÉu to√°n', type: 'negative', emoji: 'üë¶üö´üî¢' },
  { template: 'Did you ___ me {signal}?', subject: 'you', verb: 'understand', vn: 'B·∫°n c√≥ hi·ªÉu t√¥i kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüëÇ' },

  // HEAR (nghe th·∫•y)
  { template: 'I ___ a noise {signal}.', subject: 'I', verb: 'hear', vn: 'T√¥i nghe th·∫•y ti·∫øng ƒë·ªông', type: 'affirm', emoji: 'üßëüëÇüîä' },
  { template: 'She ___ the music {signal}.', subject: 'She', verb: 'hear', vn: 'C√¥ ·∫•y nghe th·∫•y nh·∫°c', type: 'affirm', emoji: 'üëßüéµ' },
  { template: 'He ___ hear anything {signal}.', subject: 'He', verb: 'hear', vn: 'Anh ·∫•y kh√¥ng nghe th·∫•y g√¨', type: 'negative', emoji: 'üë¶üö´üëÇ' },
  { template: 'Did you ___ that {signal}?', subject: 'you', verb: 'hear', vn: 'B·∫°n c√≥ nghe th·∫•y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüëÇ' },

  // BEGIN (b·∫Øt ƒë·∫ßu)
  { template: 'The class ___ at 8 AM {signal}.', subject: 'The class', verb: 'begin', vn: 'L·ªõp h·ªçc b·∫Øt ƒë·∫ßu l√∫c 8 gi·ªù', type: 'affirm', emoji: 'üìö‚è∞' },
  { template: 'The movie ___ now {signal}.', subject: 'The movie', verb: 'begin', vn: 'Phim b·∫Øt ƒë·∫ßu b√¢y gi·ªù', type: 'affirm', emoji: 'üé¨‚ñ∂Ô∏è' },
  { template: 'The show ___ begin yet {signal}.', subject: 'The show', verb: 'begin', vn: 'Ch∆∞∆°ng tr√¨nh ch∆∞a b·∫Øt ƒë·∫ßu', type: 'negative', emoji: 'üì∫üö´' },
  { template: 'Did the game ___ {signal}?', subject: 'the game', verb: 'begin', vn: 'Tr·∫≠n ƒë·∫•u c√≥ b·∫Øt ƒë·∫ßu ch∆∞a?', type: 'question_verb', emoji: '‚ùìüéÆ‚ñ∂Ô∏è' },

  // BITE (c·∫Øn)
  { template: 'The dog ___ me {signal}.', subject: 'The dog', verb: 'bite', vn: 'Con ch√≥ c·∫Øn t√¥i', type: 'affirm', emoji: 'üêïüò¨' },
  { template: 'The mosquito ___ her {signal}.', subject: 'The mosquito', verb: 'bite', vn: 'Con mu·ªói ƒë·ªët c√¥ ·∫•y', type: 'affirm', emoji: 'ü¶üüëß' },
  { template: 'My dog ___ bite people {signal}.', subject: 'My dog', verb: 'bite', vn: 'Ch√≥ c·ªßa t√¥i kh√¥ng c·∫Øn ng∆∞·ªùi', type: 'negative', emoji: 'üêïüö´' },
  { template: 'Did it ___ you {signal}?', subject: 'it', verb: 'bite', vn: 'N√≥ c√≥ c·∫Øn b·∫°n kh√¥ng?', type: 'question_verb', emoji: '‚ùìüò¨' },

  // RIDE (c∆∞·ª°i, ƒëi xe)
  { template: 'I ___ a bike {signal}.', subject: 'I', verb: 'ride', vn: 'T√¥i ƒë·∫°p xe', type: 'affirm', emoji: 'üßëüö≤' },
  { template: 'She ___ a horse {signal}.', subject: 'She', verb: 'ride', vn: 'C√¥ ·∫•y c∆∞·ª°i ng·ª±a', type: 'affirm', emoji: 'üëßüêé' },
  { template: 'He ___ ride without a helmet {signal}.', subject: 'He', verb: 'ride', vn: 'Anh ·∫•y kh√¥ng ƒëi xe kh√¥ng m≈©', type: 'negative', emoji: 'üë¶üö´‚õëÔ∏è' },
  { template: 'Did you ___ a motorcycle {signal}?', subject: 'you', verb: 'ride', vn: 'B·∫°n c√≥ ƒëi xe m√°y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüèçÔ∏è' },

  // SHAKE (l·∫Øc)
  { template: 'I ___ hands with him {signal}.', subject: 'I', verb: 'shake', vn: 'T√¥i b·∫Øt tay anh ·∫•y', type: 'affirm', emoji: 'üßëü§ù' },
  { template: 'The earthquake ___ the building {signal}.', subject: 'The earthquake', verb: 'shake', vn: 'ƒê·ªông ƒë·∫•t l√†m rung t√≤a nh√†', type: 'affirm', emoji: 'üåçüè¢' },
  { template: 'She ___ shake the bottle {signal}.', subject: 'She', verb: 'shake', vn: 'C√¥ ·∫•y kh√¥ng l·∫Øc chai', type: 'negative', emoji: 'üëßüö´üçº' },
  { template: 'Did you ___ the tree {signal}?', subject: 'you', verb: 'shake', vn: 'B·∫°n c√≥ l·∫Øc c√¢y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüå≥' },

  // HIDE (gi·∫•u, tr·ªën)
  { template: 'I ___ under the bed {signal}.', subject: 'I', verb: 'hide', vn: 'T√¥i tr·ªën d∆∞·ªõi gi∆∞·ªùng', type: 'affirm', emoji: 'üßëüõèÔ∏è' },
  { template: 'She ___ her diary {signal}.', subject: 'She', verb: 'hide', vn: 'C√¥ ·∫•y gi·∫•u nh·∫≠t k√Ω', type: 'affirm', emoji: 'üëßüìîüîí' },
  { template: 'He ___ hide anything {signal}.', subject: 'He', verb: 'hide', vn: 'Anh ·∫•y kh√¥ng gi·∫•u g√¨', type: 'negative', emoji: 'üë¶üö´' },
  { template: 'Did they ___ the treasure {signal}?', subject: 'they', verb: 'hide', vn: 'H·ªç c√≥ gi·∫•u kho b√°u kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë®‚Äçüë©‚Äçüëßüíé' },

  // HURT (l√†m ƒëau)
  { template: 'I ___ my leg {signal}.', subject: 'I', verb: 'hurt', vn: 'T√¥i b·ªã ƒëau ch√¢n', type: 'affirm', emoji: 'üßëü¶µüò£' },
  { template: 'She ___ her arm {signal}.', subject: 'She', verb: 'hurt', vn: 'C√¥ ·∫•y b·ªã ƒëau tay', type: 'affirm', emoji: 'üëßüí™üò£' },
  { template: 'I ___ hurt anyone {signal}.', subject: 'I', verb: 'hurt', vn: 'T√¥i kh√¥ng l√†m ƒëau ai', type: 'negative', emoji: 'üßëüö´' },
  { template: 'Did it ___ {signal}?', subject: 'it', verb: 'hurt', vn: 'N√≥ c√≥ ƒëau kh√¥ng?', type: 'question_verb', emoji: '‚ùìüò£' },

  // COST (t·ªën, gi√°)
  { template: 'The book ___ $10 {signal}.', subject: 'The book', verb: 'cost', vn: 'Cu·ªën s√°ch gi√° 10 ƒë√¥', type: 'affirm', emoji: 'üìöüíµ' },
  { template: 'The trip ___ a lot of money {signal}.', subject: 'The trip', verb: 'cost', vn: 'Chuy·∫øn ƒëi t·ªën nhi·ªÅu ti·ªÅn', type: 'affirm', emoji: '‚úàÔ∏èüí∞' },
  { template: 'It ___ cost much {signal}.', subject: 'It', verb: 'cost', vn: 'N√≥ kh√¥ng t·ªën nhi·ªÅu', type: 'negative', emoji: 'üö´üí∏' },
  { template: 'How much did it ___ {signal}?', subject: 'it', verb: 'cost', vn: 'N√≥ gi√° bao nhi√™u?', type: 'question_verb', emoji: '‚ùìüíµ' },

  // FEED (cho ƒÉn)
  { template: 'I ___ the dog {signal}.', subject: 'I', verb: 'feed', vn: 'T√¥i cho ch√≥ ƒÉn', type: 'affirm', emoji: 'üßëüêïüçñ' },
  { template: 'She ___ the cat {signal}.', subject: 'She', verb: 'feed', vn: 'C√¥ ·∫•y cho m√®o ƒÉn', type: 'affirm', emoji: 'üëßüê±üêü' },
  { template: 'He ___ feed the birds {signal}.', subject: 'He', verb: 'feed', vn: 'Anh ·∫•y kh√¥ng cho chim ƒÉn', type: 'negative', emoji: 'üë¶üö´üê¶' },
  { template: 'Did you ___ the fish {signal}?', subject: 'you', verb: 'feed', vn: 'B·∫°n c√≥ cho c√° ƒÉn kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüêü' },

  // LET (cho ph√©p)
  { template: 'Mom ___ me go out {signal}.', subject: 'Mom', verb: 'let', vn: 'M·∫π cho t√¥i ra ngo√†i', type: 'affirm', emoji: 'üë©üßëüö™' },
  { template: 'She ___ him play {signal}.', subject: 'She', verb: 'let', vn: 'C√¥ ·∫•y cho anh ·∫•y ch∆°i', type: 'affirm', emoji: 'üëßüë¶üéÆ' },
  { template: 'Dad ___ let me stay up late {signal}.', subject: 'Dad', verb: 'let', vn: 'B·ªë kh√¥ng cho t√¥i th·ª©c khuya', type: 'negative', emoji: 'üë®üö´üåô' },
  { template: 'Did she ___ you in {signal}?', subject: 'she', verb: 'let', vn: 'C√¥ ·∫•y c√≥ cho b·∫°n v√†o kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüö™' },

  // MEAN (c√≥ nghƒ©a l√†)
  { template: 'This word ___ "happy" {signal}.', subject: 'This word', verb: 'mean', vn: 'T·ª´ n√†y c√≥ nghƒ©a l√† "vui"', type: 'affirm', emoji: 'üìùüòä' },
  { template: 'I ___ what I said {signal}.', subject: 'I', verb: 'mean', vn: 'T√¥i n√≥i th·∫≠t l√≤ng', type: 'affirm', emoji: 'üßëüí¨' },
  { template: 'I ___ mean to hurt you {signal}.', subject: 'I', verb: 'mean', vn: 'T√¥i kh√¥ng c·ªë √Ω l√†m b·∫°n ƒëau', type: 'negative', emoji: 'üßëüö´üò¢' },
  { template: 'What did you ___ {signal}?', subject: 'you', verb: 'mean', vn: 'B·∫°n mu·ªën n√≥i g√¨?', type: 'question_verb', emoji: '‚ùìüßë‚ùî' },

  // LEARN (h·ªçc)
  { template: 'I ___ English {signal}.', subject: 'I', verb: 'learn', vn: 'T√¥i h·ªçc ti·∫øng Anh', type: 'affirm', emoji: 'üßëüá¨üáß' },
  { template: 'She ___ to swim {signal}.', subject: 'She', verb: 'learn', vn: 'C√¥ ·∫•y h·ªçc b∆°i', type: 'affirm', emoji: 'üëßüèä' },
  { template: 'He ___ learn quickly {signal}.', subject: 'He', verb: 'learn', vn: 'Anh ·∫•y kh√¥ng h·ªçc nhanh', type: 'negative', emoji: 'üë¶üö´üìö' },
  { template: 'Did you ___ something new {signal}?', subject: 'you', verb: 'learn', vn: 'B·∫°n c√≥ h·ªçc ƒë∆∞·ª£c g√¨ m·ªõi kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüí°' },

  // =============== B·ªî SUNG ƒê·ª¶ 93 ƒê·ªòNG T·ª™ ===============

  // BE (l√†, ·ªü) - ƒê√É LO·∫†I B·ªé v√¨ qu√° ƒë·∫∑c bi·ªát (am/is/are/was/were), d·∫°y ri√™ng trong ph·∫ßn h·ªçc

  // BECOME (tr·ªü th√†nh)
  { template: 'He ___ a doctor {signal}.', subject: 'He', verb: 'become', vn: 'Anh ·∫•y tr·ªü th√†nh b√°c sƒ©', type: 'affirm', emoji: 'üë¶üë®‚Äç‚öïÔ∏è' },
  { template: 'She ___ famous {signal}.', subject: 'She', verb: 'become', vn: 'C√¥ ·∫•y tr·ªü n√™n n·ªïi ti·∫øng', type: 'affirm', emoji: 'üëß‚≠ê' },
  { template: 'I ___ become angry {signal}.', subject: 'I', verb: 'become', vn: 'T√¥i kh√¥ng tr·ªü n√™n t·ª©c gi·∫≠n', type: 'negative', emoji: 'üßëüö´üò†' },
  { template: 'Did he ___ a teacher {signal}?', subject: 'he', verb: 'become', vn: 'Anh ·∫•y c√≥ tr·ªü th√†nh gi√°o vi√™n kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üë®‚Äçüè´' },

  // BLEED (ch·∫£y m√°u)
  { template: 'My finger ___ {signal}.', subject: 'My finger', verb: 'bleed', vn: 'Ng√≥n tay t√¥i ch·∫£y m√°u', type: 'affirm', emoji: 'ü©∏üëÜ' },
  { template: 'His nose ___ {signal}.', subject: 'His nose', verb: 'bleed', vn: 'M≈©i anh ·∫•y ch·∫£y m√°u', type: 'affirm', emoji: 'üëÉü©∏' },
  { template: 'The wound ___ bleed anymore {signal}.', subject: 'The wound', verb: 'bleed', vn: 'V·∫øt th∆∞∆°ng kh√¥ng ch·∫£y m√°u n·ªØa', type: 'negative', emoji: 'ü©πüö´ü©∏' },
  { template: 'Did it ___ a lot {signal}?', subject: 'it', verb: 'bleed', vn: 'N√≥ c√≥ ch·∫£y m√°u nhi·ªÅu kh√¥ng?', type: 'question_verb', emoji: '‚ùìü©∏' },

  // BLOW (th·ªïi)
  { template: 'The wind ___ hard {signal}.', subject: 'The wind', verb: 'blow', vn: 'Gi√≥ th·ªïi m·∫°nh', type: 'affirm', emoji: 'üí®üå¨Ô∏è' },
  { template: 'She ___ out the candles {signal}.', subject: 'She', verb: 'blow', vn: 'C√¥ ·∫•y th·ªïi t·∫Øt n·∫øn', type: 'affirm', emoji: 'üëßüéÇüïØÔ∏è' },
  { template: 'I ___ blow bubbles {signal}.', subject: 'I', verb: 'blow', vn: 'T√¥i kh√¥ng th·ªïi bong b√≥ng', type: 'negative', emoji: 'üßëüö´ü´ß' },
  { template: 'Did the wind ___ your hat away {signal}?', subject: 'the wind', verb: 'blow', vn: 'Gi√≥ c√≥ th·ªïi bay m≈© kh√¥ng?', type: 'question_verb', emoji: '‚ùìüí®üé©' },

  // BURN (ƒë·ªët, ch√°y)
  { template: 'The fire ___ brightly {signal}.', subject: 'The fire', verb: 'burn', vn: 'L·ª≠a ch√°y s√°ng', type: 'affirm', emoji: 'üî•‚ú®' },
  { template: 'I ___ the toast {signal}.', subject: 'I', verb: 'burn', vn: 'T√¥i l√†m ch√°y b√°nh m√¨', type: 'affirm', emoji: 'üßëüçûüî•' },
  { template: 'She ___ burn the food {signal}.', subject: 'She', verb: 'burn', vn: 'C√¥ ·∫•y kh√¥ng l√†m ch√°y ƒë·ªì ƒÉn', type: 'negative', emoji: 'üëßüö´üî•' },
  { template: 'Did you ___ yourself {signal}?', subject: 'you', verb: 'burn', vn: 'B·∫°n c√≥ b·ªã b·ªèng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüî•' },

  // DREAM (m∆°)
  { template: 'I ___ about flying {signal}.', subject: 'I', verb: 'dream', vn: 'T√¥i m∆° v·ªÅ vi·ªác bay', type: 'affirm', emoji: 'üßëüí≠‚úàÔ∏è' },
  { template: 'She ___ of becoming a singer {signal}.', subject: 'She', verb: 'dream', vn: 'C√¥ ·∫•y m∆° tr·ªü th√†nh ca sƒ©', type: 'affirm', emoji: 'üëßüí≠üé§' },
  { template: 'He ___ dream last night {signal}.', subject: 'He', verb: 'dream', vn: 'Anh ·∫•y kh√¥ng m∆° t·ªëi qua', type: 'negative', emoji: 'üë¶üö´üí≠' },
  { template: 'Did you ___ about me {signal}?', subject: 'you', verb: 'dream', vn: 'B·∫°n c√≥ m∆° v·ªÅ t√¥i kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüí≠' },

  // FIGHT (ƒë√°nh nhau, chi·∫øn ƒë·∫•u)
  { template: 'The boys ___ at school {signal}.', subject: 'The boys', verb: 'fight', vn: 'C√°c c·∫≠u b√© ƒë√°nh nhau ·ªü tr∆∞·ªùng', type: 'affirm', emoji: 'üë¶üë¶üí•' },
  { template: 'They ___ for freedom {signal}.', subject: 'They', verb: 'fight', vn: 'H·ªç chi·∫øn ƒë·∫•u v√¨ t·ª± do', type: 'affirm', emoji: 'üë®‚Äçüë©‚Äçüëß‚úä' },
  { template: 'I ___ fight with my sister {signal}.', subject: 'I', verb: 'fight', vn: 'T√¥i kh√¥ng c√£i nhau v·ªõi ch·ªã', type: 'negative', emoji: 'üßëüö´üëß' },
  { template: 'Did they ___ again {signal}?', subject: 'they', verb: 'fight', vn: 'H·ªç c√≥ ƒë√°nh nhau l·∫°i kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üë¶' },

  // FORGIVE (tha th·ª©)
  { template: 'I ___ him {signal}.', subject: 'I', verb: 'forgive', vn: 'T√¥i tha th·ª© cho anh ·∫•y', type: 'affirm', emoji: 'üßëü§ùüë¶' },
  { template: 'She ___ her friend {signal}.', subject: 'She', verb: 'forgive', vn: 'C√¥ ·∫•y tha th·ª© cho b·∫°n', type: 'affirm', emoji: 'üëßü§ù' },
  { template: 'He ___ forgive easily {signal}.', subject: 'He', verb: 'forgive', vn: 'Anh ·∫•y kh√¥ng tha th·ª© d·ªÖ d√†ng', type: 'negative', emoji: 'üë¶üö´' },
  { template: 'Did she ___ you {signal}?', subject: 'she', verb: 'forgive', vn: 'C√¥ ·∫•y c√≥ tha th·ª© cho b·∫°n kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßü§ù' },

  // FREEZE (ƒë√¥ng l·∫°i)
  { template: 'Water ___ at 0¬∞C {signal}.', subject: 'Water', verb: 'freeze', vn: 'N∆∞·ªõc ƒë√≥ng bƒÉng ·ªü 0¬∞C', type: 'affirm', emoji: 'üíß‚ùÑÔ∏è' },
  { template: 'I ___ in the cold {signal}.', subject: 'I', verb: 'freeze', vn: 'T√¥i b·ªã l·∫°nh c√≥ng', type: 'affirm', emoji: 'üßëü•∂' },
  { template: 'The lake ___ freeze this winter {signal}.', subject: 'The lake', verb: 'freeze', vn: 'H·ªì kh√¥ng ƒë√≥ng bƒÉng m√πa ƒë√¥ng n√†y', type: 'negative', emoji: 'üèûÔ∏èüö´‚ùÑÔ∏è' },
  { template: 'Did the pipes ___ {signal}?', subject: 'the pipes', verb: 'freeze', vn: '·ªêng n∆∞·ªõc c√≥ b·ªã ƒë√≥ng bƒÉng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüö∞‚ùÑÔ∏è' },

  // HANG (treo)
  { template: 'I ___ the picture on the wall {signal}.', subject: 'I', verb: 'hang', vn: 'T√¥i treo tranh l√™n t∆∞·ªùng', type: 'affirm', emoji: 'üßëüñºÔ∏è' },
  { template: 'She ___ her coat {signal}.', subject: 'She', verb: 'hang', vn: 'C√¥ ·∫•y treo √°o kho√°c', type: 'affirm', emoji: 'üëßüß•' },
  { template: 'He ___ hang out with friends {signal}.', subject: 'He', verb: 'hang', vn: 'Anh ·∫•y kh√¥ng ƒëi ch∆°i v·ªõi b·∫°n', type: 'negative', emoji: 'üë¶üö´üë´' },
  { template: 'Did you ___ the clothes {signal}?', subject: 'you', verb: 'hang', vn: 'B·∫°n c√≥ ph∆°i qu·∫ßn √°o kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüëï' },

  // HIT (ƒë√°nh, va ch·∫°m)
  { template: 'The ball ___ the window {signal}.', subject: 'The ball', verb: 'hit', vn: 'B√≥ng va v√†o c·ª≠a s·ªï', type: 'affirm', emoji: '‚öΩü™ü' },
  { template: 'He ___ the ball hard {signal}.', subject: 'He', verb: 'hit', vn: 'Anh ·∫•y ƒë√°nh b√≥ng m·∫°nh', type: 'affirm', emoji: 'üë¶‚öæ' },
  { template: 'I ___ hit anyone {signal}.', subject: 'I', verb: 'hit', vn: 'T√¥i kh√¥ng ƒë√°nh ai', type: 'negative', emoji: 'üßëüö´üëä' },
  { template: 'Did the car ___ the tree {signal}?', subject: 'the car', verb: 'hit', vn: 'Xe c√≥ ƒë√¢m v√†o c√¢y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüöóüå≥' },

  // LAY (ƒë·∫∑t, ƒë·ªÉ)
  { template: 'I ___ the book on the desk {signal}.', subject: 'I', verb: 'lay', vn: 'T√¥i ƒë·∫∑t s√°ch l√™n b√†n', type: 'affirm', emoji: 'üßëüìö' },
  { template: 'The hen ___ eggs {signal}.', subject: 'The hen', verb: 'lay', vn: 'Con g√† m√°i ƒë·∫ª tr·ª©ng', type: 'affirm', emoji: 'üêîü•ö' },
  { template: 'She ___ lay the table {signal}.', subject: 'She', verb: 'lay', vn: 'C√¥ ·∫•y kh√¥ng d·ªçn b√†n', type: 'negative', emoji: 'üëßüö´üçΩÔ∏è' },
  { template: 'Did you ___ the baby down {signal}?', subject: 'you', verb: 'lay', vn: 'B·∫°n c√≥ ƒë·∫∑t em b√© xu·ªëng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüë∂' },

  // LEND (cho m∆∞·ª£n)
  { template: 'I ___ him my bike {signal}.', subject: 'I', verb: 'lend', vn: 'T√¥i cho anh ·∫•y m∆∞·ª£n xe', type: 'affirm', emoji: 'üßëüö≤üë¶' },
  { template: 'She ___ me money {signal}.', subject: 'She', verb: 'lend', vn: 'C√¥ ·∫•y cho t√¥i m∆∞·ª£n ti·ªÅn', type: 'affirm', emoji: 'üëßüíµüßë' },
  { template: 'He ___ lend his phone {signal}.', subject: 'He', verb: 'lend', vn: 'Anh ·∫•y kh√¥ng cho m∆∞·ª£n ƒëi·ªán tho·∫°i', type: 'negative', emoji: 'üë¶üö´üì±' },
  { template: 'Did you ___ her your book {signal}?', subject: 'you', verb: 'lend', vn: 'B·∫°n c√≥ cho c√¥ ·∫•y m∆∞·ª£n s√°ch kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüìöüëß' },

  // LIE (n·∫±m)
  { template: 'I ___ on the bed {signal}.', subject: 'I', verb: 'lie', vn: 'T√¥i n·∫±m tr√™n gi∆∞·ªùng', type: 'affirm', emoji: 'üßëüõèÔ∏è' },
  { template: 'The cat ___ on the sofa {signal}.', subject: 'The cat', verb: 'lie', vn: 'Con m√®o n·∫±m tr√™n gh·∫ø sofa', type: 'affirm', emoji: 'üê±üõãÔ∏è' },
  { template: 'He ___ lie down {signal}.', subject: 'He', verb: 'lie', vn: 'Anh ·∫•y kh√¥ng n·∫±m xu·ªëng', type: 'negative', emoji: 'üë¶üö´üõèÔ∏è' },
  { template: 'Did she ___ on the grass {signal}?', subject: 'she', verb: 'lie', vn: 'C√¥ ·∫•y c√≥ n·∫±m tr√™n c·ªè kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëßüåø' },

  // LIGHT (th·∫Øp, b·∫≠t ƒë√®n)
  { template: 'I ___ the candle {signal}.', subject: 'I', verb: 'light', vn: 'T√¥i th·∫Øp n·∫øn', type: 'affirm', emoji: 'üßëüïØÔ∏è' },
  { template: 'She ___ the fire {signal}.', subject: 'She', verb: 'light', vn: 'C√¥ ·∫•y nh√≥m l·ª≠a', type: 'affirm', emoji: 'üëßüî•' },
  { template: 'He ___ light a match {signal}.', subject: 'He', verb: 'light', vn: 'Anh ·∫•y kh√¥ng ƒë·ªët di√™m', type: 'negative', emoji: 'üë¶üö´üî•' },
  { template: 'Did you ___ the lamp {signal}?', subject: 'you', verb: 'light', vn: 'B·∫°n c√≥ b·∫≠t ƒë√®n kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüí°' },

  // RING (reo, rung chu√¥ng)
  { template: 'The phone ___ {signal}.', subject: 'The phone', verb: 'ring', vn: 'ƒêi·ªán tho·∫°i reo', type: 'affirm', emoji: 'üì±üîî' },
  { template: 'The doorbell ___ {signal}.', subject: 'The doorbell', verb: 'ring', vn: 'Chu√¥ng c·ª≠a reo', type: 'affirm', emoji: 'üö™üîî' },
  { template: 'The alarm ___ ring this morning {signal}.', subject: 'The alarm', verb: 'ring', vn: 'ƒê·ªìng h·ªì b√°o kh√¥ng reo s√°ng nay', type: 'negative', emoji: '‚è∞üö´üîî' },
  { template: 'Did the bell ___ {signal}?', subject: 'the bell', verb: 'ring', vn: 'Chu√¥ng c√≥ reo kh√¥ng?', type: 'question_verb', emoji: '‚ùìüîî' },

  // RISE (m·ªçc l√™n, tƒÉng)
  { template: 'The sun ___ in the east {signal}.', subject: 'The sun', verb: 'rise', vn: 'M·∫∑t tr·ªùi m·ªçc ·ªü ph√≠a ƒë√¥ng', type: 'affirm', emoji: 'üåÖ‚òÄÔ∏è' },
  { template: 'Prices ___ every year {signal}.', subject: 'Prices', verb: 'rise', vn: 'Gi√° tƒÉng m·ªói nƒÉm', type: 'affirm', emoji: 'üíµüìà' },
  { template: 'The temperature ___ rise much {signal}.', subject: 'The temperature', verb: 'rise', vn: 'Nhi·ªát ƒë·ªô kh√¥ng tƒÉng nhi·ªÅu', type: 'negative', emoji: 'üå°Ô∏èüö´üìà' },
  { template: 'Did the water level ___ {signal}?', subject: 'the water level', verb: 'rise', vn: 'M·ª±c n∆∞·ªõc c√≥ tƒÉng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüíßüìà' },

  // SHINE (t·ªèa s√°ng)
  { template: 'The sun ___ brightly {signal}.', subject: 'The sun', verb: 'shine', vn: 'M·∫∑t tr·ªùi chi·∫øu s√°ng', type: 'affirm', emoji: '‚òÄÔ∏è‚ú®' },
  { template: 'The stars ___ at night {signal}.', subject: 'The stars', verb: 'shine', vn: 'Sao s√°ng v√†o ban ƒë√™m', type: 'affirm', emoji: '‚≠êüåô' },
  { template: 'The moon ___ shine tonight {signal}.', subject: 'The moon', verb: 'shine', vn: 'TrƒÉng kh√¥ng s√°ng t·ªëi nay', type: 'negative', emoji: 'üåôüö´‚ú®' },
  { template: 'Did the light ___ through the window {signal}?', subject: 'the light', verb: 'shine', vn: '√Ånh s√°ng c√≥ chi·∫øu qua c·ª≠a s·ªï kh√¥ng?', type: 'question_verb', emoji: '‚ùìüí°ü™ü' },

  // SHOOT (b·∫Øn)
  { template: 'He ___ the ball into the goal {signal}.', subject: 'He', verb: 'shoot', vn: 'Anh ·∫•y s√∫t b√≥ng v√†o g√¥n', type: 'affirm', emoji: 'üë¶‚öΩü•Ö' },
  { template: 'The hunter ___ the arrow {signal}.', subject: 'The hunter', verb: 'shoot', vn: 'Th·ª£ sƒÉn b·∫Øn m≈©i t√™n', type: 'affirm', emoji: 'üèπüéØ' },
  { template: 'I ___ shoot well {signal}.', subject: 'I', verb: 'shoot', vn: 'T√¥i kh√¥ng b·∫Øn gi·ªèi', type: 'negative', emoji: 'üßëüö´üéØ' },
  { template: 'Did he ___ the basket {signal}?', subject: 'he', verb: 'shoot', vn: 'Anh ·∫•y c√≥ n√©m r·ªï kh√¥ng?', type: 'question_verb', emoji: '‚ùìüë¶üèÄ' },

  // SHOW (cho xem, ch·ªâ)
  { template: 'I ___ him my photos {signal}.', subject: 'I', verb: 'show', vn: 'T√¥i cho anh ·∫•y xem ·∫£nh', type: 'affirm', emoji: 'üßëüì∏üë¶' },
  { template: 'She ___ me the way {signal}.', subject: 'She', verb: 'show', vn: 'C√¥ ·∫•y ch·ªâ ƒë∆∞·ªùng cho t√¥i', type: 'affirm', emoji: 'üëßüó∫Ô∏èüßë' },
  { template: 'He ___ show his feelings {signal}.', subject: 'He', verb: 'show', vn: 'Anh ·∫•y kh√¥ng b·ªôc l·ªô c·∫£m x√∫c', type: 'negative', emoji: 'üë¶üö´üò∂' },
  { template: 'Did you ___ her the gift {signal}?', subject: 'you', verb: 'show', vn: 'B·∫°n c√≥ cho c√¥ ·∫•y xem qu√† kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüéÅüëß' },

  // SHUT (ƒë√≥ng)
  { template: 'I ___ the door {signal}.', subject: 'I', verb: 'shut', vn: 'T√¥i ƒë√≥ng c·ª≠a', type: 'affirm', emoji: 'üßëüö™' },
  { template: 'She ___ the window {signal}.', subject: 'She', verb: 'shut', vn: 'C√¥ ·∫•y ƒë√≥ng c·ª≠a s·ªï', type: 'affirm', emoji: 'üëßü™ü' },
  { template: 'He ___ shut his eyes {signal}.', subject: 'He', verb: 'shut', vn: 'Anh ·∫•y kh√¥ng nh·∫Øm m·∫Øt', type: 'negative', emoji: 'üë¶üö´üëÄ' },
  { template: 'Did you ___ the gate {signal}?', subject: 'you', verb: 'shut', vn: 'B·∫°n c√≥ ƒë√≥ng c·ªïng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüöß' },

  // SMELL (ng·ª≠i, c√≥ m√πi)
  { template: 'The flower ___ nice {signal}.', subject: 'The flower', verb: 'smell', vn: 'Hoa c√≥ m√πi th∆°m', type: 'affirm', emoji: 'üå∏üëÉ' },
  { template: 'The food ___ delicious {signal}.', subject: 'The food', verb: 'smell', vn: 'ƒê·ªì ƒÉn c√≥ m√πi th∆°m ngon', type: 'affirm', emoji: 'üç≤üëÉ' },
  { template: 'The milk ___ smell good {signal}.', subject: 'The milk', verb: 'smell', vn: 'S·ªØa kh√¥ng c√≥ m√πi t·ªët', type: 'negative', emoji: 'ü•õüö´üëÉ' },
  { template: 'Did you ___ something burning {signal}?', subject: 'you', verb: 'smell', vn: 'B·∫°n c√≥ ng·ª≠i th·∫•y m√πi ch√°y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüëÉüî•' },

  // SPELL (ƒë√°nh v·∫ßn)
  { template: 'I ___ my name {signal}.', subject: 'I', verb: 'spell', vn: 'T√¥i ƒë√°nh v·∫ßn t√™n', type: 'affirm', emoji: 'üßëüî§' },
  { template: 'She ___ the word correctly {signal}.', subject: 'She', verb: 'spell', vn: 'C√¥ ·∫•y ƒë√°nh v·∫ßn ƒë√∫ng', type: 'affirm', emoji: 'üëß‚úìüî§' },
  { template: 'He ___ spell that word {signal}.', subject: 'He', verb: 'spell', vn: 'Anh ·∫•y kh√¥ng ƒë√°nh v·∫ßn ƒë∆∞·ª£c t·ª´ ƒë√≥', type: 'negative', emoji: 'üë¶üö´üî§' },
  { template: 'Can you ___ this word {signal}?', subject: 'you', verb: 'spell', vn: 'B·∫°n c√≥ th·ªÉ ƒë√°nh v·∫ßn t·ª´ n√†y kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüî§' },

  // STEAL (ƒÉn c·∫Øp)
  { template: 'Someone ___ my bike {signal}.', subject: 'Someone', verb: 'steal', vn: 'Ai ƒë√≥ ƒÉn c·∫Øp xe ƒë·∫°p c·ªßa t√¥i', type: 'affirm', emoji: 'üòàüö≤' },
  { template: 'The thief ___ the money {signal}.', subject: 'The thief', verb: 'steal', vn: 'T√™n tr·ªôm ƒÉn c·∫Øp ti·ªÅn', type: 'affirm', emoji: 'ü¶πüí∞' },
  { template: 'I ___ steal anything {signal}.', subject: 'I', verb: 'steal', vn: 'T√¥i kh√¥ng ƒÉn c·∫Øp g√¨', type: 'negative', emoji: 'üßëüö´' },
  { template: 'Did someone ___ your phone {signal}?', subject: 'someone', verb: 'steal', vn: 'C√≥ ai ƒÉn c·∫Øp ƒëi·ªán tho·∫°i c·ªßa b·∫°n kh√¥ng?', type: 'question_verb', emoji: '‚ùìüòàüì±' },

  // SWEEP (qu√©t)
  { template: 'I ___ the floor {signal}.', subject: 'I', verb: 'sweep', vn: 'T√¥i qu√©t nh√†', type: 'affirm', emoji: 'üßëüßπ' },
  { template: 'She ___ the room {signal}.', subject: 'She', verb: 'sweep', vn: 'C√¥ ·∫•y qu√©t ph√≤ng', type: 'affirm', emoji: 'üëßüßπ' },
  { template: 'He ___ sweep the yard {signal}.', subject: 'He', verb: 'sweep', vn: 'Anh ·∫•y kh√¥ng qu√©t s√¢n', type: 'negative', emoji: 'üë¶üö´üßπ' },
  { template: 'Did you ___ under the bed {signal}?', subject: 'you', verb: 'sweep', vn: 'B·∫°n c√≥ qu√©t d∆∞·ªõi gi∆∞·ªùng kh√¥ng?', type: 'question_verb', emoji: '‚ùìüßëüõèÔ∏èüßπ' },

  // SWING (ƒëu, ƒëong ƒë∆∞a)
  { template: 'The kids ___ in the park {signal}.', subject: 'The kids', verb: 'swing', vn: 'B·ªçn tr·∫ª ch∆°i x√≠ch ƒëu ·ªü c√¥ng vi√™n', type: 'affirm', emoji: 'üëßüë¶üé†' },
  { template: 'The monkey ___ from tree to tree {signal}.', subject: 'The monkey', verb: 'swing', vn: 'Con kh·ªâ ƒëu t·ª´ c√¢y n√†y sang c√¢y kia', type: 'affirm', emoji: 'üêíüå≥' },
  { template: 'I ___ swing high {signal}.', subject: 'I', verb: 'swing', vn: 'T√¥i kh√¥ng ƒëu cao', type: 'negative', emoji: 'üßëüö´üé†' },
  { template: 'Did the door ___ open {signal}?', subject: 'the door', verb: 'swing', vn: 'C·ª≠a c√≥ m·ªü ra kh√¥ng?', type: 'question_verb', emoji: '‚ùìüö™' }
];

function getVerbForms(verbBase) {
  // Find verb in IRREGULAR_VERBS
  for (var i = 0; i < IRREGULAR_VERBS.groups.length; i++) {
    var group = IRREGULAR_VERBS.groups[i];
    for (var j = 0; j < group.verbs.length; j++) {
      var v = group.verbs[j];
      if (v.base === verbBase) {
        return { base: v.base, past: v.past, vn: v.vn };
      }
    }
  }
  // Regular verb fallback
  return { base: verbBase, past: verbBase + 'ed', vn: '' };
}

function getPresentForm(verb, subject) {
  var subjectLower = subject.toLowerCase();
  
  // X·ª¨ L√ù ƒê·∫∂C BI·ªÜT CHO ƒê·ªòNG T·ª™ "BE"
  if (verb === 'be') {
    if (subjectLower === 'i') return 'am';
    if (['he', 'she', 'it', 'mom', 'dad', 'tom', 'lily', 'the baby', 'the bird', 'the tree', 'the class', 'the cat', 'the dog', 'the sun', 'the moon', 'the flower', 'the food', 'the milk', 'the phone', 'the doorbell', 'the alarm', 'the bell', 'the hen', 'the monkey', 'the thief', 'the hunter', 'the fire', 'the wind', 'water', 'the lake', 'the book', 'the trip', 'the movie', 'the show', 'the game', 'my finger', 'his nose', 'the wound', 'the earthquake', 'this word', 'someone', 'the temperature', 'the water level', 'the light', 'the plane'].indexOf(subjectLower) >= 0) return 'is';
    // they, we, you, v√† c√°c ch·ªß ng·ªØ s·ªë nhi·ªÅu
    return 'are';
  }
  
  // Danh s√°ch ng√¥i 3 s·ªë √≠t c·ª• th·ªÉ
  var thirdPersonList = ['he', 'she', 'it', 'mom', 'dad', 'tom', 'lily', 'the baby', 'the bird', 'the tree', 'the class', 'the cat', 'the dog', 'the sun', 'the moon', 'the flower', 'the food', 'the milk', 'the phone', 'the doorbell', 'the alarm', 'the bell', 'the hen', 'the monkey', 'the thief', 'the hunter', 'the fire', 'the wind', 'water', 'the lake', 'the book', 'the trip', 'the movie', 'the show', 'the game', 'the class', 'my finger', 'his nose', 'the wound', 'the earthquake', 'this word', 'someone', 'the temperature', 'the water level', 'the light', 'the plane'];
  
  // Ki·ªÉm tra n·∫øu l√† ng√¥i 3 s·ªë √≠t (kh√¥ng ph·∫£i s·ªë nhi·ªÅu)
  var isThirdPerson = thirdPersonList.indexOf(subjectLower) >= 0;
  
  // N·∫øu kh√¥ng trong danh s√°ch, ki·ªÉm tra th√™m: b·∫Øt ƒë·∫ßu b·∫±ng "the " ho·∫∑c "my " ho·∫∑c "his/her " v√† KH√îNG k·∫øt th√∫c b·∫±ng "s" (s·ªë nhi·ªÅu)
  if (!isThirdPerson && (subjectLower.startsWith('the ') || subjectLower.startsWith('my ') || subjectLower.startsWith('his ') || subjectLower.startsWith('her '))) {
    // Lo·∫°i b·ªè c√°c t·ª´ s·ªë nhi·ªÅu (k·∫øt th√∫c b·∫±ng s nh∆∞ng kh√¥ng ph·∫£i class, bus, etc.)
    var pluralExceptions = ['the kids', 'the boys', 'the girls', 'the stars', 'the leaves', 'prices', 'birds', 'penguins', 'dogs'];
    if (pluralExceptions.indexOf(subjectLower) < 0) {
      isThirdPerson = true;
    }
  }
  
  if (isThirdPerson) {
    if (verb === 'go' || verb === 'do') return verb + 'es';
    if (verb === 'have') return 'has';
    if (verb === 'watch' || verb === 'wash' || verb === 'teach' || verb === 'catch') return verb + 'es';
    // Ch·ªâ ƒë·ªïi y‚Üíies khi tr∆∞·ªõc y l√† PH·ª§ √ÇM (kh√¥ng ph·∫£i nguy√™n √¢m a,e,i,o,u)
    if (verb.endsWith('y')) {
      var beforeY = verb.charAt(verb.length - 2);
      var vowels = ['a', 'e', 'i', 'o', 'u'];
      if (vowels.indexOf(beforeY) < 0) {
        // Ph·ª• √¢m tr∆∞·ªõc y: cry ‚Üí cries, fly ‚Üí flies
        return verb.slice(0, -1) + 'ies';
      }
      // Nguy√™n √¢m tr∆∞·ªõc y: buy ‚Üí buys, play ‚Üí plays
      return verb + 's';
    }
    return verb + 's';
  }
  return verb;
}

function generateQuizQuestions(count) {
  var questions = [];
  var usedTemplates = [];
  
  // Get all verbs for wrong answers
  var allVerbs = [];
  IRREGULAR_VERBS.groups.forEach(function(group) {
    group.verbs.forEach(function(verb) {
      allVerbs.push(verb);
    });
  });
  
  for (var i = 0; i < count; i++) {
    // Pick random template
    var templateIndex;
    do {
      templateIndex = Math.floor(Math.random() * SENTENCE_TEMPLATES.length);
    } while (usedTemplates.indexOf(templateIndex) >= 0 && usedTemplates.length < SENTENCE_TEMPLATES.length);
    usedTemplates.push(templateIndex);
    
    var template = SENTENCE_TEMPLATES[templateIndex];
    var verbForms = getVerbForms(template.verb);
    var sentenceType = template.type || 'affirm';
    
    // Randomly choose present or past
    var isPast = Math.random() > 0.5;
    var signalList = isPast ? SIGNAL_WORDS.past : SIGNAL_WORDS.present;
    var signalObj = signalList[Math.floor(Math.random() * signalList.length)];
    
    var correctAnswer, wrongAnswers = [];
    var subject = template.subject.toLowerCase();
    var isThirdPerson = ['he', 'she', 'it', 'mom', 'dad', 'the baby', 'the bird', 'the tree', 'the class', 'the cat', 'the dog', 'the sun', 'the moon', 'the flower', 'the food', 'the milk', 'the phone', 'the doorbell', 'the alarm', 'the bell', 'the hen', 'the monkey', 'the thief', 'the hunter', 'the fire', 'the wind', 'water', 'the lake', 'the book', 'the trip', 'the movie', 'the show', 'the game', 'my finger', 'his nose', 'the wound', 'the earthquake', 'this word', 'someone', 'the temperature', 'the water level', 'the light', 'the plane'].indexOf(subject) >= 0;
    
    if (sentenceType === 'affirm') {
      // C√¢u kh·∫≥ng ƒë·ªãnh: ƒëi·ªÅn ƒë·ªông t·ª´
      correctAnswer = isPast ? verbForms.past : getPresentForm(verbForms.base, template.subject);
      
      // Wrong answers
      var opposite = isPast ? getPresentForm(verbForms.base, template.subject) : verbForms.past;
      if (opposite !== correctAnswer) wrongAnswers.push(opposite);
      
    } else if (sentenceType === 'negative') {
      // C√¢u ph·ªß ƒë·ªãnh: ƒëi·ªÅn don't/doesn't/didn't
      if (isPast) {
        correctAnswer = "didn't";
        wrongAnswers = ["don't", "doesn't", "isn't"];
      } else {
        correctAnswer = isThirdPerson ? "doesn't" : "don't";
        wrongAnswers = isThirdPerson ? ["don't", "didn't", "isn't"] : ["doesn't", "didn't", "aren't"];
      }
      
    } else if (sentenceType === 'question') {
      // C√¢u h·ªèi c≈©: ƒëi·ªÅn Do/Does/Did
      if (isPast) {
        correctAnswer = "Did";
        wrongAnswers = ["Do", "Does", "Is"];
      } else {
        correctAnswer = isThirdPerson ? "Does" : "Do";
        wrongAnswers = isThirdPerson ? ["Do", "Did", "Is"] : ["Does", "Did", "Are"];
      }
    } else if (sentenceType === 'question_verb') {
      // C√¢u h·ªèi m·ªõi: ƒë√£ c√≥ Do/Does/Did, c·∫ßn ƒëi·ªÅn ƒë·ªông t·ª´ G·ªêC
      correctAnswer = verbForms.base; // Lu√¥n l√† V g·ªëc sau Do/Does/Did
      
      // Wrong answers: V-s/es ho·∫∑c V2 (nh∆∞ng ph·∫£i KH√ÅC correctAnswer)
      if (verbForms.past !== correctAnswer) wrongAnswers.push(verbForms.past);
      var vPresent = getPresentForm(verbForms.base, 'She');
      if (vPresent !== correctAnswer && wrongAnswers.indexOf(vPresent) < 0) wrongAnswers.push(vPresent);
      
      // Th√™m ƒë√°p √°n sai t·ª´ c√°c ƒë·ªông t·ª´ kh√°c
      var shuffledVerbs = shuffle(allVerbs);
      for (var k = 0; k < shuffledVerbs.length && wrongAnswers.length < 3; k++) {
        var wv = shuffledVerbs[k];
        if (wv.base !== template.verb && wv.past !== correctAnswer && wrongAnswers.indexOf(wv.past) < 0) {
          wrongAnswers.push(wv.past);
        }
      }
    }
    
    // Add more wrong answers from other verbs if needed (for affirm type)
    if (sentenceType === 'affirm') {
      var shuffledVerbs = shuffle(allVerbs);
      for (var j = 0; j < shuffledVerbs.length && wrongAnswers.length < 3; j++) {
        var wrongVerb = shuffledVerbs[j];
        if (wrongVerb.base !== template.verb) {
          var wrongForm = isPast ? wrongVerb.past : getPresentForm(wrongVerb.base, template.subject);
          if (wrongForm !== correctAnswer && wrongAnswers.indexOf(wrongForm) < 0) {
            wrongAnswers.push(wrongForm);
          }
        }
      }
    }
    
    // Ensure we have 3 wrong answers - add smart distractors
    var fallbackWrongs = ['went', 'goes', 'ate', 'eats', 'took', 'takes', 'saw', 'sees', 'came', 'comes', 'gave', 'gives', 'ran', 'runs', 'made', 'makes'];
    var fi = 0;
    while (wrongAnswers.length < 3 && fi < fallbackWrongs.length) {
      if (fallbackWrongs[fi] !== correctAnswer && wrongAnswers.indexOf(fallbackWrongs[fi]) < 0) {
        wrongAnswers.push(fallbackWrongs[fi]);
      }
      fi++;
    }
    
    var sentence = template.template.replace('{signal}', signalObj.signal);
    
    questions.push({
      sentence: sentence,
      sentenceVn: template.vn,
      signal: signalObj.signal,
      signalVn: signalObj.vn,
      isPast: isPast,
      verb: verbForms.base,
      verbVn: verbForms.vn,
      correctAnswer: correctAnswer,
      wrongAnswers: wrongAnswers.slice(0, 3),
      subject: template.subject,
      type: sentenceType,
      emoji: template.emoji || ''
    });
  }
  
  return shuffle(questions);
}

function startVerbSentenceQuiz() {
  playSound('click');
  
  var html = '<div class="progress-header" style="margin-bottom:15px">' +
    '<button class="back-btn" onclick="goHome()">‚Üê Home</button>' +
    '<div style="color:white;font-weight:700;font-size:1.1rem">üìù Tr·∫Øc nghi·ªám</div>' +
    '<div></div></div>' +
    
    '<div class="easy-match-container">' +
    '<div class="easy-match-header">' +
    '<div style="font-size:50px;margin-bottom:10px">üìù</div>' +
    '<div class="easy-match-title">Tr·∫Øc nghi·ªám ƒë·ªông t·ª´</div>' +
    '<div class="easy-match-hint">Ch·ªçn d·∫°ng ƒë√∫ng ƒë·ªÉ ƒëi·ªÅn v√†o ch·ªó tr·ªëng</div>' +
    '</div>' +
    
    '<div class="study-tip-box" style="margin:15px 0">' +
    '<div class="study-tip-icon">üí°</div>' +
    '<div class="study-tip-text">' +
    '‚ö†Ô∏è Sau <strong>Do/Does/Did</strong> lu√¥n d√πng <strong>ƒë·ªông t·ª´ G·ªêC</strong>!' +
    '</div></div>' +
    
    '<div class="easy-match-level-select">' +
    '<div class="easy-match-level easy" onclick="startSentenceQuizGame(5)">' +
    '<div class="level-icon">üå±</div>' +
    '<div class="level-info">' +
    '<div class="level-name">5 c√¢u</div>' +
    '<div class="level-desc">Luy·ªán t·∫≠p nh·∫π nh√†ng</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level medium" onclick="startSentenceQuizGame(10)">' +
    '<div class="level-icon">üåø</div>' +
    '<div class="level-info">' +
    '<div class="level-name">10 c√¢u</div>' +
    '<div class="level-desc">√în t·∫≠p c∆° b·∫£n</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level hard" onclick="startSentenceQuizGame(15)">' +
    '<div class="level-icon">üå≥</div>' +
    '<div class="level-info">' +
    '<div class="level-name">15 c√¢u</div>' +
    '<div class="level-desc">Th·ª≠ th√°ch</div>' +
    '</div></div>' +
    
    '<div class="easy-match-level" onclick="startSentenceQuizGame(20)" style="border-color:#FF6D00;background:linear-gradient(135deg,#FFF8E1,#FFECB3)">' +
    '<div class="level-icon">üî•</div>' +
    '<div class="level-info">' +
    '<div class="level-name">20 c√¢u</div>' +
    '<div class="level-desc">Boss cu·ªëi ƒë√¢y r·ªìi! üëæ</div>' +
    '</div></div>' +
    '</div></div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function startSentenceQuizGame(count) {
  playSound('click');
  
  sentenceQuizState = {
    questions: generateQuizQuestions(count),
    currentIndex: 0,
    score: 0,
    answered: false,
    level: count
  };
  
  renderSentenceQuiz();
}

function renderSentenceQuiz() {
  var state = sentenceQuizState;
  
  if (state.currentIndex >= state.questions.length) {
    showSentenceQuizResult();
    return;
  }
  
  var q = state.questions[state.currentIndex];
  
  // Progress dots
  var dotsHtml = '';
  for (var i = 0; i < state.level; i++) {
    var dotClass = 'dot';
    if (i < state.currentIndex) dotClass += ' done';
    else if (i === state.currentIndex) dotClass += ' active';
    dotsHtml += '<div class="' + dotClass + '"></div>';
  }
  
  // Underline the signal word in sentence
  var displaySentence = q.sentence.replace(q.signal, '<u style="text-decoration:underline;text-decoration-color:#FF9800;text-decoration-thickness:2px;font-weight:700">' + q.signal + '</u>');
  displaySentence = displaySentence.replace('___', '<span class="blank">?</span>');
  
  var html = '<div class="progress-header">' +
    '<button class="back-btn" onclick="startVerbSentenceQuiz()">‚Üê Back</button>' +
    '<div class="progress-dots">' + dotsHtml + '</div>' +
    '<div class="star-count">‚≠ê ' + state.score + '</div>' +
    '</div>' +
    
    '<div class="sentence-quiz-card">' +
    
    // Emoji
    (q.emoji ? '<div style="font-size:3rem;text-align:center;margin-bottom:10px">' + q.emoji + '</div>' : '') +
    
    // Sentence with blank and underlined signal
    '<div class="sentence-quiz-sentence">' +
    displaySentence +
    '</div>' +
    
    // 4 Choices
    '<div class="sentence-quiz-choices">';
  
  // Create array with 1 correct + 3 wrong, then shuffle
  var allChoices = [
    { answer: q.correctAnswer, isCorrect: true }
  ];
  q.wrongAnswers.forEach(function(wrong) {
    if (wrong !== q.correctAnswer && !allChoices.some(function(c) { return c.answer === wrong; })) {
      allChoices.push({ answer: wrong, isCorrect: false });
    }
  });
  allChoices = shuffle(allChoices);
  
  // Store correct index for later
  var correctIdx = -1;
  allChoices.forEach(function(choice, idx) {
    if (choice.isCorrect) correctIdx = idx;
    html += '<button class="sentence-choice-btn" id="choice-' + idx + '" ' +
      'onclick="checkSentenceAnswer(' + idx + ', ' + choice.isCorrect + ')">' +
      choice.answer +
      '</button>';
  });
  
  // Store correct index in state for feedback
  sentenceQuizState.correctIdx = correctIdx;
  
  html += '</div>' +
    '<div id="sentenceFeedback"></div>' +
    '</div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function checkSentenceAnswer(choiceIdx, isCorrect) {
  if (sentenceQuizState.answered) return;
  sentenceQuizState.answered = true;
  
  var q = sentenceQuizState.questions[sentenceQuizState.currentIndex];
  var correctIdx = sentenceQuizState.correctIdx;
  
  // Highlight all buttons
  document.querySelectorAll('.sentence-choice-btn').forEach(function(btn, idx) {
    btn.disabled = true;
    if (idx === choiceIdx && isCorrect) {
      btn.classList.add('correct');
    } else if (idx === choiceIdx && !isCorrect) {
      btn.classList.add('wrong');
    }
    if (idx === correctIdx && !isCorrect) {
      btn.classList.add('show-correct');
    }
  });
  
  if (isCorrect) {
    sentenceQuizState.score++;
    addStars(1);
    playSound('correct');
  } else {
    playSound('wrong');
    // TRACK C√ÇU SAI
    addMistake({
      sentence: q.sentence,
      sentenceVn: q.sentenceVn,
      correctAnswer: q.correctAnswer,
      verb: q.verb,
      verbVn: q.verbVn,
      signal: q.signal,
      signalVn: q.signalVn,
      isPast: q.isPast,
      type: q.type,
      subject: q.subject,
      emoji: q.emoji,
      quizType: 'sentence'
    });
  }
  
  // Explanation based on type
  var explanation = '';
  if (q.type === 'affirm') {
    explanation = q.isPast ? 
      'üåô <strong>' + q.signal + '</strong> ‚Üí d√πng Simple Past: <strong>' + q.correctAnswer + '</strong>' :
      '‚òÄÔ∏è <strong>' + q.signal + '</strong> ‚Üí d√πng hi·ªán t·∫°i: <strong>' + q.correctAnswer + '</strong>';
  } else if (q.type === 'negative') {
    explanation = q.isPast ?
      'üö´üåô Ph·ªß ƒë·ªãnh qu√° kh·ª© ‚Üí <strong>didn\'t</strong> + ƒë·ªông t·ª´ g·ªëc' :
      'üö´‚òÄÔ∏è Ph·ªß ƒë·ªãnh hi·ªán t·∫°i ‚Üí <strong>' + q.correctAnswer + '</strong> + ƒë·ªông t·ª´ g·ªëc';
  } else if (q.type === 'question') {
    explanation = q.isPast ?
      '‚ùìüåô C√¢u h·ªèi qu√° kh·ª© ‚Üí <strong>Did</strong> + S + ƒë·ªông t·ª´ g·ªëc?' :
      '‚ùì‚òÄÔ∏è C√¢u h·ªèi hi·ªán t·∫°i ‚Üí <strong>' + q.correctAnswer + '</strong> + S + ƒë·ªông t·ª´ g·ªëc?';
  } else if (q.type === 'question_verb') {
    explanation = '‚ö†Ô∏è Sau Do/Does/Did lu√¥n d√πng <strong>ƒë·ªông t·ª´ G·ªêC</strong>: <strong>' + q.correctAnswer + '</strong>';
  }
  
  var feedbackHtml = '<div class="sentence-feedback ' + (isCorrect ? 'correct' : 'wrong') + '">' +
    '<div class="emoji">' + (isCorrect ? 'üéâ' : 'üí™') + '</div>' +
    '<div class="message">' + (isCorrect ? 'Ch√≠nh x√°c!' : 'Ch∆∞a ƒë√∫ng r·ªìi!') + '</div>' +
    '<div class="explanation">' + explanation + '</div>' +
    '<button class="next-btn" onclick="nextSentenceQuestion()">' +
    (sentenceQuizState.currentIndex < sentenceQuizState.level - 1 ? 'Ti·∫øp theo ‚Üí' : 'Xem k·∫øt qu·∫£ üèÜ') +
    '</button>' +
    '</div>';
  
  document.getElementById('sentenceFeedback').innerHTML = feedbackHtml;
  
  if (isCorrect && sentenceQuizState.score % 3 === 0) {
    showConfetti();
  }
}

function nextSentenceQuestion() {
  sentenceQuizState.currentIndex++;
  sentenceQuizState.answered = false;
  renderSentenceQuiz();
}

function showSentenceQuizResult() {
  var state = sentenceQuizState;
  var percentage = Math.round((state.score / state.level) * 100);
  
  var emoji, message;
  if (percentage >= 90) { emoji = 'üèÜ'; message = 'Tuy·ªát v·ªùi! Con ƒë√£ r·∫•t chƒÉm ch·ªâ!'; }
  else if (percentage >= 70) { emoji = '‚≠ê'; message = 'T·ªët l·∫Øm! Ti·∫øp t·ª•c c·ªë g·∫Øng!'; }
  else if (percentage >= 50) { emoji = 'üí™'; message = 'Kh√° r·ªìi! √în th√™m nh√©!'; }
  else { emoji = 'üìö'; message = 'C·∫ßn √¥n l·∫°i nhi·ªÅu h∆°n nha!'; }
  
  playSound('complete');
  if (percentage >= 70) showConfetti();
  
  var starsHtml = '';
  var starCount = percentage >= 90 ? 3 : percentage >= 70 ? 2 : percentage >= 50 ? 1 : 0;
  for (var i = 0; i < 3; i++) {
    starsHtml += i < starCount ? '‚≠ê' : '‚òÜ';
  }
  
  var html = '<div class="result-content">' +
    '<div class="result-card">' +
    '<div class="result-emoji">' + emoji + '</div>' +
    '<div class="result-title">' + message + '</div>' +
    '<div class="result-stars">' + starsHtml + '</div>' +
    '<div style="font-size:2.5rem;font-weight:800;color:#667eea;margin:15px 0">' + 
    state.score + ' / ' + state.level + '</div>' +
    '<div style="color:#666;margin-bottom:20px">' + percentage + '% ch√≠nh x√°c</div>' +
    '<div class="result-buttons">' +
    '<button class="result-btn primary" onclick="startSentenceQuizGame(' + state.level + ')">Ch∆°i l·∫°i üîÑ</button>' +
    '<button class="result-btn secondary" onclick="startVerbSentenceQuiz()">ƒê·ªïi m·ª©c ƒë·ªô üìä</button>' +
    '<button class="result-btn secondary" onclick="showLearnScreen()">V·ªÅ h·ªçc t·∫≠p üìö</button>' +
    '</div></div></div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

// ============ CONTEXT LEARN ============
var contextLearnState = {
  currentIndex: 0
};

var CONTEXT_LESSONS = [
  {
    title: '‚òÄÔ∏è D·∫•u hi·ªáu HI·ªÜN T·∫†I',
    signals: [
      { word: 'every day', vn: 'm·ªói ng√†y', emoji: 'üìÖ' },
      { word: 'every morning', vn: 'm·ªói s√°ng', emoji: 'üåÖ' },
      { word: 'every week', vn: 'm·ªói tu·∫ßn', emoji: 'üìÜ' },
      { word: 'always', vn: 'lu√¥n lu√¥n', emoji: 'üíØ' },
      { word: 'usually', vn: 'th∆∞·ªùng', emoji: 'üîÑ' },
      { word: 'often', vn: 'th∆∞·ªùng xuy√™n', emoji: 'üîÅ' },
      { word: 'sometimes', vn: 'ƒë√¥i khi', emoji: 'üé≤' }
    ],
    examples: [
      { sentence: 'She <span class="verb-word">eats</span> breakfast <span class="signal-word">every day</span>.', type: 'present' },
      { sentence: 'I <span class="verb-word">go</span> to school <span class="signal-word">every morning</span>.', type: 'present' },
      { sentence: 'He <span class="verb-word">always</span> <span class="verb-word">drinks</span> milk.', type: 'present' }
    ],
    rule: 'Th·∫•y nh·ªØng t·ª´ n√†y ‚Üí d√πng TH√å HI·ªÜN T·∫†I'
  },
  {
    title: 'üåô D·∫•u hi·ªáu QU√Å KH·ª®',
    signals: [
      { word: 'yesterday', vn: 'h√¥m qua', emoji: 'üìÜ' },
      { word: 'last night', vn: 't·ªëi qua', emoji: 'üåô' },
      { word: 'last week', vn: 'tu·∫ßn tr∆∞·ªõc', emoji: 'üìÖ' },
      { word: 'last month', vn: 'th√°ng tr∆∞·ªõc', emoji: 'üóìÔ∏è' },
      { word: 'last year', vn: 'nƒÉm ngo√°i', emoji: 'üìÜ' },
      { word: '2 days ago', vn: '2 ng√†y tr∆∞·ªõc', emoji: '‚è™' },
      { word: 'this morning', vn: 's√°ng nay', emoji: 'üåÑ' }
    ],
    examples: [
      { sentence: 'She <span class="verb-word">ate</span> breakfast <span class="signal-word">yesterday</span>.', type: 'past' },
      { sentence: 'I <span class="verb-word">went</span> to school <span class="signal-word">last week</span>.', type: 'past' },
      { sentence: 'He <span class="verb-word">drank</span> milk <span class="signal-word">this morning</span>.', type: 'past' }
    ],
    rule: 'Th·∫•y nh·ªØng t·ª´ n√†y ‚Üí d√πng TH√å QU√Å KH·ª® (Simple Past)'
  },
  {
    title: 'üö´ C√¢u PH·ª¶ ƒê·ªäNH',
    signals: [
      { word: "don't / doesn't", vn: 'kh√¥ng (hi·ªán t·∫°i)', emoji: '‚òÄÔ∏èüö´' },
      { word: "didn't", vn: 'kh√¥ng (qu√° kh·ª©)', emoji: 'üåôüö´' }
    ],
    examples: [
      { sentence: 'She <span class="verb-word">doesn\'t</span> eat meat <span class="signal-word">every day</span>.', type: 'present' },
      { sentence: 'I <span class="verb-word">don\'t</span> like coffee.', type: 'present' },
      { sentence: 'He <span class="verb-word">didn\'t</span> go to school <span class="signal-word">yesterday</span>.', type: 'past' }
    ],
    rule: '‚òÄÔ∏è Hi·ªán t·∫°i: don\'t/doesn\'t + V g·ªëc<br>üåô Qu√° kh·ª©: didn\'t + V g·ªëc'
  },
  {
    title: '‚ùì C√¢u H·ªéI',
    signals: [
      { word: 'Do / Does', vn: 'c√≥...kh√¥ng? (hi·ªán t·∫°i)', emoji: '‚òÄÔ∏è‚ùì' },
      { word: 'Did', vn: 'c√≥...kh√¥ng? (qu√° kh·ª©)', emoji: 'üåô‚ùì' }
    ],
    examples: [
      { sentence: '<span class="verb-word">Does</span> she eat breakfast <span class="signal-word">every day</span>?', type: 'present' },
      { sentence: '<span class="verb-word">Do</span> you like pizza?', type: 'present' },
      { sentence: '<span class="verb-word">Did</span> he go to school <span class="signal-word">yesterday</span>?', type: 'past' }
    ],
    rule: '‚òÄÔ∏è Hi·ªán t·∫°i: Do/Does + S + V g·ªëc?<br>üåô Qu√° kh·ª©: Did + S + V g·ªëc?'
  },
  {
    title: '‚ö†Ô∏è Ch√∫ √Ω quan tr·ªçng',
    signals: [
      { word: "He/She/It + V-s/es", vn: 'ng√¥i 3 s·ªë √≠t th√™m s', emoji: '‚òÄÔ∏è' },
      { word: "doesn't/didn't + V g·ªëc", vn: 'ph·ªß ƒë·ªãnh d√πng V g·ªëc', emoji: 'üö´' },
      { word: "Do/Does/Did + V g·ªëc", vn: 'c√¢u h·ªèi d√πng V g·ªëc', emoji: '‚ùì' }
    ],
    examples: [
      { sentence: 'She <span class="verb-word">goes</span> to school. (th√™m es)', type: 'present' },
      { sentence: 'She <span class="verb-word">doesn\'t go</span> to school. (V g·ªëc)', type: 'present' },
      { sentence: '<span class="verb-word">Does</span> she <span class="verb-word">go</span> to school? (V g·ªëc)', type: 'present' }
    ],
    rule: 'Sau don\'t/doesn\'t/didn\'t/Do/Does/Did ‚Üí lu√¥n d√πng ƒë·ªông t·ª´ G·ªêC!'
  }
];

function showContextLearn() {
  playSound('click');
  contextLearnState.currentIndex = 0;
  renderContextLearn();
}

function renderContextLearn() {
  var lesson = CONTEXT_LESSONS[contextLearnState.currentIndex];
  
  var html = '<div class="progress-header" style="margin-bottom:15px">' +
    '<button class="back-btn" onclick="showLearnScreen()">‚Üê Back</button>' +
    '<div style="color:white;font-weight:700;font-size:1.1rem">üìö Ng·ªØ c·∫£nh</div>' +
    '<div></div></div>' +
    
    '<div class="context-progress">' +
    'B√†i ' + (contextLearnState.currentIndex + 1) + ' / ' + CONTEXT_LESSONS.length +
    '</div>' +
    
    '<div class="context-container">' +
    '<div class="context-card">' +
    '<div class="context-title">' + lesson.title + '</div>';
  
  // Signal words
  lesson.signals.forEach(function(signal) {
    html += '<div class="context-rule">' +
      '<div class="context-emoji">' + signal.emoji + '</div>' +
      '<div class="context-text">' +
      '<div class="context-signal">' + signal.word + '</div>' +
      '<div class="context-explain">' + signal.vn + '</div>' +
      '</div></div>';
  });
  
  html += '</div>' +
    
    // Examples
    '<div class="context-example-box">' +
    '<div style="font-weight:700;margin-bottom:10px;color:#333">üìù V√≠ d·ª•:</div>';
  
  lesson.examples.forEach(function(ex) {
    html += '<div class="context-example ' + ex.type + '">' + ex.sentence + '</div>';
  });
  
  html += '<div style="margin-top:15px;padding:12px;background:#E3F2FD;border-radius:10px;text-align:center">' +
    '<strong>üìå Quy t·∫Øc:</strong><br>' + lesson.rule +
    '</div></div>' +
    
    // Navigation
    '<div class="context-nav">';
  
  if (contextLearnState.currentIndex > 0) {
    html += '<button class="context-nav-btn" style="background:#E0E0E0;color:#333" onclick="prevContextLesson()">‚Üê Tr∆∞·ªõc</button>';
  }
  
  if (contextLearnState.currentIndex < CONTEXT_LESSONS.length - 1) {
    html += '<button class="context-nav-btn" style="background:#4CAF50;color:white" onclick="nextContextLesson()">Ti·∫øp ‚Üí</button>';
  } else {
    html += '<button class="context-nav-btn" style="background:#667eea;color:white" onclick="showLearnScreen()">Ho√†n th√†nh ‚úì</button>';
  }
  
  html += '</div></div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function prevContextLesson() {
  playSound('click');
  if (contextLearnState.currentIndex > 0) {
    contextLearnState.currentIndex--;
    renderContextLearn();
  }
}

function nextContextLesson() {
  playSound('click');
  if (contextLearnState.currentIndex < CONTEXT_LESSONS.length - 1) {
    contextLearnState.currentIndex++;
    renderContextLearn();
  }
}

// ============ √îN T·∫¨P C√ÇU SAI H√îM NAY ============
var mistakeReviewState = {
  currentIndex: 0,
  score: 0,
  answered: false
};

function showTodayMistakes() {
  playSound('click');
  
  if (todayMistakes.length === 0) {
    var html = '<div class="progress-header" style="margin-bottom:15px">' +
      '<button class="back-btn" onclick="showLearnScreen()">‚Üê Back</button>' +
      '<div style="color:white;font-weight:700;font-size:1.1rem">üîÑ √în c√¢u sai</div>' +
      '<div></div></div>' +
      
      '<div class="easy-match-container">' +
      '<div style="text-align:center;padding:40px 20px">' +
      '<div style="font-size:80px;margin-bottom:20px">üéâ</div>' +
      '<div style="font-size:1.5rem;font-weight:700;color:#333;margin-bottom:10px">Tuy·ªát v·ªùi!</div>' +
      '<div style="color:#666;margin-bottom:20px">H√¥m nay con ch∆∞a c√≥ c√¢u n√†o sai.<br>H√£y ti·∫øp t·ª•c luy·ªán t·∫≠p nh√©!</div>' +
      '<button class="next-btn" onclick="startVerbSentenceQuiz()">L√†m b√†i m·ªõi üìù</button>' +
      '</div></div>';
    
    document.getElementById('learnScreen').innerHTML = html;
    showScreen('learnScreen');
    return;
  }
  
  // C√≥ c√¢u sai - hi·ªÉn th·ªã danh s√°ch
  var html = '<div class="progress-header" style="margin-bottom:15px">' +
    '<button class="back-btn" onclick="showLearnScreen()">‚Üê Back</button>' +
    '<div style="color:white;font-weight:700;font-size:1.1rem">üîÑ √în c√¢u sai</div>' +
    '<div style="background:rgba(255,255,255,0.9);padding:5px 12px;border-radius:15px;color:#F44336;font-weight:700">' + todayMistakes.length + ' c√¢u</div>' +
    '</div>' +
    
    '<div class="easy-match-container">' +
    '<div class="easy-match-header">' +
    '<div style="font-size:50px;margin-bottom:10px">üìã</div>' +
    '<div class="easy-match-title">C√¢u sai h√¥m nay</div>' +
    '<div class="easy-match-hint">√în l·∫°i nh·ªØng c√¢u con ƒë√£ l√†m sai</div>' +
    '</div>' +
    
    '<div style="margin-bottom:15px">' +
    '<button class="next-btn" onclick="startMistakeReview()" style="width:100%">√în t·∫≠p ngay üöÄ</button>' +
    '</div>' +
    
    '<div style="background:white;border-radius:15px;padding:15px">';
  
  todayMistakes.forEach(function(m, idx) {
    var icon = m.quizType === 'sentence' ? 'üìù' : 'üî§';
    var timeStr = m.timestamp || '';
    
    html += '<div style="padding:12px;border-bottom:1px solid #f0f0f0;display:flex;align-items:flex-start;gap:10px">' +
      '<div style="font-size:1.5rem">' + icon + '</div>' +
      '<div style="flex:1">' +
      '<div style="font-weight:600;color:#333;margin-bottom:4px">';
    
    if (m.quizType === 'sentence') {
      html += m.sentence.replace('___', '<span style="color:#F44336;font-weight:700">' + m.correctAnswer + '</span>');
    } else {
      html += '<span style="color:#4CAF50">' + m.verb + '</span> ‚Üí <span style="color:#F44336">' + m.correctAnswer + '</span>';
    }
    
    html += '</div>' +
      '<div style="font-size:0.85rem;color:#999">' + 
      (m.verbVn || '') + (timeStr ? ' ‚Ä¢ ' + timeStr : '') +
      '</div>' +
      '</div>' +
      '<button onclick="removeMistakeAndRefresh(' + idx + ')" style="background:none;border:none;color:#999;font-size:1.2rem;cursor:pointer" title="X√≥a">‚úï</button>' +
      '</div>';
  });
  
  html += '</div>' +
    '<button onclick="clearAllMistakes()" style="margin-top:15px;width:100%;padding:12px;background:#F5F5F5;border:none;border-radius:10px;color:#999;font-family:inherit;cursor:pointer">X√≥a t·∫•t c·∫£</button>' +
    '</div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
}

function removeMistakeAndRefresh(index) {
  removeMistake(index);
  showTodayMistakes();
}

function clearAllMistakes() {
  if (confirm('X√≥a t·∫•t c·∫£ ' + todayMistakes.length + ' c√¢u sai?')) {
    todayMistakes = [];
    saveStarData();
    showTodayMistakes();
  }
}

function startMistakeReview() {
  playSound('click');
  
  if (todayMistakes.length === 0) {
    showTodayMistakes();
    return;
  }
  
  mistakeReviewState = {
    currentIndex: 0,
    score: 0,
    answered: false,
    mistakes: todayMistakes.slice() // Copy ƒë·ªÉ kh√¥ng ·∫£nh h∆∞·ªüng
  };
  
  renderMistakeReview();
}

function renderMistakeReview() {
  var state = mistakeReviewState;
  
  if (state.currentIndex >= state.mistakes.length) {
    showMistakeReviewResult();
    return;
  }
  
  var m = state.mistakes[state.currentIndex];
  
  // Progress dots
  var dotsHtml = '';
  for (var i = 0; i < state.mistakes.length; i++) {
    var dotClass = 'dot';
    if (i < state.currentIndex) dotClass += ' done';
    else if (i === state.currentIndex) dotClass += ' active';
    dotsHtml += '<div class="' + dotClass + '"></div>';
  }
  
  var html = '<div class="progress-header">' +
    '<button class="back-btn" onclick="showTodayMistakes()">‚Üê Back</button>' +
    '<div class="progress-dots">' + dotsHtml + '</div>' +
    '<div class="star-count">‚úì ' + state.score + '</div>' +
    '</div>';
  
  if (m.quizType === 'sentence') {
    // Render sentence quiz
    var displaySentence = m.sentence.replace(m.signal, '<u style="text-decoration:underline;text-decoration-color:#FF9800;text-decoration-thickness:2px;font-weight:700">' + m.signal + '</u>');
    displaySentence = displaySentence.replace('___', '<span class="blank">?</span>');
    
    html += '<div class="sentence-quiz-card">' +
      (m.emoji ? '<div style="font-size:3rem;text-align:center;margin-bottom:10px">' + m.emoji + '</div>' : '') +
      '<div style="text-align:center;margin-bottom:8px;color:#F44336;font-size:0.9rem">üîÑ √în t·∫≠p c√¢u sai</div>' +
      '<div class="sentence-quiz-sentence">' + displaySentence + '</div>' +
      '<div class="sentence-quiz-choices">';
    
    // T·∫°o choices t·ª´ correctAnswer v√† wrongAnswers
    var choices = [{ answer: m.correctAnswer, isCorrect: true }];
    
    // T·∫°o wrong answers d·ª±a v√†o type
    if (m.type === 'affirm') {
      var verbForms = getVerbForms(m.verb);
      if (m.isPast) {
        var presentForm = getPresentForm(verbForms.base, m.subject);
        if (presentForm !== m.correctAnswer) choices.push({ answer: presentForm, isCorrect: false });
      } else {
        if (verbForms.past !== m.correctAnswer) choices.push({ answer: verbForms.past, isCorrect: false });
      }
      if (verbForms.base !== m.correctAnswer && !choices.some(function(c) { return c.answer === verbForms.base; })) {
        choices.push({ answer: verbForms.base, isCorrect: false });
      }
    } else if (m.type === 'negative') {
      var negatives = ["don't", "doesn't", "didn't"];
      negatives.forEach(function(n) {
        if (n !== m.correctAnswer) choices.push({ answer: n, isCorrect: false });
      });
    } else if (m.type === 'question' || m.type === 'question_verb') {
      var verbForms = getVerbForms(m.verb);
      if (verbForms.past !== m.correctAnswer && !choices.some(function(c) { return c.answer === verbForms.past; })) {
        choices.push({ answer: verbForms.past, isCorrect: false });
      }
      var vPresent = getPresentForm(verbForms.base, 'She');
      if (vPresent !== m.correctAnswer && !choices.some(function(c) { return c.answer === vPresent; })) {
        choices.push({ answer: vPresent, isCorrect: false });
      }
    }
    
    // N·∫øu ch∆∞a ƒë·ªß ƒë√°p √°n (do no-change verb), th√™m t·ª´ nhi·ªÖu
    var distractors = ['went', 'goes', 'ate', 'eats', 'took', 'takes', 'saw', 'sees', 'came', 'comes'];
    var di = 0;
    while (choices.length < 4 && di < distractors.length) {
      if (distractors[di] !== m.correctAnswer && !choices.some(function(c) { return c.answer === distractors[di]; })) {
        choices.push({ answer: distractors[di], isCorrect: false });
      }
      di++;
    }
    
    // Shuffle v√† hi·ªÉn th·ªã
    choices = shuffle(choices).slice(0, 4);
    var correctIdx = -1;
    choices.forEach(function(c, idx) {
      if (c.isCorrect) correctIdx = idx;
      html += '<button class="sentence-choice-btn" id="mr-choice-' + idx + '" onclick="checkMistakeReviewAnswer(' + idx + ', ' + c.isCorrect + ')">' + c.answer + '</button>';
    });
    mistakeReviewState.correctIdx = correctIdx;
    
    html += '</div><div id="mistakeReviewFeedback"></div></div>';
    
  } else {
    // Render verb form quiz
    html += '<div class="sentence-quiz-card">' +
      '<div style="text-align:center;margin-bottom:8px;color:#F44336;font-size:0.9rem">üîÑ √în t·∫≠p c√¢u sai</div>' +
      '<div style="font-size:1.2rem;color:#666;margin-bottom:10px">D·∫°ng ' + (m.mode === 'past' ? 'qu√° kh·ª© (V2)' : 'ph√¢n t·ª´ (V3)') + ' c·ªßa:</div>' +
      '<div style="font-size:2.5rem;font-weight:800;color:#4CAF50;margin:20px 0">' + m.verb + '</div>' +
      '<div style="color:#999;margin-bottom:20px">' + m.verbVn + '</div>' +
      '<input type="text" id="mrVerbInput" class="quiz-input" placeholder="Nh·∫≠p ƒë√°p √°n..." onkeypress="if(event.key===\'Enter\')checkMistakeReviewVerbAnswer()">' +
      '<div id="mistakeReviewFeedback" style="margin-top:15px"></div>' +
      '</div>';
  }
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
  
  // Focus v√†o input n·∫øu c√≥
  var input = document.getElementById('mrVerbInput');
  if (input) input.focus();
}

function checkMistakeReviewAnswer(choiceIdx, isCorrect) {
  if (mistakeReviewState.answered) return;
  mistakeReviewState.answered = true;
  
  var m = mistakeReviewState.mistakes[mistakeReviewState.currentIndex];
  var correctIdx = mistakeReviewState.correctIdx;
  
  document.querySelectorAll('.sentence-choice-btn').forEach(function(btn, idx) {
    btn.disabled = true;
    if (idx === choiceIdx && isCorrect) btn.classList.add('correct');
    else if (idx === choiceIdx && !isCorrect) btn.classList.add('wrong');
    if (idx === correctIdx && !isCorrect) btn.classList.add('show-correct');
  });
  
  if (isCorrect) {
    mistakeReviewState.score++;
    playSound('correct');
    // X√≥a c√¢u n√†y kh·ªèi danh s√°ch sai v√¨ ƒë√£ tr·∫£ l·ªùi ƒë√∫ng
    var originalIdx = todayMistakes.findIndex(function(tm) {
      return tm.sentence === m.sentence && tm.correctAnswer === m.correctAnswer;
    });
    if (originalIdx >= 0) removeMistake(originalIdx);
  } else {
    playSound('wrong');
  }
  
  var explanation = m.isPast ? 
    'üåô <strong>' + m.signal + '</strong> ‚Üí qu√° kh·ª©: <strong>' + m.correctAnswer + '</strong>' :
    '‚òÄÔ∏è <strong>' + m.signal + '</strong> ‚Üí hi·ªán t·∫°i: <strong>' + m.correctAnswer + '</strong>';
  
  var feedbackHtml = '<div class="sentence-feedback ' + (isCorrect ? 'correct' : 'wrong') + '">' +
    '<div class="emoji">' + (isCorrect ? 'üéâ' : 'üí™') + '</div>' +
    '<div class="message">' + (isCorrect ? 'ƒê√∫ng r·ªìi! ƒê√£ x√≥a kh·ªèi danh s√°ch sai.' : 'V·∫´n ch∆∞a ƒë√∫ng, c·ªë g·∫Øng th√™m nh√©!') + '</div>' +
    '<div class="explanation">' + explanation + '</div>' +
    '<button class="next-btn" onclick="nextMistakeReview()">' +
    (mistakeReviewState.currentIndex < mistakeReviewState.mistakes.length - 1 ? 'Ti·∫øp theo ‚Üí' : 'Xem k·∫øt qu·∫£ üèÜ') +
    '</button></div>';
  
  document.getElementById('mistakeReviewFeedback').innerHTML = feedbackHtml;
}

function checkMistakeReviewVerbAnswer() {
  if (mistakeReviewState.answered) return;
  
  var input = document.getElementById('mrVerbInput');
  var userAnswer = input.value.trim().toLowerCase();
  var m = mistakeReviewState.mistakes[mistakeReviewState.currentIndex];
  
  var correctAnswers = m.correctAnswer.toLowerCase().split('/').map(function(a) { return a.trim(); });
  var isCorrect = correctAnswers.indexOf(userAnswer) >= 0;
  
  mistakeReviewState.answered = true;
  input.disabled = true;
  input.classList.add(isCorrect ? 'correct' : 'wrong');
  
  if (isCorrect) {
    mistakeReviewState.score++;
    playSound('correct');
    var originalIdx = todayMistakes.findIndex(function(tm) {
      return tm.verb === m.verb && tm.correctAnswer === m.correctAnswer;
    });
    if (originalIdx >= 0) removeMistake(originalIdx);
  } else {
    playSound('wrong');
  }
  
  var feedbackHtml = '<div class="sentence-feedback ' + (isCorrect ? 'correct' : 'wrong') + '">' +
    '<div class="emoji">' + (isCorrect ? 'üéâ' : 'üí™') + '</div>' +
    '<div class="message">' + (isCorrect ? 'ƒê√∫ng r·ªìi! ƒê√£ x√≥a kh·ªèi danh s√°ch sai.' : 'ƒê√°p √°n ƒë√∫ng: ' + m.correctAnswer) + '</div>' +
    '<button class="next-btn" onclick="nextMistakeReview()">' +
    (mistakeReviewState.currentIndex < mistakeReviewState.mistakes.length - 1 ? 'Ti·∫øp theo ‚Üí' : 'Xem k·∫øt qu·∫£ üèÜ') +
    '</button></div>';
  
  document.getElementById('mistakeReviewFeedback').innerHTML = feedbackHtml;
}

function nextMistakeReview() {
  mistakeReviewState.currentIndex++;
  mistakeReviewState.answered = false;
  renderMistakeReview();
}

function showMistakeReviewResult() {
  var state = mistakeReviewState;
  var total = state.mistakes.length;
  var percentage = Math.round((state.score / total) * 100);
  
  var emoji = percentage >= 80 ? 'üèÜ' : percentage >= 50 ? '‚≠ê' : 'üí™';
  var message = percentage >= 80 ? 'Tuy·ªát v·ªùi! Con ƒë√£ nh·ªõ r·ªìi!' : 
                percentage >= 50 ? 'Kh√° t·ªët! Ti·∫øp t·ª•c √¥n t·∫≠p nh√©!' : 
                'C·∫ßn √¥n th√™m m·ªôt ch√∫t n·ªØa!';
  
  var remainingCount = todayMistakes.length;
  
  var html = '<div class="result-content"><div class="result-card">' +
    '<div class="result-emoji">' + emoji + '</div>' +
    '<div class="result-title">' + message + '</div>' +
    '<div style="font-size:2.5rem;font-weight:800;color:#667eea;margin:15px 0">' + state.score + ' / ' + total + '</div>' +
    '<div style="color:#666;margin-bottom:10px">' + percentage + '% ch√≠nh x√°c</div>' +
    (remainingCount > 0 ? 
      '<div style="background:#FFF3E0;padding:10px;border-radius:10px;margin-bottom:15px;color:#E65100">C√≤n ' + remainingCount + ' c√¢u c·∫ßn √¥n l·∫°i</div>' :
      '<div style="background:#E8F5E9;padding:10px;border-radius:10px;margin-bottom:15px;color:#2E7D32">üéâ ƒê√£ ho√†n th√†nh t·∫•t c·∫£!</div>') +
    '<div class="result-buttons">' +
    (remainingCount > 0 ? '<button class="result-btn primary" onclick="startMistakeReview()">√în ti·∫øp üîÑ</button>' : '') +
    '<button class="result-btn ' + (remainingCount > 0 ? 'secondary' : 'primary') + '" onclick="startVerbSentenceQuiz()">L√†m b√†i m·ªõi üìù</button>' +
    '<button class="result-btn secondary" onclick="showLearnScreen()">V·ªÅ h·ªçc t·∫≠p üìö</button>' +
    '</div></div></div>';
  
  document.getElementById('learnScreen').innerHTML = html;
  showScreen('learnScreen');
  
  playSound('complete');
  if (percentage >= 70) showConfetti();
}
</script>
</body>
</html>
